{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/idbAssets.ts"],"sourcesContent":["const DB_NAME = \"wiislide\";\nconst DB_VERSION = 1;\nconst STORE_NAME = \"assets\";\n\nfunction openDb(): Promise<IDBDatabase> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst req = indexedDB.open(DB_NAME, DB_VERSION);\n\t\treq.onupgradeneeded = () => {\n\t\t\tconst db = req.result;\n\t\t\tif (!db.objectStoreNames.contains(STORE_NAME)) {\n\t\t\t\tdb.createObjectStore(STORE_NAME);\n\t\t\t}\n\t\t};\n\t\treq.onsuccess = () => resolve(req.result);\n\t\treq.onerror = () => reject(req.error);\n\t});\n}\n\nexport async function putAssetBlob(assetId: string, blob: Blob): Promise<void> {\n\tconst db = await openDb();\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readwrite\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t\tresolve();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\ttx.objectStore(STORE_NAME).put(blob, assetId);\n\t});\n}\n\nexport async function getAssetBlob(assetId: string): Promise<Blob | null> {\n\tconst db = await openDb();\n\treturn await new Promise<Blob | null>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readonly\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\tconst req = tx.objectStore(STORE_NAME).get(assetId);\n\t\treq.onsuccess = () => resolve((req.result as Blob | undefined) ?? null);\n\t\treq.onerror = () => reject(req.error);\n\t});\n}\n\nexport async function clearAllAssetBlobs(): Promise<void> {\n\tconst db = await openDb();\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readwrite\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t\tresolve();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\ttx.objectStore(STORE_NAME).clear();\n\t});\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,UAAU;AAChB,MAAM,aAAa;AACnB,MAAM,aAAa;AAEnB,SAAS;IACR,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,MAAM,UAAU,IAAI,CAAC,SAAS;QACpC,IAAI,eAAe,GAAG;YACrB,MAAM,KAAK,IAAI,MAAM;YACrB,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,aAAa;gBAC9C,GAAG,iBAAiB,CAAC;YACtB;QACD;QACA,IAAI,SAAS,GAAG,IAAM,QAAQ,IAAI,MAAM;QACxC,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,KAAK;IACrC;AACD;AAEO,eAAe,aAAa,OAAe,EAAE,IAAU;IAC7D,MAAM,KAAK,MAAM;IACjB,MAAM,IAAI,QAAc,CAAC,SAAS;QACjC,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;YACR;QACD;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,GAAG,WAAW,CAAC,YAAY,GAAG,CAAC,MAAM;IACtC;AACD;AAEO,eAAe,aAAa,OAAe;IACjD,MAAM,KAAK,MAAM;IACjB,OAAO,MAAM,IAAI,QAAqB,CAAC,SAAS;QAC/C,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;QACT;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,MAAM,MAAM,GAAG,WAAW,CAAC,YAAY,GAAG,CAAC;QAC3C,IAAI,SAAS,GAAG,IAAM,QAAQ,AAAC,IAAI,MAAM,IAAyB;QAClE,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,KAAK;IACrC;AACD;AAEO,eAAe;IACrB,MAAM,KAAK,MAAM;IACjB,MAAM,IAAI,QAAc,CAAC,SAAS;QACjC,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;YACR;QACD;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,GAAG,WAAW,CAAC,YAAY,KAAK;IACjC;AACD"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/useWiiController.ts"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\nexport type WiiButtons = {\r\n\tA: boolean;\r\n\tB: boolean;\r\n\tOne: boolean;\r\n\tTwo: boolean;\r\n\tPlus: boolean;\r\n\tMinus: boolean;\r\n\tHome: boolean;\r\n\tUp: boolean;\r\n\tDown: boolean;\r\n\tRight: boolean;\r\n\tLeft: boolean;\r\n};\r\n\r\nexport type WiiState = {\r\n\tbuttons: WiiButtons;\r\n\taccel: { x: number; y: number; z: number };\r\n\tir: { x: number; y: number }[];\r\n\tcursor?: { x: number; y: number } | null;\r\n};\r\n\r\ntype WiiServerMessage =\r\n\t| { type: \"status\"; connected: boolean; irCursorEnabled?: boolean }\r\n\t| { type: \"irCursorStatus\"; enabled: boolean }\r\n\t| { type: \"wiiDisconnected\"; at?: number }\r\n\t| WiiState;\r\n\r\nconst EMPTY_BUTTONS: WiiButtons = {\r\n\tA: false, B: false, One: false, Two: false,\r\n\tPlus: false, Minus: false, Home: false,\r\n\tUp: false, Down: false, Right: false, Left: false,\r\n};\r\n\r\nconst KEY_TO_BUTTON: Record<string, keyof WiiButtons> = {\r\n\ti: \"Up\", j: \"Left\", k: \"Down\", l: \"Right\",\r\n\t\";\": \"Plus\", \"-\": \"Minus\",\r\n\th: \"Home\", o: \"A\", p: \"B\",\r\n\tn: \"One\", m: \"Two\",\r\n};\r\n\r\nfunction keyToButton(key: string): keyof WiiButtons | null {\r\n\tconst k = key.length === 1 ? key.toLowerCase() : key;\r\n\treturn KEY_TO_BUTTON[k] ?? null;\r\n}\r\n\r\nexport function useWiiController() {\r\n\tconst [wiiState, setWiiState] = useState<WiiState | null>(null);\r\n\tconst [wiiConnected, setWiiConnected] = useState(false);\r\n\tconst [wiiDisconnectedAt, setWiiDisconnectedAt] = useState<number | null>(null);\r\n\tconst [irCursorEnabled, setIrCursorEnabled] = useState(false);\r\n\tconst [pressed, setPressed] = useState<Partial<WiiButtons>>({});\r\n\r\n\tconst wasConnectedRef = useRef(false);\r\n\tconst wsRef = useRef<WebSocket | null>(null);\r\n\tconst pressedBufferRef = useRef<Partial<WiiButtons>>({});\r\n\tconst prevButtonsRef = useRef<WiiButtons | null>(null);\r\n\tconst latestWiiDataRef = useRef<WiiState | null>(null);\r\n\tconst pendingPressedRef = useRef<Partial<WiiButtons>>({});\r\n\tconst kbButtonsRef = useRef<WiiButtons>({ ...EMPTY_BUTTONS });\r\n\tconst kbPressedBufferRef = useRef<Partial<WiiButtons>>({});\r\n\r\n\tuseEffect(() => {\r\n\t\tconst onKeyDown = (e: KeyboardEvent) => {\r\n\t\t\tif (e.repeat) return;\r\n\t\t\tconst btn = keyToButton(e.key);\r\n\t\t\tif (!btn) return;\r\n\t\t\tkbButtonsRef.current = { ...kbButtonsRef.current, [btn]: true };\r\n\t\t\tkbPressedBufferRef.current[btn] = true;\r\n\t\t};\r\n\r\n\t\tconst onKeyUp = (e: KeyboardEvent) => {\r\n\t\t\tconst btn = keyToButton(e.key);\r\n\t\t\tif (!btn) return;\r\n\t\t\tkbButtonsRef.current = { ...kbButtonsRef.current, [btn]: false };\r\n\t\t};\r\n\r\n\t\twindow.addEventListener(\"keydown\", onKeyDown);\r\n\t\twindow.addEventListener(\"keyup\", onKeyUp);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"keydown\", onKeyDown);\r\n\t\t\twindow.removeEventListener(\"keyup\", onKeyUp);\r\n\t\t};\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst ws = new WebSocket(\"ws://localhost:8080\");\r\n\t\twsRef.current = ws;\r\n\r\n\t\tws.onopen = () => console.log(\"Connected to Wii Server\");\r\n\r\n\t\tws.onmessage = (event) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst msg = JSON.parse(event.data) as WiiServerMessage;\r\n\r\n\t\t\t\tif (msg && typeof msg === \"object\" && \"type\" in msg) {\r\n\t\t\t\t\tconst typedMsg = msg as { type: string; connected?: boolean; enabled?: boolean; irCursorEnabled?: boolean; at?: number };\r\n\r\n\t\t\t\t\tif (typedMsg.type === \"status\") {\r\n\t\t\t\t\t\tconst connected = !!typedMsg.connected;\r\n\t\t\t\t\t\tsetWiiConnected(connected);\r\n\t\t\t\t\t\twasConnectedRef.current = connected;\r\n\t\t\t\t\t\tif (typeof typedMsg.irCursorEnabled === \"boolean\") {\r\n\t\t\t\t\t\t\tsetIrCursorEnabled(typedMsg.irCursorEnabled);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typedMsg.type === \"irCursorStatus\") {\r\n\t\t\t\t\t\tsetIrCursorEnabled(!!typedMsg.enabled);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typedMsg.type === \"wiiDisconnected\") {\r\n\t\t\t\t\t\tsetWiiConnected(false);\r\n\t\t\t\t\t\twasConnectedRef.current = false;\r\n\t\t\t\t\t\tsetWiiDisconnectedAt(typeof typedMsg.at === \"number\" ? typedMsg.at : Date.now());\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst data = msg as WiiState;\r\n\t\t\t\tsetWiiConnected(true);\r\n\t\t\t\twasConnectedRef.current = true;\r\n\r\n\t\t\t\tif (prevButtonsRef.current) {\r\n\t\t\t\t\t(Object.keys(data.buttons) as Array<keyof WiiButtons>).forEach((key) => {\r\n\t\t\t\t\t\tif (data.buttons[key] && !prevButtonsRef.current![key]) {\r\n\t\t\t\t\t\t\tpressedBufferRef.current[key] = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tprevButtonsRef.current = data.buttons;\r\n\t\t\t\tlatestWiiDataRef.current = data;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"Parse error:\", e);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst handleDisconnect = () => {\r\n\t\t\tconst wasConnected = wasConnectedRef.current;\r\n\t\t\tsetWiiConnected(false);\r\n\t\t\twasConnectedRef.current = false;\r\n\t\t\tif (wasConnected) {\r\n\t\t\t\tsetWiiDisconnectedAt(Date.now());\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tws.onerror = handleDisconnect;\r\n\t\tws.onclose = handleDisconnect;\r\n\r\n\t\treturn () => {\r\n\t\t\ttry { ws.close(); } catch {}\r\n\t\t\twsRef.current = null;\r\n\t\t};\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet raf = 0;\r\n\r\n\t\tconst flushState = (wiiDataOrNull: WiiState | null) => {\r\n\t\t\tconst wiiButtons = wiiDataOrNull?.buttons ?? null;\r\n\t\t\tconst kbButtons = kbButtonsRef.current;\r\n\r\n\t\t\tconst mergedButtons: WiiButtons = {\r\n\t\t\t\tA: (wiiButtons?.A ?? false) || kbButtons.A,\r\n\t\t\t\tB: (wiiButtons?.B ?? false) || kbButtons.B,\r\n\t\t\t\tOne: (wiiButtons?.One ?? false) || kbButtons.One,\r\n\t\t\t\tTwo: (wiiButtons?.Two ?? false) || kbButtons.Two,\r\n\t\t\t\tPlus: (wiiButtons?.Plus ?? false) || kbButtons.Plus,\r\n\t\t\t\tMinus: (wiiButtons?.Minus ?? false) || kbButtons.Minus,\r\n\t\t\t\tHome: (wiiButtons?.Home ?? false) || kbButtons.Home,\r\n\t\t\t\tUp: (wiiButtons?.Up ?? false) || kbButtons.Up,\r\n\t\t\t\tDown: (wiiButtons?.Down ?? false) || kbButtons.Down,\r\n\t\t\t\tRight: (wiiButtons?.Right ?? false) || kbButtons.Right,\r\n\t\t\t\tLeft: (wiiButtons?.Left ?? false) || kbButtons.Left,\r\n\t\t\t};\r\n\r\n\t\t\tfor (const key of Object.keys(pressedBufferRef.current)) {\r\n\t\t\t\tpendingPressedRef.current[key as keyof WiiButtons] = true;\r\n\t\t\t}\r\n\t\t\tfor (const key of Object.keys(kbPressedBufferRef.current)) {\r\n\t\t\t\tpendingPressedRef.current[key as keyof WiiButtons] = true;\r\n\t\t\t}\r\n\t\t\tpressedBufferRef.current = {};\r\n\t\t\tkbPressedBufferRef.current = {};\r\n\r\n\t\t\tconst mergedPressed: Partial<WiiButtons> = { ...pendingPressedRef.current };\r\n\t\t\tpendingPressedRef.current = {};\r\n\r\n\t\t\tconst mergedState: WiiState = {\r\n\t\t\t\tbuttons: mergedButtons,\r\n\t\t\t\taccel: wiiDataOrNull?.accel ?? { x: 0, y: 0, z: 0 },\r\n\t\t\t\tir: wiiDataOrNull?.ir ?? [],\r\n\t\t\t\tcursor: wiiDataOrNull?.cursor ?? null,\r\n\t\t\t};\r\n\r\n\t\t\tsetWiiState(mergedState);\r\n\t\t\tsetPressed(mergedPressed);\r\n\t\t};\r\n\r\n\t\tconst loop = () => {\r\n\t\t\tflushState(latestWiiDataRef.current);\r\n\t\t\traf = window.requestAnimationFrame(loop);\r\n\t\t};\r\n\r\n\t\traf = window.requestAnimationFrame(loop);\r\n\t\treturn () => window.cancelAnimationFrame(raf);\r\n\t}, []);\r\n\r\n\tconst playWiiSound = (soundType: \"shot\" | \"oh\" | \"uxo\") => {\r\n\t\tif (!wsRef.current || wsRef.current.readyState !== WebSocket.OPEN) return;\r\n\t\ttry {\r\n\t\t\twsRef.current.send(JSON.stringify({ type: \"playSound\", soundType }));\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(\"Failed to send playSound message:\", e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst setIrCursorEnabledFn = (enabled: boolean) => {\r\n\t\tsetIrCursorEnabled(enabled);\r\n\t\tif (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\r\n\t\t\ttry {\r\n\t\t\t\twsRef.current.send(JSON.stringify({ type: \"setIrCursor\", enabled }));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"Failed to send setIrCursor message:\", e);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\twiiState,\r\n\t\tpressed,\r\n\t\twiiConnected,\r\n\t\twiiDisconnectedAt,\r\n\t\tirCursorEnabled,\r\n\t\tsetIrCursorEnabled: setIrCursorEnabledFn,\r\n\t\tplayWiiSound,\r\n\t};\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 344, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/ReactionOverlay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport type { ReactionType } from \"@/types\";\r\n\r\nconst SCALE = 3.5;\r\n\r\ntype Reaction = {\r\n    id: string;\r\n    type: ReactionType;\r\n    createdAt: number;\r\n    x: number;\r\n    size: number;\r\n    durationMs: number;\r\n    rotateDeg: number;\r\n};\r\n\r\nexport function ReactionOverlay(props: {\r\n    emitClap?: boolean;\r\n    emitLaugh?: boolean;\r\n    scale?: number;\r\n}) {\r\n    const { emitClap, emitLaugh } = props;\r\n    const scale = props.scale ?? 1;\r\n    const [items, setItems] = useState<Reaction[]>([]);\r\n\r\n    const add = (type: ReactionType) => {\r\n        const now = Date.now();\r\n        const baseSize = 26 + Math.floor(Math.random() * 18);\r\n        const r: Reaction = {\r\n            id: `${now}-${Math.random().toString(16).slice(2)}`,\r\n            type,\r\n            createdAt: now,\r\n            x: 0.65 + Math.random() * 0.3,\r\n            size: Math.round(baseSize * scale),\r\n            durationMs: 1200 + Math.floor(Math.random() * 700),\r\n            rotateDeg: -10 + Math.random() * 20,\r\n        };\r\n        setItems((prev) => [...prev, r]);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (emitClap) add(\"clap\");\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [emitClap]);\r\n\r\n    useEffect(() => {\r\n        if (emitLaugh) add(\"laugh\");\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [emitLaugh]);\r\n\r\n    useEffect(() => {\r\n        const t = setInterval(() => {\r\n            const now = Date.now();\r\n            setItems((prev) => prev.filter((r) => now - r.createdAt < r.durationMs + 250));\r\n        }, 250);\r\n        return () => clearInterval(t);\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            aria-hidden\r\n            style={{\r\n                position: \"absolute\",\r\n                right: 24 * scale,\r\n                bottom: 24 * scale,\r\n                width: 240 * scale,\r\n                height: 280 * scale,\r\n                pointerEvents: \"none\",\r\n                overflow: \"hidden\",\r\n                zIndex: 10001,\r\n            }}\r\n        >\r\n            {items.map((r) => (\r\n                <ReactionItem key={r.id} r={r} scale={scale} />\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction ReactionItem({ r, scale }: { r: Reaction; scale: number }) {\r\n    const glyph = r.type === \"clap\" ? \"üëè\" : \"üòÜ\";\r\n    const shadowV = 8 * scale;\r\n    const shadowBlur = 12 * scale;\r\n    const startY = 14 * scale;\r\n    const endY = 170 * scale;\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                position: \"absolute\",\r\n                bottom: 0,\r\n                left: `${Math.round(r.x * 100)}%`,\r\n                fontSize: r.size,\r\n                transform: `translateX(-50%) rotate(${r.rotateDeg}deg)`,\r\n                willChange: \"transform, opacity\",\r\n                animation: `reaction-float ${r.durationMs}ms ease-out forwards`,\r\n                filter: `drop-shadow(0 ${shadowV}px ${shadowBlur}px rgba(0,0,0,0.35))`,\r\n                userSelect: \"none\",\r\n            }}\r\n        >\r\n            {glyph}\r\n            <style jsx>{`\r\n                @keyframes reaction-float {\r\n                    0% {\r\n                        opacity: 0;\r\n                        transform: translateX(-50%) translateY(${startY}px) scale(0.9) rotate(${r.rotateDeg}deg);\r\n                    }\r\n                    12% {\r\n                        opacity: 0.95;\r\n                        transform: translateX(-50%) translateY(0px) scale(1) rotate(${r.rotateDeg}deg);\r\n                    }\r\n                    100% {\r\n                        opacity: 0;\r\n                        transform: translateX(-50%) translateY(-${endY}px) scale(1.08) rotate(${r.rotateDeg}deg);\r\n                    }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":";;;;;;AAEA;;;AAFA;;;AAKA,MAAM,QAAQ;AAYP,SAAS,gBAAgB,KAI/B;;IACG,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG;IAChC,MAAM,QAAQ,MAAM,KAAK,IAAI;IAC7B,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6MAAQ,EAAa,EAAE;IAEjD,MAAM,MAAM,CAAC;QACT,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,WAAW,KAAK,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;QACjD,MAAM,IAAc;YAChB,IAAI,GAAG,IAAI,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,IAAI;YACnD;YACA,WAAW;YACX,GAAG,OAAO,KAAK,MAAM,KAAK;YAC1B,MAAM,KAAK,KAAK,CAAC,WAAW;YAC5B,YAAY,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;YAC9C,WAAW,CAAC,KAAK,KAAK,MAAM,KAAK;QACrC;QACA,SAAS,CAAC,OAAS;mBAAI;gBAAM;aAAE;IACnC;IAEA,IAAA,8MAAS;qCAAC;YACN,IAAI,UAAU,IAAI;QAClB,uDAAuD;QAC3D;oCAAG;QAAC;KAAS;IAEb,IAAA,8MAAS;qCAAC;YACN,IAAI,WAAW,IAAI;QACnB,uDAAuD;QAC3D;oCAAG;QAAC;KAAU;IAEd,IAAA,8MAAS;qCAAC;YACN,MAAM,IAAI;+CAAY;oBAClB,MAAM,MAAM,KAAK,GAAG;oBACpB;uDAAS,CAAC,OAAS,KAAK,MAAM;+DAAC,CAAC,IAAM,MAAM,EAAE,SAAS,GAAG,EAAE,UAAU,GAAG;;;gBAC7E;8CAAG;YACH;6CAAO,IAAM,cAAc;;QAC/B;oCAAG,EAAE;IAEL,qBACI,iOAAC;QACG,aAAW;QACX,OAAO;YACH,UAAU;YACV,OAAO,KAAK;YACZ,QAAQ,KAAK;YACb,OAAO,MAAM;YACb,QAAQ,MAAM;YACd,eAAe;YACf,UAAU;YACV,QAAQ;QACZ;kBAEC,MAAM,GAAG,CAAC,CAAC,kBACR,iOAAC;gBAAwB,GAAG;gBAAG,OAAO;eAAnB,EAAE,EAAE;;;;;;;;;;AAIvC;GA7DgB;KAAA;AA+DhB,SAAS,aAAa,EAAE,CAAC,EAAE,KAAK,EAAkC;IAC9D,MAAM,QAAQ,EAAE,IAAI,KAAK,SAAS,OAAO;IACzC,MAAM,UAAU,IAAI;IACpB,MAAM,aAAa,KAAK;IACxB,MAAM,SAAS,KAAK;IACpB,MAAM,OAAO,MAAM;IAEnB,qBACI,iOAAC;QACG,OAAO;YACH,UAAU;YACV,QAAQ;YACR,MAAM,GAAG,KAAK,KAAK,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,CAAC;YACjC,UAAU,EAAE,IAAI;YAChB,WAAW,CAAC,wBAAwB,EAAE,EAAE,SAAS,CAAC,IAAI,CAAC;YACvD,YAAY;YACZ,WAAW,CAAC,eAAe,EAAE,EAAE,UAAU,CAAC,oBAAoB,CAAC;YAC/D,QAAQ,CAAC,cAAc,EAAE,QAAQ,GAAG,EAAE,WAAW,oBAAoB,CAAC;YACtE,YAAY;QAChB;;;;;oBAOqD;oBAA+B,EAAE,SAAS;oBAIrB,EAAE,SAAS;oBAI/B;oBAA8B,EAAE,SAAS;;;;;YAb9F;;;;oBAKoD;oBAA+B,EAAE,SAAS;oBAIrB,EAAE,SAAS;oBAI/B;oBAA8B,EAAE,SAAS;;yGAR1C,4BAA+B,EAAE,SAAS,gFAIrB,EAAE,SAAS,2DAI/B,4BAA8B,EAAE,SAAS;;;;;;;;AAM3G;MAxCS"}},
    {"offset": {"line": 501, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/buttonBindings.ts"],"sourcesContent":["import type { WiiState } from \"@/hooks/useWiiController\";\r\n\r\nexport type WiiButton = keyof WiiState[\"buttons\"];\r\n\r\nexport type BindingAction =\r\n\t| { type: \"none\"; subtype?: string }\r\n\t| { type: \"next\" }\r\n\t| { type: \"prev\" }\r\n\t| { type: \"branch\"; kind: \"A\" | \"B\" | \"HOME\" }\r\n\t| { type: \"branchIndex\"; index: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 }\r\n\t| { type: \"reaction\"; kind: \"clap\" | \"laugh\" }\r\n\t| { type: \"paint\" }\r\n\t| { type: \"eraser\" }\r\n\t| { type: \"sound\"; kind: \"shot\" | \"oh\" | \"uxo\"; outputDevice?: \"pc\" | \"wii\" }\r\n\t| { type: \"remove\" }\r\n\t| { type: \"irSens\" };\r\n\r\nexport type ButtonBindings = Partial<Record<WiiButton, BindingAction>>;\r\n\r\nexport type SoundOutputDevice = \"pc\" | \"wii\";\r\n\r\nexport interface SoundSettings {\r\n\toutputDevice: SoundOutputDevice;\r\n}\r\n\r\nexport const DEFAULT_SOUND_SETTINGS: SoundSettings = {\r\n\toutputDevice: \"pc\",\r\n};\r\n\r\nexport const DEFAULT_BINDINGS: ButtonBindings = {\r\n\tRight: { type: \"next\" },\r\n\tLeft: { type: \"prev\" },\r\n\tPlus: { type: \"branch\", kind: \"A\" },\r\n\tMinus: { type: \"branch\", kind: \"B\" },\r\n\tHome: { type: \"branch\", kind: \"HOME\" },\r\n\tOne: { type: \"reaction\", kind: \"clap\" },\r\n\tTwo: { type: \"reaction\", kind: \"laugh\" },\r\n};\r\n\r\nexport function formatAction(a: BindingAction): string {\r\n\tswitch (a.type) {\r\n\t\tcase \"none\":\r\n\t\t\treturn \"Êú™Ââ≤ÂΩì\";\r\n\t\tcase \"next\":\r\n\t\t\treturn \"Ê¨°„Å∏\";\r\n\t\tcase \"prev\":\r\n\t\t\treturn \"Êàª„Çã\";\r\n\t\tcase \"branch\":\r\n\t\t\tswitch (a.kind) {\r\n\t\t\t\tcase \"A\":\r\n\t\t\t\t\treturn \"A„É´„Éº„Éà„Å∏ÂàÜÂ≤ê\";\r\n\t\t\t\tcase \"B\":\r\n\t\t\t\t\treturn \"B„É´„Éº„Éà„Å∏ÂàÜÂ≤ê\";\r\n\t\t\t\tcase \"HOME\":\r\n\t\t\t\t\treturn \"HOME„Å∏Êàª„Çã\";\r\n\t\t\t}\r\n\t\tcase \"branchIndex\":\r\n\t\t\treturn `ÂàÜÂ≤ê ${a.index}`;\r\n\t\tcase \"reaction\":\r\n\t\t\treturn a.kind === \"clap\" ? \"ÊãçÊâã\" : \"Á¨ë„ÅÑ\";\r\n\t\tcase \"paint\":\r\n\t\t\treturn \"PAINTüé®\";\r\n\t\tcase \"eraser\":\r\n\t\t\treturn \"ERASER\";\r\n\t\tcase \"sound\": {\r\n\t\t\tconst device = a.outputDevice === \"wii\" ? \"[Wii]\" : \"[PC]\";\r\n\t\t\tswitch (a.kind) {\r\n\t\t\t\tcase \"shot\":\r\n\t\t\t\t\treturn `SHOTüîä${device}`;\r\n\t\t\t\tcase \"oh\":\r\n\t\t\t\t\treturn `Oh...üîä${device}`;\r\n\t\t\t\tcase \"uxo\":\r\n\t\t\t\t\treturn `Uxo~üîä${device}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase \"remove\":\r\n\t\t\treturn \"REMOVE\";\r\n\t\tcase \"irSens\":\r\n\t\t\treturn \"IRSensÂàáÊõø\";\r\n\t}\r\n}\r\n\r\nexport function mergeBindings(bindings?: ButtonBindings): ButtonBindings {\r\n\treturn {\r\n\t\t...DEFAULT_BINDINGS,\r\n\t\t...(bindings ?? {}),\r\n\t};\r\n}\r\n\r\nexport function encodeAction(a: BindingAction): string {\r\n\treturn JSON.stringify(a);\r\n}\r\n\r\nexport function decodeAction(s: string): BindingAction {\r\n\treturn JSON.parse(s) as BindingAction;\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAyBO,MAAM,yBAAwC;IACpD,cAAc;AACf;AAEO,MAAM,mBAAmC;IAC/C,OAAO;QAAE,MAAM;IAAO;IACtB,MAAM;QAAE,MAAM;IAAO;IACrB,MAAM;QAAE,MAAM;QAAU,MAAM;IAAI;IAClC,OAAO;QAAE,MAAM;QAAU,MAAM;IAAI;IACnC,MAAM;QAAE,MAAM;QAAU,MAAM;IAAO;IACrC,KAAK;QAAE,MAAM;QAAY,MAAM;IAAO;IACtC,KAAK;QAAE,MAAM;QAAY,MAAM;IAAQ;AACxC;AAEO,SAAS,aAAa,CAAgB;IAC5C,OAAQ,EAAE,IAAI;QACb,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAQ,EAAE,IAAI;gBACb,KAAK;oBACJ,OAAO;gBACR,KAAK;oBACJ,OAAO;gBACR,KAAK;oBACJ,OAAO;YACT;QACD,KAAK;YACJ,OAAO,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE;QACvB,KAAK;YACJ,OAAO,EAAE,IAAI,KAAK,SAAS,OAAO;QACnC,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YAAS;gBACb,MAAM,SAAS,EAAE,YAAY,KAAK,QAAQ,UAAU;gBACpD,OAAQ,EAAE,IAAI;oBACb,KAAK;wBACJ,OAAO,CAAC,MAAM,EAAE,QAAQ;oBACzB,KAAK;wBACJ,OAAO,CAAC,OAAO,EAAE,QAAQ;oBAC1B,KAAK;wBACJ,OAAO,CAAC,MAAM,EAAE,QAAQ;gBAC1B;YACD;QACA,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;IACT;AACD;AAEO,SAAS,cAAc,QAAyB;IACtD,OAAO;QACN,GAAG,gBAAgB;QACnB,GAAI,YAAY,CAAC,CAAC;IACnB;AACD;AAEO,SAAS,aAAa,CAAgB;IAC5C,OAAO,KAAK,SAAS,CAAC;AACvB;AAEO,SAAS,aAAa,CAAS;IACrC,OAAO,KAAK,KAAK,CAAC;AACnB"}},
    {"offset": {"line": 608, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/WiiDebugPanel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\nimport type { BindingAction, ButtonBindings } from \"@/lib/buttonBindings\";\r\nimport { formatAction } from \"@/lib/buttonBindings\";\r\n\r\ninterface WiiDebugPanelProps {\r\n\twiiState: WiiState | null;\r\n\tpressed: Record<string, boolean>;\r\n\teffectiveProjectBindings: ButtonBindings;\r\n\tirCursorEnabled?: boolean;\r\n\tonToggleIrCursor?: () => void;\r\n}\r\n\r\nconst BUTTON_ORDER = [\"Up\", \"Down\", \"Right\", \"Left\", \"A\", \"B\", \"Minus\", \"Home\", \"Plus\", \"One\", \"Two\"];\r\nconst ACCEL_UPDATE_INTERVAL = 200;\r\n\r\nexport function WiiDebugPanel({\r\n\twiiState,\r\n\tpressed,\r\n\teffectiveProjectBindings,\r\n\tirCursorEnabled,\r\n\tonToggleIrCursor,\r\n}: WiiDebugPanelProps) {\r\n\tconst [displayAccel, setDisplayAccel] = useState({ x: 0, y: 0, z: 0 });\r\n\tconst displayIrCountRef = useRef(0);\r\n\tconst displayButtonsRef = useRef(\"(none)\");\r\n\tconst displayBindingsRef = useRef<string[]>([]);\r\n\tconst lastAccelUpdateRef = useRef(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!wiiState?.accel) return;\r\n\r\n\t\tconst now = Date.now();\r\n\t\tif (now - lastAccelUpdateRef.current < ACCEL_UPDATE_INTERVAL) return;\r\n\r\n\t\tconst { x, y, z } = wiiState.accel;\r\n\t\tif (x === 0 && y === 0 && z === 0) return;\r\n\r\n\t\tsetDisplayAccel((prev) => {\r\n\t\t\tif (x !== prev.x || y !== prev.y || z !== prev.z) {\r\n\t\t\t\tlastAccelUpdateRef.current = now;\r\n\t\t\t\treturn { x, y, z };\r\n\t\t\t}\r\n\t\t\treturn prev;\r\n\t\t});\r\n\t}, [wiiState]);\r\n\r\n\tif (wiiState?.ir) {\r\n\t\tconst currentCount = wiiState.ir.length;\r\n\t\tif (currentCount !== displayIrCountRef.current) {\r\n\t\t\tdisplayIrCountRef.current = currentCount;\r\n\t\t}\r\n\t}\r\n\r\n\tconst pressedButtons = Object.entries(pressed)\r\n\t\t.filter(([, isDown]) => isDown)\r\n\t\t.map(([btn]) => btn);\r\n\tif (pressedButtons.length > 0) {\r\n\t\tdisplayButtonsRef.current = pressedButtons.join(\", \");\r\n\t}\r\n\r\n\tconst entries = Object.entries(effectiveProjectBindings) as Array<[string, BindingAction | undefined]>;\r\n\tentries.sort((a, b) => {\r\n\t\tconst indexA = BUTTON_ORDER.indexOf(a[0]);\r\n\t\tconst indexB = BUTTON_ORDER.indexOf(b[0]);\r\n\t\tif (indexA !== -1 && indexB !== -1) return indexA - indexB;\r\n\t\tif (indexA !== -1) return -1;\r\n\t\tif (indexB !== -1) return 1;\r\n\t\treturn a[0].localeCompare(b[0]);\r\n\t});\r\n\r\n\tconst currentBindings = entries.map(\r\n\t\t([btn, action]) => `${btn.padEnd(8)} ‚Üí ${action ? formatAction(action) : \"(unassigned)\"}`\r\n\t);\r\n\r\n\tif (\r\n\t\tcurrentBindings.length !== displayBindingsRef.current.length ||\r\n\t\tcurrentBindings.some((line, i) => line !== displayBindingsRef.current[i])\r\n\t) {\r\n\t\tdisplayBindingsRef.current = currentBindings;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\ttop: 20,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(0,0,0,0.82)\",\r\n\t\t\t\tcolor: \"#d1fae5\",\r\n\t\t\t\tpadding: \"12px 14px\",\r\n\t\t\t\tborderRadius: 10,\r\n\t\t\t\tfontSize: 14,\r\n\t\t\t\tfontFamily: \"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace\",\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t\tpointerEvents: \"auto\",\r\n\t\t\t\tminWidth: 360,\r\n\t\t\t\twhiteSpace: \"pre\",\r\n\t\t\t\tlineHeight: 1.35,\r\n\t\t\t\tborder: \"1px solid rgba(255,255,255,0.12)\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div style={{ fontWeight: 800, color: \"#a7f3d0\", marginBottom: 8 }}>Wii Debug</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>\r\n\t\t\t\tAcc: X={String(displayAccel.x).padStart(3)} Y={String(displayAccel.y).padStart(3)} Z=\r\n\t\t\t\t{String(displayAccel.z).padStart(3)}\r\n\t\t\t</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>IR : {displayIrCountRef.current}</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>{`Btn: ${displayButtonsRef.current}`}</div>\r\n\r\n\t\t\t{onToggleIrCursor && (\r\n\t\t\t\t<div style={{ marginTop: 8 }}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onToggleIrCursor}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackground: irCursorEnabled ? \"#10b981\" : \"#374151\",\r\n\t\t\t\t\t\t\tcolor: \"#fff\",\r\n\t\t\t\t\t\t\tborder: \"none\",\r\n\t\t\t\t\t\t\tborderRadius: 6,\r\n\t\t\t\t\t\t\tpadding: \"6px 12px\",\r\n\t\t\t\t\t\t\tcursor: \"pointer\",\r\n\t\t\t\t\t\t\tfontWeight: 700,\r\n\t\t\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{irCursorEnabled ? \"IR Cursor: ON\" : \"IR Cursor: OFF\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t<div style={{ margin: \"10px 0\", borderTop: \"1px solid rgba(255,255,255,0.12)\" }} />\r\n\t\t\t<div style={{ fontWeight: 800, color: \"#a7f3d0\", marginBottom: 6 }}>Bindings (project)</div>\r\n\t\t\t{displayBindingsRef.current.map((line) => (\r\n\t\t\t\t<div key={line}>{line}</div>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 838, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/WiiDisconnectPopup.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\n\r\ninterface WiiDisconnectPopupProps {\r\n\tisPlaying: boolean;\r\n\tstartedWithWii: boolean;\r\n\twiiConnected: boolean;\r\n\twiiDisconnectedAt: number | null;\r\n\tplayingSince: number;\r\n}\r\n\r\nexport function WiiDisconnectPopup({\r\n\tisPlaying,\r\n\tstartedWithWii,\r\n\twiiConnected,\r\n\twiiDisconnectedAt,\r\n\tplayingSince,\r\n}: WiiDisconnectPopupProps) {\r\n\tconst [open, setOpen] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isPlaying || !startedWithWii || !wiiDisconnectedAt) return;\r\n\t\tif (wiiDisconnectedAt < playingSince) return;\r\n\t\tsetOpen(true);\r\n\t}, [isPlaying, startedWithWii, wiiDisconnectedAt, playingSince]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (wiiConnected && open) setOpen(false);\r\n\t}, [wiiConnected, open]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handleKeyDown = (e: KeyboardEvent) => {\r\n\t\t\tif (e.key.toLowerCase() === \"d\") setOpen((prev) => !prev);\r\n\t\t};\r\n\t\twindow.addEventListener(\"keydown\", handleKeyDown);\r\n\t\treturn () => window.removeEventListener(\"keydown\", handleKeyDown);\r\n\t}, []);\r\n\r\n\tif (!open) return null;\r\n\r\n    return (\r\n        <div\r\n            role=\"dialog\"\r\n            aria-modal=\"true\"\r\n            aria-label=\"Wii„É™„É¢„Ç≥„É≥„ÅÆÊé•Á∂ö„ÅåÂàá„Çå„Åæ„Åó„Åü\"\r\n            style={{\r\n                position: \"absolute\",\r\n                inset: 0,\r\n                zIndex: 30000,\r\n                display: \"grid\",\r\n                placeItems: \"center\",\r\n                background: \"rgba(0,0,0,0.75)\",\r\n                color: \"white\",\r\n                padding: 24,\r\n            }}\r\n            onClick={() => setOpen(false)}\r\n        >\r\n            <div\r\n                style={{ display: \"inline-block\", transformOrigin: \"center\" }}\r\n                onClick={(e) => e.stopPropagation()}\r\n            >\r\n                {/* ÂÖ®‰Ωì„ÇíÊØîÁéá„Åù„ÅÆ„Åæ„Åæ„Å´Êã°Â§ß scale„ÅßÊã°Â§ßÁ∏ÆÂ∞è*/}\r\n                <div style={{ transform: \"scale(1)\", transformOrigin: \"center\", display: \"inline-block\" }}>\r\n                    <div\r\n                        style={{\r\n                            width: \"min(720px, 92vw)\",\r\n                            borderRadius: 14,\r\n                            background: \"#FFFFFF\",\r\n                            border: \"3px solid #FF0000\",\r\n                            boxShadow: \"0 20px 80px rgba(255, 0, 0, 0.3)\",\r\n                            padding: 24,\r\n                            textAlign: \"center\",\r\n                        }}\r\n                        onClick={(e) => e.stopPropagation()}\r\n                    >\r\n                        <div style={{ fontSize: 30, fontWeight: 400, marginBottom: 10, color: \"#FF0000\", fontFamily: \"Doto, sans-serif\" }}>\r\n                            Wii-Remote Disconected‚Ä¶\r\n                        </div>\r\n                        <div style={{ fontSize: 16, opacity: 0.9, lineHeight: 1.6, color: \"#000000\" }}>\r\n                            Êé•Á∂öÔºàBluetooth/ÈõªÊ±†Ôºâ„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ<br />\r\n                            „Ç≠„Éº„Éú„Éº„ÉâÊìç‰ΩúÔºà‚Üê/‚ÜíÔºâ„ÅØÂºï„ÅçÁ∂ö„ÅçÂà©Áî®„Åß„Åç„Åæ„Åô„ÄÇ\r\n                        </div>\r\n\r\n                        <div style={{ marginTop: 16, display: \"flex\", justifyContent: \"center\", gap: 12 }}>\r\n                            <button onClick={() => setOpen(false)} style={{ padding: \"10px 16px\", fontSize: 16 }}>\r\n                                Èñâ„Åò„Çã\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAYO,SAAS,mBAAmB,EAClC,SAAS,EACT,cAAc,EACd,YAAY,EACZ,iBAAiB,EACjB,YAAY,EACa;;IACzB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6MAAQ,EAAC;IAEjC,IAAA,8MAAS;wCAAC;YACT,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,mBAAmB;YACzD,IAAI,oBAAoB,cAAc;YACtC,QAAQ;QACT;uCAAG;QAAC;QAAW;QAAgB;QAAmB;KAAa;IAE/D,IAAA,8MAAS;wCAAC;YACT,IAAI,gBAAgB,MAAM,QAAQ;QACnC;uCAAG;QAAC;QAAc;KAAK;IAEvB,IAAA,8MAAS;wCAAC;YACT,MAAM;8DAAgB,CAAC;oBACtB,IAAI,EAAE,GAAG,CAAC,WAAW,OAAO,KAAK;sEAAQ,CAAC,OAAS,CAAC;;gBACrD;;YACA,OAAO,gBAAgB,CAAC,WAAW;YACnC;gDAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACpD;uCAAG,EAAE;IAEL,IAAI,CAAC,MAAM,OAAO;IAEf,qBACI,iOAAC;QACG,MAAK;QACL,cAAW;QACX,cAAW;QACX,OAAO;YACH,UAAU;YACV,OAAO;YACP,QAAQ;YACR,SAAS;YACT,YAAY;YACZ,YAAY;YACZ,OAAO;YACP,SAAS;QACb;QACA,SAAS,IAAM,QAAQ;kBAEvB,cAAA,iOAAC;YACG,OAAO;gBAAE,SAAS;gBAAgB,iBAAiB;YAAS;YAC5D,SAAS,CAAC,IAAM,EAAE,eAAe;sBAGjC,cAAA,iOAAC;gBAAI,OAAO;oBAAE,WAAW;oBAAY,iBAAiB;oBAAU,SAAS;gBAAe;0BACpF,cAAA,iOAAC;oBACG,OAAO;wBACH,OAAO;wBACP,cAAc;wBACd,YAAY;wBACZ,QAAQ;wBACR,WAAW;wBACX,SAAS;wBACT,WAAW;oBACf;oBACA,SAAS,CAAC,IAAM,EAAE,eAAe;;sCAEjC,iOAAC;4BAAI,OAAO;gCAAE,UAAU;gCAAI,YAAY;gCAAK,cAAc;gCAAI,OAAO;gCAAW,YAAY;4BAAmB;sCAAG;;;;;;sCAGnH,iOAAC;4BAAI,OAAO;gCAAE,UAAU;gCAAI,SAAS;gCAAK,YAAY;gCAAK,OAAO;4BAAU;;gCAAG;8CACjD,iOAAC;;;;;gCAAK;;;;;;;sCAIpC,iOAAC;4BAAI,OAAO;gCAAE,WAAW;gCAAI,SAAS;gCAAQ,gBAAgB;gCAAU,KAAK;4BAAG;sCAC5E,cAAA,iOAAC;gCAAO,SAAS,IAAM,QAAQ;gCAAQ,OAAO;oCAAE,SAAS;oCAAa,UAAU;gCAAG;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASlH;GAlFgB;KAAA"}},
    {"offset": {"line": 1018, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/WiiReconnectPopup.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState, useRef } from \"react\";\r\n\r\ntype Props = {\r\n    isPlaying: boolean;\r\n    wiiConnected: boolean;\r\n    startedWithWii: boolean;\r\n};\r\n\r\nexport function WiiReconnectPopup({ isPlaying, wiiConnected, startedWithWii }: Props) {\r\n    const [open, setOpen] = useState(false);\r\n    const prevConnectedRef = useRef(wiiConnected);\r\n\r\n    useEffect(() => {\r\n        if (!isPlaying || !startedWithWii) return;\r\n\r\n        const wasDisconnected = !prevConnectedRef.current;\r\n        const isNowConnected = wiiConnected;\r\n\r\n        if (wasDisconnected && isNowConnected) {\r\n            setOpen(true);\r\n\r\n            const timer = setTimeout(() => {\r\n                setOpen(false);\r\n            }, 1500);\r\n\r\n            return () => clearTimeout(timer);\r\n        }\r\n\r\n        prevConnectedRef.current = wiiConnected;\r\n    }, [wiiConnected, isPlaying, startedWithWii]);\r\n\r\n    useEffect(() => {\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (e.key.toLowerCase() === 'r') {\r\n                setOpen((prev) => !prev);\r\n            }\r\n        };\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, []);\r\n\r\n    if (!open) return null;\r\n\r\n    return (\r\n        <div\r\n            role=\"alert\"\r\n            aria-live=\"polite\"\r\n            aria-label=\"Wii„É™„É¢„Ç≥„É≥„ÅåÊé•Á∂ö„Åï„Çå„Åæ„Åó„Åü\"\r\n            style={{\r\n                position: \"absolute\",\r\n                top: 80,\r\n                right: 20,\r\n                zIndex: 30000,\r\n                width: \"auto\",\r\n                pointerEvents: \"none\",\r\n            }}\r\n        >\r\n            <div\r\n                style={{\r\n                    display: \"inline-block\",\r\n                    transformOrigin: \"top right\",\r\n                    pointerEvents: \"auto\",\r\n                }}\r\n            >\r\n                <div\r\n                    style={{\r\n                        display: \"inline-block\",\r\n                        animation: \"slideInRight 0.3s ease-out\",\r\n                        transformOrigin: \"top right\",\r\n                    }}\r\n                >\r\n                    <div\r\n                        style={{\r\n                            display: \"inline-block\",\r\n                            transform: \"scale(1)\",\r\n                            transformOrigin: \"top right\",\r\n                            borderRadius: 14,\r\n                            background: \"#FFFFFF\",\r\n                            border: \"3px solid #87CEEB\",\r\n                            boxShadow: \"0 10px 40px rgba(135, 206, 235, 0.4)\",\r\n                            padding: 20,\r\n                            color: \"#87CEEB\",\r\n                            textAlign: \"center\",\r\n                            width: \"min(400px, 90vw)\",\r\n                        }}\r\n                    >\r\n                        <div style={{ fontSize: 24, fontWeight: 400, marginBottom: 8, fontFamily: \"Doto, sans-serif\" }}>\r\n                            Wii-Remote Conected!\r\n                        </div>\r\n                        <div style={{ fontSize: 14, opacity: 0.8, lineHeight: 1.5, color: \"#000000\" }}>\r\n                            Êìç‰Ωú„ÇíÂÜçÈñã„Åß„Åç„Åæ„Åô\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <style jsx>{`\r\n                @keyframes slideInRight {\r\n                    from {\r\n                        transform: translateX(100%);\r\n                        opacity: 0;\r\n                    }\r\n                    to {\r\n                        transform: translateX(0);\r\n                        opacity: 1;\r\n                    }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA;;;AAFA;;;AAUO,SAAS,kBAAkB,EAAE,SAAS,EAAE,YAAY,EAAE,cAAc,EAAS;;IAChF,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6MAAQ,EAAC;IACjC,MAAM,mBAAmB,IAAA,2MAAM,EAAC;IAEhC,IAAA,8MAAS;uCAAC;YACN,IAAI,CAAC,aAAa,CAAC,gBAAgB;YAEnC,MAAM,kBAAkB,CAAC,iBAAiB,OAAO;YACjD,MAAM,iBAAiB;YAEvB,IAAI,mBAAmB,gBAAgB;gBACnC,QAAQ;gBAER,MAAM,QAAQ;yDAAW;wBACrB,QAAQ;oBACZ;wDAAG;gBAEH;mDAAO,IAAM,aAAa;;YAC9B;YAEA,iBAAiB,OAAO,GAAG;QAC/B;sCAAG;QAAC;QAAc;QAAW;KAAe;IAE5C,IAAA,8MAAS;uCAAC;YACN,MAAM;6DAAgB,CAAC;oBACnB,IAAI,EAAE,GAAG,CAAC,WAAW,OAAO,KAAK;wBAC7B;yEAAQ,CAAC,OAAS,CAAC;;oBACvB;gBACJ;;YACA,OAAO,gBAAgB,CAAC,WAAW;YACnC;+CAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACvD;sCAAG,EAAE;IAEL,IAAI,CAAC,MAAM,OAAO;IAElB,qBACI,iOAAC;QACG,MAAK;QACL,aAAU;QACV,cAAW;QACX,OAAO;YACH,UAAU;YACV,KAAK;YACL,OAAO;YACP,QAAQ;YACR,OAAO;YACP,eAAe;QACnB;;;0BAEA,iOAAC;gBACG,OAAO;oBACH,SAAS;oBACT,iBAAiB;oBACjB,eAAe;gBACnB;;0BAEA,cAAA,iOAAC;oBACG,OAAO;wBACH,SAAS;wBACT,WAAW;wBACX,iBAAiB;oBACrB;;8BAEA,cAAA,iOAAC;wBACG,OAAO;4BACH,SAAS;4BACT,WAAW;4BACX,iBAAiB;4BACjB,cAAc;4BACd,YAAY;4BACZ,QAAQ;4BACR,WAAW;4BACX,SAAS;4BACT,OAAO;4BACP,WAAW;4BACX,OAAO;wBACX;;;0CAEA,iOAAC;gCAAI,OAAO;oCAAE,UAAU;oCAAI,YAAY;oCAAK,cAAc;oCAAG,YAAY;gCAAmB;;0CAAG;;;;;;0CAGhG,iOAAC;gCAAI,OAAO;oCAAE,UAAU;oCAAI,SAAS;oCAAK,YAAY;oCAAK,OAAO;gCAAU;;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBvG;GAtGgB;KAAA"}},
    {"offset": {"line": 1185, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/PdfSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ninterface PdfSlideProps {\r\n\tassetId: string;\r\n\tpage: number;\r\n\tfallbackDataUrl?: string;\r\n\talt: string;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<unknown>;\r\n}\r\n\r\nexport function PdfSlide({ assetId, page, fallbackDataUrl, alt, getOrLoadPdfDocument }: PdfSlideProps) {\r\n\tconst wrapperRef = useRef<HTMLDivElement | null>(null);\r\n\tconst canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n\tconst [size, setSize] = useState<{ w: number; h: number } | null>(null);\r\n\tconst [renderError, setRenderError] = useState<string | null>(null);\r\n\tconst renderTaskRef = useRef<{ cancel: () => void } | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst el = wrapperRef.current;\r\n\t\tif (!el) return;\r\n\r\n\t\tconst update = () => {\r\n\t\t\tconst rect = el.getBoundingClientRect();\r\n\t\t\tsetSize({ w: Math.max(0, rect.width), h: Math.max(0, rect.height) });\r\n\t\t};\r\n\t\tupdate();\r\n\r\n\t\tconst ro = new ResizeObserver(update);\r\n\t\tro.observe(el);\r\n\t\treturn () => ro.disconnect();\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet cancelled = false;\r\n\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetRenderError(null);\r\n\r\n\t\t\t\tconst el = wrapperRef.current;\r\n\t\t\t\tconst canvas = canvasRef.current;\r\n\t\t\t\tif (!el || !canvas || !size || size.w === 0 || size.h === 0) return;\r\n\r\n\t\t\t\tif (renderTaskRef.current) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\trenderTaskRef.current.cancel();\r\n\t\t\t\t\t} catch {\r\n\t\t\t\t\t\t// Already cancelled\r\n\t\t\t\t\t}\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst pdf = (await getOrLoadPdfDocument(assetId)) as {\r\n\t\t\t\t\tgetPage: (page: number) => Promise<{\r\n\t\t\t\t\t\tgetViewport: (options: { scale: number }) => { width: number; height: number };\r\n\t\t\t\t\t\trender: (options: { canvasContext: CanvasRenderingContext2D; canvas: HTMLCanvasElement; viewport: unknown }) => { promise: Promise<void> };\r\n\t\t\t\t\t}>;\r\n\t\t\t\t};\r\n\t\t\t\tif (cancelled) return;\r\n\r\n\t\t\t\tconst pdfPage = await pdf.getPage(page);\r\n\t\t\t\tif (cancelled) return;\r\n\r\n\t\t\t\tconst viewport1 = pdfPage.getViewport({ scale: 1 });\r\n\t\t\t\tconst scale = Math.min(size.w / viewport1.width, size.h / viewport1.height);\r\n\t\t\t\tconst dpr = typeof window !== \"undefined\" ? window.devicePixelRatio || 1 : 1;\r\n\t\t\t\tconst renderViewport = pdfPage.getViewport({ scale: scale * dpr });\r\n\r\n\t\t\t\tcanvas.width = Math.floor(renderViewport.width);\r\n\t\t\t\tcanvas.height = Math.floor(renderViewport.height);\r\n\t\t\t\tcanvas.style.width = `${Math.floor(renderViewport.width / dpr)}px`;\r\n\t\t\t\tcanvas.style.height = `${Math.floor(renderViewport.height / dpr)}px`;\r\n\r\n\t\t\t\tconst ctx = canvas.getContext(\"2d\");\r\n\t\t\t\tif (!ctx) return;\r\n\r\n\t\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tconst task = pdfPage.render({ canvasContext: ctx, canvas, viewport: renderViewport });\r\n\t\t\t\trenderTaskRef.current = task as unknown as { cancel: () => void };\r\n\r\n\t\t\t\tawait task.promise;\r\n\r\n\t\t\t\tif (renderTaskRef.current === (task as unknown)) {\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t}\r\n\t\t\t} catch (e: unknown) {\r\n\t\t\t\tconst error = e as { name?: string; message?: string };\r\n\t\t\t\tconst msg = error?.name === \"RenderingCancelledException\" ? null : error?.message || String(e);\r\n\t\t\t\tif (!cancelled && msg) setRenderError(msg);\r\n\t\t\t}\r\n\t\t})();\r\n\r\n\t\treturn () => {\r\n\t\t\tcancelled = true;\r\n\t\t\tif (renderTaskRef.current) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\trenderTaskRef.current.cancel();\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// Already cancelled\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}, [assetId, getOrLoadPdfDocument, page, size]);\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tref={wrapperRef}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}\r\n\t\t>\r\n\t\t\t{renderError && fallbackDataUrl ? (\r\n\t\t\t\t<img src={fallbackDataUrl} style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }} alt={alt} />\r\n\t\t\t) : (\r\n\t\t\t\t<canvas ref={canvasRef} aria-label={alt} />\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1344, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/VideoSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAssetBlob } from \"@/lib/idbAssets\";\r\n\r\ninterface VideoSlideProps {\r\n\tassetId: string;\r\n\talt: string;\r\n}\r\n\r\nexport function VideoSlide({ assetId, alt }: VideoSlideProps) {\r\n\tconst [src, setSrc] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet active = true;\r\n\t\tlet url: string | null = null;\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetError(null);\r\n\t\t\t\tsetSrc(null);\r\n\t\t\t\tconst blob = await getAssetBlob(assetId);\r\n\t\t\t\tif (!blob) throw new Error(\"ÂãïÁîª„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\r\n\t\t\t\turl = URL.createObjectURL(blob);\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetSrc(url);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetError(e instanceof Error ? e.message : String(e));\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tactive = false;\r\n\t\t\tif (url) URL.revokeObjectURL(url);\r\n\t\t};\r\n\t}, [assetId]);\r\n\r\n\tif (error) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÂãïÁîª„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: {error}</div>;\r\n\t}\r\n\tif (!src) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÂãïÁîª„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<video\r\n\t\t\tsrc={src}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\r\n\t\t\tcontrols\r\n\t\t\tautoPlay\r\n\t\t\tplaysInline\r\n\t\t\taria-label={alt}\r\n\t\t/>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAUO,SAAS,WAAW,EAAE,OAAO,EAAE,GAAG,EAAmB;;IAC3D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,6MAAQ,EAAgB;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6MAAQ,EAAgB;IAElD,IAAA,8MAAS;gCAAC;YACT,IAAI,SAAS;YACb,IAAI,MAAqB;YACzB;wCAAC;oBACA,IAAI;wBACH,SAAS;wBACT,OAAO;wBACP,MAAM,OAAO,MAAM,AAJrB,IAIqB,8KAAY,AAShC,EATiC;wBAChC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;wBAC3B,MAAM,IAAI,eAAe,CAAC;wBAC1B,IAAI,CAAC,QAAQ;wBACb,OAAO;oBACR,EAAE,OAAO,GAAG;wBACX,IAAI,CAAC,QAAQ;wBACb,SAAS,aAAa,QAAQ,EAAE,OAAO,GAAG,OAAO;oBAClD;gBACD;;YACA;wCAAO;oBACN,SAAS;oBACT,IAAI,KAAK,IAAI,eAAe,CAAC;gBAC9B;;QACD;+BAAG;QAAC;KAAQ;IAEZ,IAAI,OAAO;QACV,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;;gBAAG;gBAAiB;;;;;;;IAC9E;IACA,IAAI,CAAC,KAAK;QACT,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;sBAAG;;;;;;IAC7D;IAEA,qBACC,iOAAC;QACA,KAAK;QACL,OAAO;YAAE,OAAO;YAAQ,QAAQ;YAAQ,WAAW;QAAU;QAC7D,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,cAAY;;;;;;AAGf;GA5CgB;KAAA"}},
    {"offset": {"line": 1447, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/ImageSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAssetBlob } from \"@/lib/idbAssets\";\r\n\r\ninterface ImageSlideProps {\r\n\tassetId: string;\r\n\talt: string;\r\n}\r\n\r\nexport function ImageSlide({ assetId, alt }: ImageSlideProps) {\r\n\tconst [src, setSrc] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet active = true;\r\n\t\tlet url: string | null = null;\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetError(null);\r\n\t\t\t\tsetSrc(null);\r\n\t\t\t\tconst blob = await getAssetBlob(assetId);\r\n\t\t\t\tif (!blob) throw new Error(\"ÁîªÂÉè„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\r\n\t\t\t\turl = URL.createObjectURL(blob);\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetSrc(url);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetError(e instanceof Error ? e.message : String(e));\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tactive = false;\r\n\t\t\tif (url) URL.revokeObjectURL(url);\r\n\t\t};\r\n\t}, [assetId]);\r\n\r\n\tif (error) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: {error}</div>;\r\n\t}\r\n\tif (!src) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÁîªÂÉè„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<img\r\n\t\t\tsrc={src}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\r\n\t\t\talt={alt}\r\n\t\t/>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAUO,SAAS,WAAW,EAAE,OAAO,EAAE,GAAG,EAAmB;;IAC3D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,6MAAQ,EAAgB;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6MAAQ,EAAgB;IAElD,IAAA,8MAAS;gCAAC;YACT,IAAI,SAAS;YACb,IAAI,MAAqB;YACzB;wCAAC;oBACA,IAAI;wBACH,SAAS;wBACT,OAAO;wBACP,MAAM,OAAO,MAAM,AAJrB,IAIqB,8KAAY,AAShC,EATiC;wBAChC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;wBAC3B,MAAM,IAAI,eAAe,CAAC;wBAC1B,IAAI,CAAC,QAAQ;wBACb,OAAO;oBACR,EAAE,OAAO,GAAG;wBACX,IAAI,CAAC,QAAQ;wBACb,SAAS,aAAa,QAAQ,EAAE,OAAO,GAAG,OAAO;oBAClD;gBACD;;YACA;wCAAO;oBACN,SAAS;oBACT,IAAI,KAAK,IAAI,eAAe,CAAC;gBAC9B;;QACD;+BAAG;QAAC;KAAQ;IAEZ,IAAI,OAAO;QACV,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;;gBAAG;gBAAiB;;;;;;;IAC9E;IACA,IAAI,CAAC,KAAK;QACT,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;sBAAG;;;;;;IAC7D;IAEA,qBACC,iOAAC;QACA,KAAK;QACL,OAAO;YAAE,OAAO;YAAQ,QAAQ;YAAQ,WAAW;QAAU;QAC7D,KAAK;;;;;;AAGR;GAzCgB;KAAA"}},
    {"offset": {"line": 1547, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/SlideDisplay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { Node } from \"@xyflow/react\";\r\nimport type { SlideNodeData } from \"@/types\";\r\nimport { PdfSlide } from \"./PdfSlide\";\r\nimport { VideoSlide } from \"./VideoSlide\";\r\nimport { ImageSlide } from \"./ImageSlide\";\r\n\r\ninterface SlideDisplayProps {\r\n\tcurrentNode: Node<SlideNodeData> | undefined;\r\n\terror: string | null;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<unknown>;\r\n}\r\n\r\nexport function SlideDisplay({ currentNode, error, getOrLoadPdfDocument }: SlideDisplayProps) {\r\n\treturn (\r\n\t\t<div style={{ position: \"absolute\", inset: 0, display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n\t\t\t{currentNode ? (\r\n\t\t\t\t<SlideContent currentNode={currentNode} getOrLoadPdfDocument={getOrLoadPdfDocument} />\r\n\t\t\t) : (\r\n\t\t\t\t<div style={{ color: \"white\" }}>{error ?? \"„Çπ„É©„Ç§„Éâ„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì\"}</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction SlideContent({\r\n\tcurrentNode,\r\n\tgetOrLoadPdfDocument,\r\n}: {\r\n\tcurrentNode: Node<SlideNodeData>;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<unknown>;\r\n}) {\r\n\tconst asset = currentNode.data.asset;\r\n\r\n\tif (!asset) {\r\n\t\treturn (\r\n\t\t\t<h1 style={{ fontSize: 80, color: \"white\", textAlign: \"center\", maxWidth: \"80%\" }}>\r\n\t\t\t\t{currentNode.data.label}\r\n\t\t\t</h1>\r\n\t\t);\r\n\t}\r\n\r\n\tswitch (asset.kind) {\r\n\t\tcase \"pdf\":\r\n\t\t\treturn (\r\n\t\t\t\t<PdfSlide\r\n\t\t\t\t\tassetId={asset.assetId}\r\n\t\t\t\t\tpage={asset.page ?? 1}\r\n\t\t\t\t\tfallbackDataUrl={asset.thumbnailDataUrl}\r\n\t\t\t\t\talt={currentNode.data.label}\r\n\t\t\t\t\tgetOrLoadPdfDocument={getOrLoadPdfDocument}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\tcase \"video\":\r\n\t\t\treturn <VideoSlide assetId={asset.assetId} alt={currentNode.data.label} />;\r\n\t\tcase \"image\":\r\n\t\t\treturn <ImageSlide assetId={asset.assetId} alt={currentNode.data.label} />;\r\n\t\tdefault:\r\n\t\t\treturn null;\r\n\t}\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AACA;AACA;AANA;;;;;AAcO,SAAS,aAAa,EAAE,WAAW,EAAE,KAAK,EAAE,oBAAoB,EAAqB;IAC3F,qBACC,iOAAC;QAAI,OAAO;YAAE,UAAU;YAAY,OAAO;YAAG,SAAS;YAAQ,YAAY;YAAU,gBAAgB;QAAS;kBAC5G,4BACA,iOAAC;YAAa,aAAa;YAAa,sBAAsB;;;;;iCAE9D,iOAAC;YAAI,OAAO;gBAAE,OAAO;YAAQ;sBAAI,SAAS;;;;;;;;;;;AAI9C;KAVgB;AAYhB,SAAS,aAAa,EACrB,WAAW,EACX,oBAAoB,EAIpB;IACA,MAAM,QAAQ,YAAY,IAAI,CAAC,KAAK;IAEpC,IAAI,CAAC,OAAO;QACX,qBACC,iOAAC;YAAG,OAAO;gBAAE,UAAU;gBAAI,OAAO;gBAAS,WAAW;gBAAU,UAAU;YAAM;sBAC9E,YAAY,IAAI,CAAC,KAAK;;;;;;IAG1B;IAEA,OAAQ,MAAM,IAAI;QACjB,KAAK;YACJ,qBACC,iOAAC,8LAAQ;gBACR,SAAS,MAAM,OAAO;gBACtB,MAAM,MAAM,IAAI,IAAI;gBACpB,iBAAiB,MAAM,gBAAgB;gBACvC,KAAK,YAAY,IAAI,CAAC,KAAK;gBAC3B,sBAAsB;;;;;;QAGzB,KAAK;YACJ,qBAAO,iOAAC,kMAAU;gBAAC,SAAS,MAAM,OAAO;gBAAE,KAAK,YAAY,IAAI,CAAC,KAAK;;;;;;QACvE,KAAK;YACJ,qBAAO,iOAAC,kMAAU;gBAAC,SAAS,MAAM,OAAO;gBAAE,KAAK,YAAY,IAAI,CAAC,KAAK;;;;;;QACvE;YACC,OAAO;IACT;AACD;MAnCS"}},
    {"offset": {"line": 1656, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/DrawingCanvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\nimport type { DrawingPoint, Position } from \"@/types\";\r\n\r\ninterface DrawingCanvasProps {\r\n\tdrawingPoints: DrawingPoint[];\r\n\twiiState: WiiState | null;\r\n\tisPlaying: boolean;\r\n\tshouldPaint: boolean;\r\n\teraserMode: boolean;\r\n\teraserPosition: Position | null;\r\n}\r\n\r\nconst ERASER_RADIUS = 60;\r\nconst ERASER_STEP = 12;\r\nconst ERASER_ALPHA = 0.18;\r\nconst ERASER_BLUR = 25;\r\nconst PEN_WIDTH = 5;\r\nconst PEN_COLOR = \"red\";\r\n\r\nexport function DrawingCanvas({\r\n\tdrawingPoints,\r\n\teraserMode,\r\n\teraserPosition,\r\n}: DrawingCanvasProps) {\r\n\tconst drawingCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\tconst cursorCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\tconst lastDrawnIndexRef = useRef(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tconst width = window.innerWidth;\r\n\t\t\tconst height = window.innerHeight;\r\n\r\n\t\t\tif (drawingCanvasRef.current) {\r\n\t\t\t\tdrawingCanvasRef.current.width = width;\r\n\t\t\t\tdrawingCanvasRef.current.height = height;\r\n\t\t\t\tlastDrawnIndexRef.current = 0;\r\n\t\t\t}\r\n\t\t\tif (cursorCanvasRef.current) {\r\n\t\t\t\tcursorCanvasRef.current.width = width;\r\n\t\t\t\tcursorCanvasRef.current.height = height;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\thandleResize();\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => window.removeEventListener(\"resize\", handleResize);\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst canvas = drawingCanvasRef.current;\r\n\t\tconst ctx = canvas?.getContext(\"2d\");\r\n\t\tif (!canvas || !ctx) return;\r\n\r\n\t\tif (drawingPoints.length < lastDrawnIndexRef.current) {\r\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\t\tlastDrawnIndexRef.current = 0;\r\n\t\t}\r\n\r\n\t\tif (drawingPoints.length === lastDrawnIndexRef.current) return;\r\n\r\n\t\tctx.lineCap = \"round\";\r\n\t\tctx.lineJoin = \"round\";\r\n\r\n\t\tfor (let i = lastDrawnIndexRef.current; i < drawingPoints.length; i++) {\r\n\t\t\tconst point = drawingPoints[i];\r\n\t\t\tif (!point) continue;\r\n\r\n\t\t\tconst prev = i > 0 ? drawingPoints[i - 1] : null;\r\n\t\t\tconst mode = point.mode || \"draw\";\r\n\t\t\tconst isStart = !prev || prev.mode !== point.mode;\r\n\r\n\t\t\tif (isStart && mode === \"erase\") {\r\n\t\t\t\tdrawEraserStamp(ctx, point.x, point.y);\r\n\t\t\t} else if (!isStart && prev) {\r\n\t\t\t\tif (mode === \"draw\") {\r\n\t\t\t\t\tdrawLine(ctx, prev.x, prev.y, point.x, point.y);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdrawEraserPath(ctx, prev.x, prev.y, point.x, point.y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlastDrawnIndexRef.current = drawingPoints.length;\r\n\t}, [drawingPoints]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst canvas = cursorCanvasRef.current;\r\n\t\tconst ctx = canvas?.getContext(\"2d\");\r\n\t\tif (!canvas || !ctx) return;\r\n\r\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\tif (eraserMode && eraserPosition) {\r\n\t\t\tctx.save();\r\n\t\t\tctx.strokeStyle = \"rgba(255, 100, 100, 0.6)\";\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.setLineDash([8, 4]);\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(eraserPosition.x, eraserPosition.y, ERASER_RADIUS, 0, Math.PI * 2);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.setLineDash([]);\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}, [eraserMode, eraserPosition]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<canvas\r\n\t\t\t\tref={drawingCanvasRef}\r\n\t\t\t\tstyle={{ position: \"absolute\", top: 0, left: 0, pointerEvents: \"none\" }}\r\n\t\t\t/>\r\n\t\t\t<canvas\r\n\t\t\t\tref={cursorCanvasRef}\r\n\t\t\t\tstyle={{ position: \"absolute\", top: 0, left: 0, pointerEvents: \"none\" }}\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nfunction drawEraserStamp(ctx: CanvasRenderingContext2D, x: number, y: number) {\r\n\tctx.globalCompositeOperation = \"destination-out\";\r\n\tctx.fillStyle = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\tctx.shadowBlur = ERASER_BLUR;\r\n\tctx.shadowColor = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\tctx.beginPath();\r\n\tctx.arc(x, y, ERASER_RADIUS, 0, Math.PI * 2);\r\n\tctx.fill();\r\n}\r\n\r\nfunction drawLine(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number) {\r\n\tctx.globalCompositeOperation = \"source-over\";\r\n\tctx.strokeStyle = PEN_COLOR;\r\n\tctx.lineWidth = PEN_WIDTH;\r\n\tctx.shadowBlur = 0;\r\n\tctx.shadowColor = \"transparent\";\r\n\tctx.beginPath();\r\n\tctx.moveTo(x1, y1);\r\n\tctx.lineTo(x2, y2);\r\n\tctx.stroke();\r\n}\r\n\r\nfunction drawEraserPath(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number) {\r\n\tctx.globalCompositeOperation = \"destination-out\";\r\n\tctx.fillStyle = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\tctx.shadowBlur = ERASER_BLUR;\r\n\tctx.shadowColor = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\r\n\tconst dist = Math.hypot(x2 - x1, y2 - y1);\r\n\tconst angle = Math.atan2(y2 - y1, x2 - x1);\r\n\r\n\tfor (let d = ERASER_STEP; d <= dist; d += ERASER_STEP) {\r\n\t\tconst bx = x1 + Math.cos(angle) * d;\r\n\t\tconst by = y1 + Math.sin(angle) * d;\r\n\t\tctx.beginPath();\r\n\t\tctx.arc(bx, by, ERASER_RADIUS, 0, Math.PI * 2);\r\n\t\tctx.fill();\r\n\t}\r\n\r\n\tctx.beginPath();\r\n\tctx.arc(x2, y2, ERASER_RADIUS, 0, Math.PI * 2);\r\n\tctx.fill();\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAeA,MAAM,gBAAgB;AACtB,MAAM,cAAc;AACpB,MAAM,eAAe;AACrB,MAAM,cAAc;AACpB,MAAM,YAAY;AAClB,MAAM,YAAY;AAEX,SAAS,cAAc,EAC7B,aAAa,EACb,UAAU,EACV,cAAc,EACM;;IACpB,MAAM,mBAAmB,IAAA,2MAAM,EAAoB;IACnD,MAAM,kBAAkB,IAAA,2MAAM,EAAoB;IAClD,MAAM,oBAAoB,IAAA,2MAAM,EAAC;IAEjC,IAAA,8MAAS;mCAAC;YACT,MAAM;wDAAe;oBACpB,MAAM,QAAQ,OAAO,UAAU;oBAC/B,MAAM,SAAS,OAAO,WAAW;oBAEjC,IAAI,iBAAiB,OAAO,EAAE;wBAC7B,iBAAiB,OAAO,CAAC,KAAK,GAAG;wBACjC,iBAAiB,OAAO,CAAC,MAAM,GAAG;wBAClC,kBAAkB,OAAO,GAAG;oBAC7B;oBACA,IAAI,gBAAgB,OAAO,EAAE;wBAC5B,gBAAgB,OAAO,CAAC,KAAK,GAAG;wBAChC,gBAAgB,OAAO,CAAC,MAAM,GAAG;oBAClC;gBACD;;YAEA;YACA,OAAO,gBAAgB,CAAC,UAAU;YAClC;2CAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;;QACnD;kCAAG,EAAE;IAEL,IAAA,8MAAS;mCAAC;YACT,MAAM,SAAS,iBAAiB,OAAO;YACvC,MAAM,MAAM,QAAQ,WAAW;YAC/B,IAAI,CAAC,UAAU,CAAC,KAAK;YAErB,IAAI,cAAc,MAAM,GAAG,kBAAkB,OAAO,EAAE;gBACrD,IAAI,SAAS,CAAC,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;gBAC/C,kBAAkB,OAAO,GAAG;YAC7B;YAEA,IAAI,cAAc,MAAM,KAAK,kBAAkB,OAAO,EAAE;YAExD,IAAI,OAAO,GAAG;YACd,IAAI,QAAQ,GAAG;YAEf,IAAK,IAAI,IAAI,kBAAkB,OAAO,EAAE,IAAI,cAAc,MAAM,EAAE,IAAK;gBACtE,MAAM,QAAQ,aAAa,CAAC,EAAE;gBAC9B,IAAI,CAAC,OAAO;gBAEZ,MAAM,OAAO,IAAI,IAAI,aAAa,CAAC,IAAI,EAAE,GAAG;gBAC5C,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,MAAM,UAAU,CAAC,QAAQ,KAAK,IAAI,KAAK,MAAM,IAAI;gBAEjD,IAAI,WAAW,SAAS,SAAS;oBAChC,gBAAgB,KAAK,MAAM,CAAC,EAAE,MAAM,CAAC;gBACtC,OAAO,IAAI,CAAC,WAAW,MAAM;oBAC5B,IAAI,SAAS,QAAQ;wBACpB,SAAS,KAAK,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,MAAM,CAAC;oBAC/C,OAAO;wBACN,eAAe,KAAK,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,MAAM,CAAC;oBACrD;gBACD;YACD;YAEA,kBAAkB,OAAO,GAAG,cAAc,MAAM;QACjD;kCAAG;QAAC;KAAc;IAElB,IAAA,8MAAS;mCAAC;YACT,MAAM,SAAS,gBAAgB,OAAO;YACtC,MAAM,MAAM,QAAQ,WAAW;YAC/B,IAAI,CAAC,UAAU,CAAC,KAAK;YAErB,IAAI,SAAS,CAAC,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;YAE/C,IAAI,cAAc,gBAAgB;gBACjC,IAAI,IAAI;gBACR,IAAI,WAAW,GAAG;gBAClB,IAAI,SAAS,GAAG;gBAChB,IAAI,WAAW,CAAC;oBAAC;oBAAG;iBAAE;gBACtB,IAAI,SAAS;gBACb,IAAI,GAAG,CAAC,eAAe,CAAC,EAAE,eAAe,CAAC,EAAE,eAAe,GAAG,KAAK,EAAE,GAAG;gBACxE,IAAI,MAAM;gBACV,IAAI,WAAW,CAAC,EAAE;gBAClB,IAAI,OAAO;YACZ;QACD;kCAAG;QAAC;QAAY;KAAe;IAE/B,qBACC;;0BACC,iOAAC;gBACA,KAAK;gBACL,OAAO;oBAAE,UAAU;oBAAY,KAAK;oBAAG,MAAM;oBAAG,eAAe;gBAAO;;;;;;0BAEvE,iOAAC;gBACA,KAAK;gBACL,OAAO;oBAAE,UAAU;oBAAY,KAAK;oBAAG,MAAM;oBAAG,eAAe;gBAAO;;;;;;;;AAI1E;GAnGgB;KAAA;AAqGhB,SAAS,gBAAgB,GAA6B,EAAE,CAAS,EAAE,CAAS;IAC3E,IAAI,wBAAwB,GAAG;IAC/B,IAAI,SAAS,GAAG,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IAC7C,IAAI,UAAU,GAAG;IACjB,IAAI,WAAW,GAAG,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IAC/C,IAAI,SAAS;IACb,IAAI,GAAG,CAAC,GAAG,GAAG,eAAe,GAAG,KAAK,EAAE,GAAG;IAC1C,IAAI,IAAI;AACT;AAEA,SAAS,SAAS,GAA6B,EAAE,EAAU,EAAE,EAAU,EAAE,EAAU,EAAE,EAAU;IAC9F,IAAI,wBAAwB,GAAG;IAC/B,IAAI,WAAW,GAAG;IAClB,IAAI,SAAS,GAAG;IAChB,IAAI,UAAU,GAAG;IACjB,IAAI,WAAW,GAAG;IAClB,IAAI,SAAS;IACb,IAAI,MAAM,CAAC,IAAI;IACf,IAAI,MAAM,CAAC,IAAI;IACf,IAAI,MAAM;AACX;AAEA,SAAS,eAAe,GAA6B,EAAE,EAAU,EAAE,EAAU,EAAE,EAAU,EAAE,EAAU;IACpG,IAAI,wBAAwB,GAAG;IAC/B,IAAI,SAAS,GAAG,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IAC7C,IAAI,UAAU,GAAG;IACjB,IAAI,WAAW,GAAG,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IAE/C,MAAM,OAAO,KAAK,KAAK,CAAC,KAAK,IAAI,KAAK;IACtC,MAAM,QAAQ,KAAK,KAAK,CAAC,KAAK,IAAI,KAAK;IAEvC,IAAK,IAAI,IAAI,aAAa,KAAK,MAAM,KAAK,YAAa;QACtD,MAAM,KAAK,KAAK,KAAK,GAAG,CAAC,SAAS;QAClC,MAAM,KAAK,KAAK,KAAK,GAAG,CAAC,SAAS;QAClC,IAAI,SAAS;QACb,IAAI,GAAG,CAAC,IAAI,IAAI,eAAe,GAAG,KAAK,EAAE,GAAG;QAC5C,IAAI,IAAI;IACT;IAEA,IAAI,SAAS;IACb,IAAI,GAAG,CAAC,IAAI,IAAI,eAAe,GAAG,KAAK,EAAE,GAAG;IAC5C,IAAI,IAAI;AACT"}},
    {"offset": {"line": 1839, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/IrPointerOverlay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\n\r\ninterface IrPointerOverlayProps {\r\n\twiiState: WiiState | null;\r\n\tisPlaying: boolean;\r\n\tirCursorEnabled: boolean;\r\n\tshowIrDebug?: boolean;\r\n}\r\n\r\nfunction mapIrToScreen(irX: number, irY: number, screenW: number, screenH: number) {\r\n\treturn {\r\n\t\tx: (1 - irX / 1024) * screenW,\r\n\t\ty: (irY / 768) * screenH,\r\n\t};\r\n}\r\n\r\nexport function IrPointerOverlay({ wiiState, irCursorEnabled, showIrDebug = false }: IrPointerOverlayProps) {\r\n\tif (!showIrDebug || !wiiState) return null;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\tbottom: 60,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(0, 0, 0, 0.85)\",\r\n\t\t\t\tcolor: \"lime\",\r\n\t\t\t\tpadding: \"12px 16px\",\r\n\t\t\t\tborderRadius: 8,\r\n\t\t\t\tfontFamily: \"monospace\",\r\n\t\t\t\tfontSize: 12,\r\n\t\t\t\tlineHeight: 1.6,\r\n\t\t\t\tborder: \"1px solid rgba(0, 255, 0, 0.3)\",\r\n\t\t\t\tmaxWidth: 320,\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div style={{ fontWeight: \"bold\", marginBottom: 8, color: \"#0ff\" }}>üì° IR Sensor Debug</div>\r\n\t\t\t<div>\r\n\t\t\t\t<span style={{ color: \"#888\" }}>IRCursor:</span>{\" \"}\r\n\t\t\t\t<span style={{ color: irCursorEnabled ? \"#0f0\" : \"#f55\" }}>{irCursorEnabled ? \"ON\" : \"OFF\"}</span>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<span style={{ color: \"#888\" }}>Detected:</span> {wiiState.ir?.length || 0} point(s)\r\n\t\t\t</div>\r\n\t\t\t{wiiState.ir && wiiState.ir.length > 0 && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<hr style={{ margin: \"8px 0\", border: \"none\", borderTop: \"1px solid rgba(0,255,0,0.2)\" }} />\r\n\t\t\t\t\t{wiiState.ir.map((dot, index) => {\r\n\t\t\t\t\t\tconst screen = mapIrToScreen(dot.x, dot.y, window.innerWidth, window.innerHeight);\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div key={index} style={{ marginBottom: 4 }}>\r\n\t\t\t\t\t\t\t\t<div style={{ color: \"#0ff\" }}>IR {index + 1}:</div>\r\n\t\t\t\t\t\t\t\t<div style={{ paddingLeft: 12 }}>\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Raw:</span> ({dot.x}, {dot.y})\r\n\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Screen:</span> ({Math.round(screen.x)}, {Math.round(screen.y)})\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t\t<hr style={{ margin: \"8px 0\", border: \"none\", borderTop: \"1px solid rgba(0,255,0,0.2)\" }} />\r\n\t\t\t<div style={{ fontSize: 10, color: \"#666\" }}>\r\n\t\t\t\tÂ∫ßÊ®ôÁØÑÂõ≤: X(0-1023), Y(0-767)\r\n\t\t\t\t<br />\r\n\t\t\t\t[C] IR„Ç´„Éº„ÇΩ„É´ÂàáÊõø / [Space] „Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫ÂàáÊõø\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAWA,SAAS,cAAc,GAAW,EAAE,GAAW,EAAE,OAAe,EAAE,OAAe;IAChF,OAAO;QACN,GAAG,CAAC,IAAI,MAAM,IAAI,IAAI;QACtB,GAAG,AAAC,MAAM,MAAO;IAClB;AACD;AAEO,SAAS,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE,cAAc,KAAK,EAAyB;IACzG,IAAI,CAAC,eAAe,CAAC,UAAU,OAAO;IAEtC,qBACC,iOAAC;QACA,OAAO;YACN,UAAU;YACV,QAAQ;YACR,OAAO;YACP,YAAY;YACZ,OAAO;YACP,SAAS;YACT,cAAc;YACd,YAAY;YACZ,UAAU;YACV,YAAY;YACZ,QAAQ;YACR,UAAU;YACV,QAAQ;QACT;;0BAEA,iOAAC;gBAAI,OAAO;oBAAE,YAAY;oBAAQ,cAAc;oBAAG,OAAO;gBAAO;0BAAG;;;;;;0BACpE,iOAAC;;kCACA,iOAAC;wBAAK,OAAO;4BAAE,OAAO;wBAAO;kCAAG;;;;;;oBAAiB;kCACjD,iOAAC;wBAAK,OAAO;4BAAE,OAAO,kBAAkB,SAAS;wBAAO;kCAAI,kBAAkB,OAAO;;;;;;;;;;;;0BAEtF,iOAAC;;kCACA,iOAAC;wBAAK,OAAO;4BAAE,OAAO;wBAAO;kCAAG;;;;;;oBAAgB;oBAAE,SAAS,EAAE,EAAE,UAAU;oBAAE;;;;;;;YAE3E,SAAS,EAAE,IAAI,SAAS,EAAE,CAAC,MAAM,GAAG,mBACpC;;kCACC,iOAAC;wBAAG,OAAO;4BAAE,QAAQ;4BAAS,QAAQ;4BAAQ,WAAW;wBAA8B;;;;;;oBACtF,SAAS,EAAE,CAAC,GAAG,CAAC,CAAC,KAAK;wBACtB,MAAM,SAAS,cAAc,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,OAAO,UAAU,EAAE,OAAO,WAAW;wBAChF,qBACC,iOAAC;4BAAgB,OAAO;gCAAE,cAAc;4BAAE;;8CACzC,iOAAC;oCAAI,OAAO;wCAAE,OAAO;oCAAO;;wCAAG;wCAAI,QAAQ;wCAAE;;;;;;;8CAC7C,iOAAC;oCAAI,OAAO;wCAAE,aAAa;oCAAG;;sDAC7B,iOAAC;4CAAK,OAAO;gDAAE,OAAO;4CAAO;sDAAG;;;;;;wCAAW;wCAAG,IAAI,CAAC;wCAAC;wCAAG,IAAI,CAAC;wCAAC;sDAC7D,iOAAC;;;;;sDACD,iOAAC;4CAAK,OAAO;gDAAE,OAAO;4CAAO;sDAAG;;;;;;wCAAc;wCAAG,KAAK,KAAK,CAAC,OAAO,CAAC;wCAAE;wCAAG,KAAK,KAAK,CAAC,OAAO,CAAC;wCAAE;;;;;;;;2BALtF;;;;;oBASZ;;;0BAGF,iOAAC;gBAAG,OAAO;oBAAE,QAAQ;oBAAS,QAAQ;oBAAQ,WAAW;gBAA8B;;;;;;0BACvF,iOAAC;gBAAI,OAAO;oBAAE,UAAU;oBAAI,OAAO;gBAAO;;oBAAG;kCAE5C,iOAAC;;;;;oBAAK;;;;;;;;;;;;;AAKV;KAvDgB"}},
    {"offset": {"line": 2069, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/EraserCursor.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { Position } from \"@/types\";\r\n\r\ninterface EraserCursorProps {\r\n\tposition: Position | null;\r\n\tisActive: boolean;\r\n\tbuttonName?: string | null;\r\n}\r\n\r\nexport function EraserCursor({ position, isActive, buttonName }: EraserCursorProps) {\r\n\tif (!isActive || !position) return null;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"fixed\",\r\n\t\t\t\tbottom: 80,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(255, 100, 100, 0.7)\",\r\n\t\t\t\tcolor: \"white\",\r\n\t\t\t\tpadding: \"8px 16px\",\r\n\t\t\t\tborderRadius: 6,\r\n\t\t\t\tfontSize: 13,\r\n\t\t\t\tfontWeight: \"normal\",\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t\tboxShadow: \"0 2px 8px rgba(0,0,0,0.2)\",\r\n\t\t\t\tpointerEvents: \"none\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\tÊ∂à„Åó„Ç¥„É†„É¢„Éº„Éâ ON\r\n\t\t\t<br />\r\n\t\t\t<small style={{ fontSize: 11 }}>Â∑¶„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØA+B„ÅßÊ∂àÂéª | {buttonName || \"X\"}„ÅßËß£Èô§</small>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAUO,SAAS,aAAa,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAqB;IACjF,IAAI,CAAC,YAAY,CAAC,UAAU,OAAO;IAEnC,qBACC,iOAAC;QACA,OAAO;YACN,UAAU;YACV,QAAQ;YACR,OAAO;YACP,YAAY;YACZ,OAAO;YACP,SAAS;YACT,cAAc;YACd,UAAU;YACV,YAAY;YACZ,QAAQ;YACR,WAAW;YACX,eAAe;QAChB;;YACA;0BAEA,iOAAC;;;;;0BACD,iOAAC;gBAAM,OAAO;oBAAE,UAAU;gBAAG;;oBAAG;oBAAkB,cAAc;oBAAI;;;;;;;;;;;;;AAGvE;KAzBgB"}},
    {"offset": {"line": 2131, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/presentation.ts"],"sourcesContent":["import type { ButtonBindings } from \"@/lib/buttonBindings\";\n\nexport type ProjectAsset = {\n\tid: string;\n\tkind: \"pdf\" | \"video\" | \"image\";\n\tfileName: string;\n\tstoredFileName: string;\n};\n\nexport type AssetRef =\n\t| {\n\t\t\tkind: \"pdf\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tpage: number;\n\t\t\tthumbnailDataUrl?: string;\n\t  }\n\t| {\n\t\t\tkind: \"video\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tthumbnailDataUrl?: string;\n\t  }\n\t| {\n\t\t\tkind: \"image\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tthumbnailDataUrl?: string;\n\t  };\n\nexport type SlideNodeData = {\n\tlabel: string;\n\tasset?: AssetRef;\n\tbindings?: ButtonBindings;\n};\n\nexport type SerializedFlow = {\n\tversion: 1;\n\tassets?: ProjectAsset[];\n\tviewport?: { x: number; y: number; zoom: number };\n\tprojectBindings?: ButtonBindings;\n\tnodes: Array<{\n\t\tid: string;\n\t\ttype?: string;\n\t\tposition: { x: number; y: number };\n\t\tdata: SlideNodeData;\n\t}>;\n\tedges: Array<{\n\t\tid: string;\n\t\tsource: string;\n\t\ttarget: string;\n\t\tlabel?: string;\n\t}>;\n};\n\nconst STORAGE_KEY = \"wiisugeee.editor.flow.v1\";\nconst LAST_SAVED_HASH_KEY = \"wiisugeee.editor.lastSavedHash.v1\";\n\nexport function serializeFlow(flow: SerializedFlow): string {\n\treturn JSON.stringify(flow, null, 2);\n}\n\nexport function tryParseFlowJson(text: string): SerializedFlow | null {\n\ttry {\n\t\tconst parsed = JSON.parse(text) as unknown;\n\t\tif (!parsed || typeof parsed !== \"object\") return null;\n\t\tconst maybe = parsed as Partial<SerializedFlow>;\n\t\tif (maybe.version !== 1) return null;\n\t\tif (!Array.isArray(maybe.nodes) || !Array.isArray(maybe.edges)) return null;\n\t\treturn maybe as SerializedFlow;\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function saveToLocalStorage(flow: SerializedFlow): void {\n\ttry {\n\t\tlocalStorage.setItem(STORAGE_KEY, serializeFlow(flow));\n\t} catch {}\n}\n\nexport function loadFromLocalStorage(): SerializedFlow | null {\n\ttry {\n\t\tconst text = localStorage.getItem(STORAGE_KEY);\n\t\tif (!text) return null;\n\t\treturn tryParseFlowJson(text);\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function getLastSavedHash(): string | null {\n\ttry {\n\t\treturn localStorage.getItem(LAST_SAVED_HASH_KEY);\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function setLastSavedHash(hash: string): void {\n\ttry {\n\t\tlocalStorage.setItem(LAST_SAVED_HASH_KEY, hash);\n\t} catch {}\n}\n\nexport function clearEditorStorage(): void {\n\ttry {\n\t\tlocalStorage.removeItem(STORAGE_KEY);\n\t\tlocalStorage.removeItem(LAST_SAVED_HASH_KEY);\n\t} catch {}\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAuDA,MAAM,cAAc;AACpB,MAAM,sBAAsB;AAErB,SAAS,cAAc,IAAoB;IACjD,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AACnC;AAEO,SAAS,iBAAiB,IAAY;IAC5C,IAAI;QACH,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU,OAAO;QAClD,MAAM,QAAQ;QACd,IAAI,MAAM,OAAO,KAAK,GAAG,OAAO;QAChC,IAAI,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,GAAG,OAAO;QACvE,OAAO;IACR,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS,mBAAmB,IAAoB;IACtD,IAAI;QACH,aAAa,OAAO,CAAC,aAAa,cAAc;IACjD,EAAE,OAAM,CAAC;AACV;AAEO,SAAS;IACf,IAAI;QACH,MAAM,OAAO,aAAa,OAAO,CAAC;QAClC,IAAI,CAAC,MAAM,OAAO;QAClB,OAAO,iBAAiB;IACzB,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS;IACf,IAAI;QACH,OAAO,aAAa,OAAO,CAAC;IAC7B,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS,iBAAiB,IAAY;IAC5C,IAAI;QACH,aAAa,OAAO,CAAC,qBAAqB;IAC3C,EAAE,OAAM,CAAC;AACV;AAEO,SAAS;IACf,IAAI;QACH,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IACzB,EAAE,OAAM,CAAC;AACV"}},
    {"offset": {"line": 2203, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/projectBindingsStorage.ts"],"sourcesContent":["import type { ButtonBindings } from \"@/lib/buttonBindings\";\r\n\r\nfunction key(projectId: string) {\r\n    return `wiiSugeee:projectBindings:${projectId}`;\r\n}\r\n\r\nexport function loadProjectBindings(projectId: string): ButtonBindings | undefined {\r\n    try {\r\n        const raw = localStorage.getItem(key(projectId));\r\n        if (!raw) return undefined;\r\n        return JSON.parse(raw) as ButtonBindings;\r\n    } catch {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nexport function saveProjectBindings(projectId: string, bindings: ButtonBindings) {\r\n    try {\r\n        localStorage.setItem(key(projectId), JSON.stringify(bindings));\r\n    } catch {}\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA,SAAS,IAAI,SAAiB;IAC1B,OAAO,CAAC,0BAA0B,EAAE,WAAW;AACnD;AAEO,SAAS,oBAAoB,SAAiB;IACjD,IAAI;QACA,MAAM,MAAM,aAAa,OAAO,CAAC,IAAI;QACrC,IAAI,CAAC,KAAK,OAAO;QACjB,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,OAAO;IACX;AACJ;AAEO,SAAS,oBAAoB,SAAiB,EAAE,QAAwB;IAC3E,IAAI;QACA,aAAa,OAAO,CAAC,IAAI,YAAY,KAAK,SAAS,CAAC;IACxD,EAAE,OAAM,CAAC;AACb"}},
    {"offset": {"line": 2233, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/currentProjectStore.ts"],"sourcesContent":["import type { SerializedFlow } from \"@/lib/presentation\";\r\nimport type { ButtonBindings, SoundSettings } from \"@/lib/buttonBindings\";\r\nimport { DEFAULT_SOUND_SETTINGS } from \"@/lib/buttonBindings\";\r\nimport { loadProjectBindings, saveProjectBindings } from \"@/lib/projectBindingsStorage\";\r\n\r\ntype Listener = () => void;\r\n\r\nlet currentFlow: SerializedFlow | null = null;\r\nlet currentProjectId = \"default\";\r\nconst listeners = new Set<Listener>();\r\n\r\nexport function setCurrentProjectId(projectId: string) {\r\n\tcurrentProjectId = projectId || \"default\";\r\n\tfor (const l of listeners) l();\r\n}\r\n\r\nexport function getCurrentProjectId() {\r\n\treturn currentProjectId;\r\n}\r\n\r\nexport function getCurrentFlow(): SerializedFlow | null {\r\n\treturn currentFlow;\r\n}\r\n\r\nexport function setCurrentFlow(flow: SerializedFlow | null) {\r\n\tif (flow) {\r\n\t\tconst stored = typeof window !== \"undefined\" ? loadProjectBindings(currentProjectId) : undefined;\r\n\t\tcurrentFlow = stored ? { ...flow, projectBindings: stored } : flow;\r\n\t} else {\r\n\t\tcurrentFlow = null;\r\n\t}\r\n\tfor (const l of listeners) l();\r\n}\r\n\r\nexport function subscribeCurrentFlow(listener: Listener) {\r\n\tlisteners.add(listener);\r\n\treturn () => listeners.delete(listener);\r\n}\r\n\r\nexport function getProjectBindings(): ButtonBindings | undefined {\r\n\tif (currentFlow?.projectBindings) {\r\n\t\treturn currentFlow.projectBindings;\r\n\t}\r\n\tif (typeof window === \"undefined\") return undefined;\r\n\treturn loadProjectBindings(currentProjectId);\r\n}\r\n\r\nexport function setProjectBindings(bindings: ButtonBindings) {\r\n\tif (currentFlow) {\r\n\t\tcurrentFlow = { ...currentFlow, projectBindings: bindings };\r\n\t}\r\n\r\n\tif (typeof window !== \"undefined\") {\r\n\t\tsaveProjectBindings(currentProjectId, bindings);\r\n\t}\r\n\r\n\tfor (const l of listeners) l();\r\n}\r\n\r\nconst SOUND_SETTINGS_KEY_PREFIX = \"wiiSugeee_soundSettings_\";\r\n\r\nexport function getSoundSettings(): SoundSettings {\r\n\tif (typeof window === \"undefined\") {\r\n\t\treturn { ...DEFAULT_SOUND_SETTINGS };\r\n\t}\r\n\r\n\tconst key = SOUND_SETTINGS_KEY_PREFIX + currentProjectId;\r\n\tconst stored = localStorage.getItem(key);\r\n\r\n\tif (!stored) {\r\n\t\treturn { ...DEFAULT_SOUND_SETTINGS };\r\n\t}\r\n\r\n\ttry {\r\n\t\treturn JSON.parse(stored) as SoundSettings;\r\n\t} catch {\r\n\t\treturn { ...DEFAULT_SOUND_SETTINGS };\r\n\t}\r\n}\r\n\r\nexport function setSoundSettings(settings: SoundSettings) {\r\n\tif (typeof window === \"undefined\") return;\r\n\r\n\tconst key = SOUND_SETTINGS_KEY_PREFIX + currentProjectId;\r\n\tlocalStorage.setItem(key, JSON.stringify(settings));\r\n\r\n\tfor (const l of listeners) l();\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAEA;AACA;;;AAIA,IAAI,cAAqC;AACzC,IAAI,mBAAmB;AACvB,MAAM,YAAY,IAAI;AAEf,SAAS,oBAAoB,SAAiB;IACpD,mBAAmB,aAAa;IAChC,KAAK,MAAM,KAAK,UAAW;AAC5B;AAEO,SAAS;IACf,OAAO;AACR;AAEO,SAAS;IACf,OAAO;AACR;AAEO,SAAS,eAAe,IAA2B;IACzD,IAAI,MAAM;QACT,MAAM,SAAS,uCAAgC,IAAA,kMAAmB,EAAC,oBAAoB;QACvF,cAAc,SAAS;YAAE,GAAG,IAAI;YAAE,iBAAiB;QAAO,IAAI;IAC/D,OAAO;QACN,cAAc;IACf;IACA,KAAK,MAAM,KAAK,UAAW;AAC5B;AAEO,SAAS,qBAAqB,QAAkB;IACtD,UAAU,GAAG,CAAC;IACd,OAAO,IAAM,UAAU,MAAM,CAAC;AAC/B;AAEO,SAAS;IACf,IAAI,aAAa,iBAAiB;QACjC,OAAO,YAAY,eAAe;IACnC;IACA;;IACA,OAAO,IAAA,kMAAmB,EAAC;AAC5B;AAEO,SAAS,mBAAmB,QAAwB;IAC1D,IAAI,aAAa;QAChB,cAAc;YAAE,GAAG,WAAW;YAAE,iBAAiB;QAAS;IAC3D;IAEA,wCAAmC;QAClC,IAAA,kMAAmB,EAAC,kBAAkB;IACvC;IAEA,KAAK,MAAM,KAAK,UAAW;AAC5B;AAEA,MAAM,4BAA4B;AAE3B,SAAS;IACf;;IAIA,MAAM,MAAM,4BAA4B;IACxC,MAAM,SAAS,aAAa,OAAO,CAAC;IAEpC,IAAI,CAAC,QAAQ;QACZ,OAAO;YAAE,GAAG,6LAAsB;QAAC;IACpC;IAEA,IAAI;QACH,OAAO,KAAK,KAAK,CAAC;IACnB,EAAE,OAAM;QACP,OAAO;YAAE,GAAG,6LAAsB;QAAC;IACpC;AACD;AAEO,SAAS,iBAAiB,QAAuB;IACvD;;IAEA,MAAM,MAAM,4BAA4B;IACxC,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;IAEzC,KAAK,MAAM,KAAK,UAAW;AAC5B"}},
    {"offset": {"line": 2339, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/PresenterView.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { getAssetBlob } from \"@/lib/idbAssets\";\nimport { useWiiController } from \"@/hooks/useWiiController\";\nimport { usePresentation } from \"@/hooks/usePresentation\";\nimport { useDrawing } from \"@/hooks/useDrawing\";\nimport { useAudio } from \"@/hooks/useAudio\";\nimport { useBindings } from \"@/hooks/useBindings\";\nimport { ReactionOverlay } from \"@/components/presenter/ReactionOverlay\";\nimport { WiiDebugPanel } from \"@/components/presenter/WiiDebugPanel\";\nimport { WiiDisconnectPopup } from \"@/components/presenter/WiiDisconnectPopup\";\nimport { WiiReconnectPopup } from \"@/components/presenter/WiiReconnectPopup\";\nimport { SlideDisplay } from \"@/components/presenter/SlideDisplay\";\nimport { DrawingCanvas } from \"@/components/presenter/DrawingCanvas\";\nimport { IrPointerOverlay } from \"@/components/presenter/IrPointerOverlay\";\nimport { EraserCursor } from \"@/components/presenter/EraserCursor\";\nimport { BindingAction, SerializedFlow } from \"@/types\";\nimport { loadFromLocalStorage } from \"@/lib/presentation\";\nimport { getProjectBindings } from \"@/lib/currentProjectStore\";\nimport { mergeBindings } from \"@/lib/buttonBindings\";\n\n\nexport function PresenterView() {\n    const router = useRouter();\n    const searchParams = useSearchParams();\n    const containerRef = useRef<HTMLDivElement | null>(null);\n    const isMouseDrawingRef = useRef(false);\n    const [isPainting, setIsPainting] = useState(false);\n    const wasWiiADownRef = useRef(false);\n    const lastEraserToggleTimeRef = useRef<number>(0);\n    const lastIrSensToggleTimeRef = useRef<number>(0);\n\n    const { wiiState, pressed, wiiConnected, wiiDisconnectedAt, irCursorEnabled, setIrCursorEnabled, playWiiSound } = useWiiController();\n\n    const soundboardRef = useRef<{ q?: HTMLAudioElement; w?: HTMLAudioElement; e?: HTMLAudioElement }>({});\n    const audioUnlockedRef = useRef(false);\n    const pendingSoundRef = useRef<\"q\" | \"w\" | \"e\" | null>(null);\n\n    const tryUnlockAudio = useCallback(async () => {\n        if (audioUnlockedRef.current) return;\n\n        const { q, w, e } = soundboardRef.current;\n        const audios = [q, w, e].filter(Boolean) as HTMLAudioElement[];\n        if (audios.length === 0) return;\n\n        try {\n            const a = audios[0];\n            const prevMuted = a.muted;\n            const prevVolume = a.volume;\n            a.muted = true;\n            a.volume = 0;\n            await a.play();\n            a.pause();\n            a.currentTime = 0;\n            a.muted = prevMuted;\n            a.volume = prevVolume;\n            audioUnlockedRef.current = true;\n            console.log(\"[Audio] Successfully unlocked audio context\");\n\n            const pending = pendingSoundRef.current;\n            pendingSoundRef.current = null;\n            if (pending) {\n                const next = soundboardRef.current[pending];\n                if (next) {\n                    next.currentTime = 0;\n                    void next.play().catch((err) => {\n                        console.warn(\"sound play failed\", pending, err);\n                    });\n                }\n            }\n        } catch (err) {\n            console.warn(\"audio unlock failed\", err);\n        }\n    }, []);\n\n    // PCÂÅ¥„ÅßÈü≥Â£∞„ÇíÂÜçÁîüÔºàHTMLAudioÔºâ\n    const playSoundOnPC = useCallback(async (key: \"q\" | \"w\" | \"e\") => {\n        const a = soundboardRef.current[key];\n        if (!a) {\n            console.warn(`[Audio] No audio element for key: ${key}`);\n            return;\n        }\n\n        // „Ç™„Éº„Éá„Ç£„Ç™„Åå„Ç¢„É≥„É≠„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÄÅ„Ç¢„É≥„É≠„ÉÉ„ÇØ„ÇíË©¶Ë°å\n        if (!audioUnlockedRef.current) {\n            console.log(`[Audio] Attempting to unlock audio context for ${key}`);\n            pendingSoundRef.current = key;\n            await tryUnlockAudio();\n            // „Ç¢„É≥„É≠„ÉÉ„ÇØ„Å´Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Éö„É≥„Éá„Ç£„É≥„Ç∞„Å´‰øùÂ≠òÊ∏à„Åø\n            if (!audioUnlockedRef.current) {\n                console.warn(\"[Audio] Audio context not unlocked yet, sound will play after user interaction\");\n                return;\n            }\n        }\n\n        console.log(`[Audio] Playing sound on PC: ${key}`);\n        a.currentTime = 0;\n        void a.play().catch((err) => {\n            console.warn(`[Audio] Sound play failed for ${key}:`, err);\n            pendingSoundRef.current = key;\n        });\n    }, [tryUnlockAudio]);\n\n    // Wii„É™„É¢„Ç≥„É≥ÂÅ¥„ÅßÈü≥Â£∞„ÇíÂÜçÁîü\n    const playSoundOnWii = useCallback(\n        (key: \"q\" | \"w\" | \"e\") => {\n            if (key === \"q\") playWiiSound(\"shot\");\n            else if (key === \"e\") playWiiSound(\"oh\");\n            else playWiiSound(\"uxo\");\n        },\n        [playWiiSound],\n    );\n\n    // Ê±éÁî®„ÅÆÈü≥Â£∞ÂÜçÁîüÈñ¢Êï∞ÔºàoutputDevice„ÅßÂá∫ÂäõÂÖà„ÇíÊåáÂÆöÔºâ\n    const playSound = useCallback(\n        (key: \"q\" | \"w\" | \"e\", outputDevice: \"pc\" | \"wii\" = \"pc\") => {\n            if (outputDevice === \"wii\") {\n                playSoundOnWii(key);\n            } else {\n                playSoundOnPC(key);\n            }\n        },\n        [playSoundOnPC, playSoundOnWii],\n    );\n\n    const returnTo = useMemo(() => {\n        return searchParams.get(\"from\") === \"editor\" ? \"/editor\" : \"/\";\n    }, [searchParams]);\n\n    const returnLabel = useMemo(() => {\n        return returnTo === \"/editor\" ? \"„Ç®„Éá„Ç£„Çø„Å´Êàª„Çã\" : \"„Éõ„Éº„É†„Å´Êàª„Çã\";\n    }, [returnTo]);\n\n    const goBack = useCallback(() => {\n        router.push(returnTo);\n    }, [router, returnTo]);\n    const [flow, setFlow] = useState<SerializedFlow | null>(null);\n    const [error, setError] = useState<string | null>(null);\n    const [currentNodeId, setCurrentNodeId] = useState<string | null>(null);\n    const [startedWithWii, setStartedWithWii] = useState(false);\n    const [playingSince, setPlayingSince] = useState<number>(0);\n    const [showDebugPanel, setShowDebugPanel] = useState(true);\n    const [showIrDebug, setShowIrDebug] = useState(true); // IR„Çª„É≥„Çµ„Éº„Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫\n\n    const pdfDocCacheRef = useRef<Map<string, Promise<any>>>(new Map());\n\n    // ‚òÖ‰øÆÊ≠£: Â∏∏„Å´playingÁä∂ÊÖã„Å®„Åó„Å¶Êâ±„ÅÜÔºàflow/currentNodeId„Åå„ÅÇ„Çå„Å∞ÂÜçÁîü‰∏≠Ôºâ\n    const isPlaying = flow != null && currentNodeId != null;\n\n    // PCÂÅ¥Èü≥Â£∞„ÅÆÂàùÊúüÂåñ\n    useEffect(() => {\n        const q = new Audio(\"https://www.myinstants.com/media/sounds/nice-shot-wii-sports_DJJ0VOz.mp3\");\n        const w = new Audio(\"https://www.myinstants.com/media/sounds/crowdaw.mp3\");\n        const e = new Audio(\"https://www.myinstants.com/media/sounds/crowdoh.mp3\");\n        q.preload = \"auto\";\n        w.preload = \"auto\";\n        e.preload = \"auto\";\n        soundboardRef.current = { q, w, e };\n        console.log(\"[Audio] Audio elements initialized\");\n\n        // „É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥ÊôÇ„Å´„Ç™„Éº„Éá„Ç£„Ç™„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Çí„Ç¢„É≥„É≠„ÉÉ„ÇØ\n        const unlockOnInteraction = () => {\n            if (audioUnlockedRef.current) return;\n            console.log(\"[Audio] User interaction detected, unlocking audio\");\n            void tryUnlockAudio();\n        };\n\n        // „ÇØ„É™„ÉÉ„ÇØ„ÇÑ„Çø„ÉÉ„ÉÅ„Åß„Ç¢„É≥„É≠„ÉÉ„ÇØ„ÇíË©¶Ë°å\n        window.addEventListener(\"click\", unlockOnInteraction);\n        window.addEventListener(\"touchstart\", unlockOnInteraction);\n        window.addEventListener(\"keydown\", unlockOnInteraction);\n\n        return () => {\n            window.removeEventListener(\"click\", unlockOnInteraction);\n            window.removeEventListener(\"touchstart\", unlockOnInteraction);\n            window.removeEventListener(\"keydown\", unlockOnInteraction);\n            for (const a of [q, w, e]) {\n                try {\n                    a.pause();\n                } catch {\n                    // ignore\n                }\n            }\n            soundboardRef.current = {};\n        };\n    }, [tryUnlockAudio]);\n\n    // „Çπ„Éö„Éº„Çπ„Ç≠„Éº„Åß„Éá„Éê„ÉÉ„Ç∞„Éë„Éç„É´„Å®IR„Çª„É≥„Çµ„Éº„Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫„ÇíÂàá„ÇäÊõø„Åà\n    useEffect(() => {\n        const handleKeyDown = (e: KeyboardEvent) => {\n            if (e.code === \"Space\" && e.target === document.body) {\n                e.preventDefault();\n                setShowDebugPanel(prev => !prev);\n                setShowIrDebug(prev => !prev);\n            }\n        };\n\n        window.addEventListener(\"keydown\", handleKeyDown);\n        return () => window.removeEventListener(\"keydown\", handleKeyDown);\n    }, []);\n\n    const getOrLoadPdfDocument = useCallback(async (assetId: string) => {\n        const cached = pdfDocCacheRef.current.get(assetId);\n        if (cached) return await cached;\n\n        const promise = (async () => {\n            const blob = await getAssetBlob(assetId);\n            if (!blob) throw new Error(\"PDF„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\n            const arrayBuffer = await blob.arrayBuffer();\n            const pdfjs = await import(\"pdfjs-dist/legacy/build/pdf.mjs\");\n            pdfjs.GlobalWorkerOptions.workerSrc = new URL(\n                \"pdfjs-dist/legacy/build/pdf.worker.min.mjs\",\n                import.meta.url,\n            ).toString();\n            return await pdfjs.getDocument({ data: arrayBuffer }).promise;\n        })();\n\n        pdfDocCacheRef.current.set(assetId, promise);\n        try {\n            return await promise;\n        } catch (e) {\n            pdfDocCacheRef.current.delete(assetId);\n            throw e;\n        }\n    }, []);\n\n    // „ÅäÁµµÊèè„ÅçÁî®„ÅÆÂ∫ßÊ®ô„É™„Çπ„Éà\n    const [drawingPoints, setDrawingPoints] = useState<Array<{ x: number; y: number; mode?: \"draw\" | \"erase\" } | null>>([]);\n\n    // Ê∂à„Åó„Ç¥„É†„É¢„Éº„ÉâÔºà„Éà„Ç∞„É´ÂºèÔºâ- X„Ç≠„Éº„Å®Wii„Éú„Çø„É≥„ÅßÂÖ±ÈÄö\n    const [eraserMode, setEraserMode] = useState(false);\n    const [eraserButtonName, setEraserButtonName] = useState<string | null>(null);\n\n    // „Ç´„Éº„ÇΩ„É´‰ΩçÁΩÆÔºàÊ∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´Ë°®Á§∫Áî®Ôºâ\n    const [cursorPos, setCursorPos] = useState<{ x: number; y: number } | null>(null);\n\n    // ÈÄ£Á∂öÈÅ∑Áßª„ÇíÈò≤„Åê„Åü„ÇÅ„ÅÆ„ÇØ„Éº„É´„Çø„Ç§„É†ÁÆ°ÁêÜ\n    const lastNavTime = useRef<number>(0);\n\n    // ÁèæÂú®„ÅÆ„Éé„Éº„Éâ„Éá„Éº„Çø\n    const currentNode = useMemo(() =>\n        flow?.nodes.find((n) => n.id === currentNodeId),\n        [flow, currentNodeId]);\n\n    // ‚òÖ‰øÆÊ≠£: ÂàùÂõû„Éû„Ç¶„É≥„ÉàÊôÇ„Å´Ëá™ÂãïÁöÑ„Å´„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥„ÇíÈñãÂßã\n    useEffect(() => {\n        const loaded = loadFromLocalStorage();\n        if (!loaded || loaded.nodes.length === 0) {\n            setError(\"„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇEditor„Åß‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\");\n            setFlow(null);\n            setCurrentNodeId(null);\n            return;\n        }\n\n        // „Éê„Ç§„É≥„ÉâË®≠ÂÆö„ÇíË™≠„ÅøËæº„Åø\n        const storedBindings = getProjectBindings();\n        const flowWithBindings = storedBindings ?\n            { ...loaded, projectBindings: storedBindings } : loaded;\n\n        console.log(\"PresenterView: Auto-starting presentation with bindings\", { storedBindings, flowWithBindings });\n\n        setError(null);\n        setFlow(flowWithBindings);\n\n        // Start„Éé„Éº„Éâ„Åã„ÇâÈñãÂßã\n        const startNode = loaded.nodes.find((n) => n.data.label === \"Start\") || loaded.nodes[0];\n        setCurrentNodeId(startNode.id);\n\n        // WiiÊé•Á∂öÁä∂ÊÖã„ÇíË®òÈå≤\n        setStartedWithWii(!!wiiConnected);\n        setPlayingSince(Date.now());\n    }, []); // ‚òÖÁ©∫„ÅÆ‰æùÂ≠òÈÖçÂàó„ÅßÂàùÂõû„ÅÆ„ÅøÂÆüË°å\n\n    // ‚òÖ‰øÆÊ≠£: wiiConnected„ÅåÂ§âÂåñ„Åó„Åü„ÇâË®òÈå≤„ÇíÊõ¥Êñ∞\n    useEffect(() => {\n        if (wiiConnected) setStartedWithWii(true);\n    }, [wiiConnected]);\n\n    const outgoingEdges = useMemo(() => {\n        if (!flow || !currentNodeId) return [];\n        return flow.edges.filter((e) => e.source === currentNodeId);\n    }, [flow, currentNodeId]);\n\n    const branchOptions = useMemo(() => {\n        // 1-9 „ÅÆÊï∞Â≠ó„ÅßÈÅ∏„Åπ„ÇãÂàÜÂ≤ê\n        const options: Array<{ key: string; target: string }> = [];\n        const used = new Set<string>();\n\n        for (const edge of outgoingEdges) {\n            const label = (edge.label ?? \"\").trim();\n            const m = label.match(/^([1-9])(?:\\b|\\s|:|-)/);\n            if (m) {\n                const k = m[1];\n                if (!used.has(k)) {\n                    options.push({ key: k, target: edge.target });\n                    used.add(k);\n                }\n            }\n        }\n\n        // „É©„Éô„É´„Å´Áï™Âè∑„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅÈÖçÂàóÈ†Ü„Åß 1..n „ÇíÂâ≤„ÇäÂΩì„Å¶\n        for (const edge of outgoingEdges) {\n            if (options.length >= 9) break;\n            const nextKey = String(options.length + 1);\n            if (used.has(nextKey)) continue;\n            options.push({ key: nextKey, target: edge.target });\n            used.add(nextKey);\n        }\n\n        return options;\n    }, [outgoingEdges]);\n\n    const hasMultipleBranches = outgoingEdges.length >= 2;\n\n    // „Éé„Éº„ÉâÁßªÂãïÂá¶ÁêÜ\n    const navigateTo = useCallback((nodeId: string) => {\n        // „ÇØ„Éº„É´„Çø„Ç§„É†„ÉÅ„Çß„ÉÉ„ÇØ (500ms‰ª•ÂÜÖ„ÅÆÈÄ£Á∂öÈÅ∑Áßª„ÅØÁÑ°Ë¶ñ)\n        const now = Date.now();\n        if (now - lastNavTime.current < 500) return;\n        lastNavTime.current = now;\n\n        setCurrentNodeId(nodeId);\n        setDrawingPoints([]); // „Çπ„É©„Ç§„Éâ„ÅåÂ§â„Çè„Å£„Åü„ÇâÁ∑ö„ÇíÊ∂à„Åô\n    }, []);\n\n    // Ê¨°„Å∏Ôºà„É≠„Ç∏„ÉÉ„ÇØÊîπËâØÁâàÔºâ\n    const nextSlide = useCallback(() => {\n        if (!flow || !currentNodeId) return;\n        // ÂàÜÂ≤ê„ÅåË§áÊï∞„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÄÅÊï∞Â≠óÈÅ∏Êäû„ÇíÂÑ™ÂÖà„Åô„Çã\n        const edges = flow.edges.filter((e) => e.source === currentNodeId);\n        if (edges.length >= 2) return;\n\n        // ÁèæÂú®„ÅÆ„Éé„Éº„Éâ„Åã„ÇâÂá∫„Å¶„ÅÑ„Çã„Ç®„ÉÉ„Ç∏„Çí„Åô„Åπ„Å¶ÂèñÂæó\n        // (‰∏ä„ÅßÂèñÂæóÊ∏à„Åø)\n\n        if (edges.length === 0) return;\n\n        // ÂÑ™ÂÖàÈ†Ü‰Ωç‰ªò„Åë\n        // 1. „É©„Éô„É´„Åå„Å™„ÅÑ„Ç®„ÉÉ„Ç∏ („Éá„Éï„Ç©„É´„Éà„É´„Éº„Éà)\n        // 2. „É©„Éô„É´„Åå \"next\" „ÅÆ„Ç®„ÉÉ„Ç∏\n        // 3. „Åù„Çå‰ª•Â§ñ (ÊúÄÂàù„Å´Ë¶ã„Å§„Åã„Å£„Åü„ÇÇ„ÅÆ)\n        const targetEdge =\n            edges.find(e => !e.label || e.label.trim() === \"\") ||\n            edges.find(e => e.label === \"next\") ||\n            edges[0];\n\n        if (targetEdge) navigateTo(targetEdge.target);\n    }, [flow, currentNodeId, navigateTo]);\n\n    const branchByNumberKey = useCallback(\n        (key: string) => {\n            if (!hasMultipleBranches) return;\n            const opt = branchOptions.find((o) => o.key === key);\n            if (opt) navigateTo(opt.target);\n        },\n        [branchOptions, hasMultipleBranches, navigateTo],\n    );\n\n    // Ââç„Å∏ÔºàÈÄÜÈ†ÜÊ§úÁ¥¢Ôºâ\n    const prevSlide = useCallback(() => {\n        if (!flow || !currentNodeId) return;\n        // Ëá™ÂàÜ„Å´Âêë„Åã„Å£„Å¶„ÅÑ„Çã„Ç®„ÉÉ„Ç∏„ÇíÊé¢„Åó„Å¶Êàª„ÇãÔºàÁ∞°ÊòìÂÆüË£ÖÔºâ\n        const edge = flow.edges.find(e => e.target === currentNodeId);\n        if (edge) navigateTo(edge.source);\n    }, [flow, currentNodeId, navigateTo]);\n\n    // ÂàÜÂ≤êÂá¶ÁêÜÔºà„Ç®„ÉÉ„Ç∏„ÅÆ„É©„Éô„É´„ÅßÊ§úÁ¥¢Ôºâ\n    const branchTo = useCallback((keywords: string[]) => {\n        if (!flow || !currentNodeId) return;\n        const edges = flow.edges.filter(e => e.source === currentNodeId);\n        const target = edges.find(e => keywords.some(k => e.label?.includes(k)));\n        if (target) {\n            console.log(\"ÂàÜÂ≤ê„Åó„Åæ„Åó„Åü:\", target.label);\n            navigateTo(target.target);\n        }\n    }, [flow, currentNodeId, navigateTo]);\n\n    // ‚òÖËøΩÂä†: „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Çí„Éá„Éê„ÉÉ„Ç∞„Åô„ÇãÔºàN=One, M=TwoÔºâ\n    const [debugEmitClap, setDebugEmitClap] = useState(false);\n    const [debugEmitLaugh, setDebugEmitLaugh] = useState(false);\n\n    // „Ç≠„Éº„Éú„Éº„ÉâÊìç‰Ωú (Áü¢Âç∞„Ç≠„ÉºÂØæÂøú + ESC„ÅßÊàª„Çã)\n    useEffect(() => {\n        if (!isPlaying) return;\n\n        const handleKeyDown = (e: KeyboardEvent) => {\n            // ËøΩÂä†: Á∑ö„Çí„ÇØ„É™„Ç¢ (R)\n            if (e.key === \"r\" || e.key === \"R\") {\n                setDrawingPoints([]);\n                isMouseDrawingRef.current = false;\n                wasWiiADownRef.current = false;\n                return;\n            }\n\n            // „Éö„Ç§„É≥„Éà„Å®Ê∂à„Åó„Ç¥„É†„ÇíÂàá„ÇäÊõø„Åà (X) - Wii„Éú„Çø„É≥„Å®Âêå„ÅòÊåôÂãï\n            if (e.key === \"x\" || e.key === \"X\") {\n                // Êäº„Åó„Å£„Å±„Å™„Åó„ÅßON/OFF„ÅåÊö¥„Çå„Å™„ÅÑ„Çà„ÅÜ„Å´„ÄÅ„É™„Éî„Éº„Éà„ÅØÁÑ°Ë¶ñ\n                if (e.repeat) return;\n                setEraserMode((prev) => {\n                    const next = !prev;\n                    if (next) {\n                        setEraserButtonName(\"X\");\n                        setCursorPos({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                    } else {\n                        setEraserButtonName(null);\n                        setCursorPos(null);\n                    }\n                    return next;\n                });\n                return;\n            }\n\n            if (!e.repeat) {\n                if (e.key === \"q\" || e.key === \"Q\") {\n                    playSound(\"q\");\n                    return;\n                }\n                if (e.key === \"w\" || e.key === \"W\") {\n                    playSound(\"w\");\n                    return;\n                }\n                if (e.key === \"e\" || e.key === \"E\") {\n                    playSound(\"e\");\n                    return;\n                }\n            }\n\n            // ‚òÖËøΩÂä†: „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ÔºàN / MÔºâ\n            // Êäº„Åó„Å£„Å±„Å™„Åó„ÅßÂ¢óÊÆñ„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´ repeat „ÇíÁÑ°Ë¶ñ\n            if (!e.repeat) {\n                if (e.key === \"n\" || e.key === \"N\") {\n                    setDebugEmitClap(true);\n                    queueMicrotask(() => setDebugEmitClap(false)); // 1Âõû„Å†„ÅëÁô∫ÁÅ´\n                    return;\n                }\n                if (e.key === \"m\" || e.key === \"M\") {\n                    setDebugEmitLaugh(true);\n                    queueMicrotask(() => setDebugEmitLaugh(false)); // 1Âõû„Å†„ÅëÁô∫ÁÅ´\n                    return;\n                }\n            }\n\n            // Êó¢Â≠ò: ÂàÜÂ≤ê 1..9\n            if (e.key >= \"1\" && e.key <= \"9\") {\n                branchByNumberKey(e.key);\n                return;\n            }\n            if (e.key === \"ArrowRight\") {\n                if (!hasMultipleBranches) nextSlide();\n            }\n            if (e.key === \"ArrowLeft\") prevSlide();\n            if (e.key === \"Escape\") goBack();\n            if ((e.key === \"c\" || e.key === \"C\") && !e.repeat) {\n                setIrCursorEnabled(!irCursorEnabled);\n                return;\n            }\n        };\n\n        window.addEventListener(\"keydown\", handleKeyDown);\n        return () => window.removeEventListener(\"keydown\", handleKeyDown);\n    }, [isPlaying, nextSlide, prevSlide, goBack, branchByNumberKey, hasMultipleBranches, playSound, irCursorEnabled, setIrCursorEnabled]);\n\n    const effectiveProjectBindings = useMemo(() => {\n        const combined = {\n            ...(flow?.projectBindings ?? {}),\n            ...(currentNode?.data.bindings ?? {}),\n        };\n        return mergeBindings(combined);\n    }, [flow, currentNode]);\n\n    const runAction = useCallback(\n        (act: BindingAction, btnName?: string) => {\n            if (eraserMode && act.type !== \"eraser\") {\n                return;\n            }\n\n            switch (act.type) {\n                case \"next\":\n                    nextSlide();\n                    return;\n                case \"prev\":\n                    prevSlide();\n                    return;\n                case \"branchIndex\":\n                    branchByNumberKey(String(act.index));\n                    return;\n                case \"branch\": {\n                    if (!hasMultipleBranches) return;\n                    const map: Record<string, string> = { A: \"1\", B: \"2\", HOME: \"3\" };\n                    const k = map[act.kind];\n                    if (k) branchByNumberKey(k);\n                    return;\n                }\n                case \"reaction\":\n                    return;\n                case \"paint\":\n                    break;\n                case \"eraser\":\n                    const nowEraser = Date.now();\n                    if (nowEraser - lastEraserToggleTimeRef.current < 500) return;\n                    lastEraserToggleTimeRef.current = nowEraser;\n\n                    if (eraserMode) {\n                        setEraserMode(false);\n                        setEraserButtonName(null);\n                        setCursorPos(null);\n                    } else {\n                        setEraserMode(true);\n                        setEraserButtonName(btnName || \"unknown\");\n                        setCursorPos({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                    }\n                    break;\n                case \"sound\":\n                    if (act.kind === \"shot\") playSound(\"q\", act.outputDevice);\n                    else if (act.kind === \"oh\") playSound(\"e\", act.outputDevice);\n                    else if (act.kind === \"uxo\") playSound(\"w\", act.outputDevice);\n                    return;\n                case \"remove\":\n                    setDrawingPoints([]);\n                    isMouseDrawingRef.current = false;\n                    wasWiiADownRef.current = false;\n                    return;\n                case \"irSens\":\n                    const nowIrSens = Date.now();\n                    if (nowIrSens - lastIrSensToggleTimeRef.current < 500) return;\n                    lastIrSensToggleTimeRef.current = nowIrSens;\n\n                    setIrCursorEnabled(!irCursorEnabled);\n                    return;\n                case \"none\":\n                default:\n                    return;\n            }\n        },\n        [nextSlide, prevSlide, branchByNumberKey, hasMultipleBranches, playSound, eraserMode, irCursorEnabled, setIrCursorEnabled],\n    );\n\n    useEffect(() => {\n        if (!isPlaying) return;\n\n        for (const btn of Object.keys(pressed)) {\n            const isDown = (pressed as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn] ?? { type: \"none\" };\n\n            if (act.type !== \"paint\" && act.type !== \"eraser\") {\n                runAction(act, btn);\n            } else if (act.type === \"eraser\") {\n                runAction(act, btn);\n            }\n        }\n    }, [pressed, isPlaying, effectiveProjectBindings, runAction]);\n\n    const shouldEmitClap = useMemo(() => {\n        if (!isPlaying) return false;\n        for (const btn of Object.keys(pressed)) {\n            const isDown = (pressed as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n            if (act?.type === \"reaction\" && act.kind === \"clap\") return true;\n        }\n        return false;\n    }, [pressed, effectiveProjectBindings, isPlaying]);\n\n    const shouldEmitLaugh = useMemo(() => {\n        if (!isPlaying) return false;\n        for (const btn of Object.keys(pressed)) {\n            const isDown = (pressed as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n            if (act?.type === \"reaction\" && act.kind === \"laugh\") return true;\n        }\n        return false;\n    }, [pressed, effectiveProjectBindings, isPlaying]);\n\n    const lastPaintInputTimeRef = useRef<number>(0);\n    const [shouldPaint, setShouldPaint] = useState(false);\n\n    useEffect(() => {\n        if (irCursorEnabled) return;\n\n        setShouldPaint(false);\n        setIsPainting(false);\n        lastPaintInputTimeRef.current = 0;\n\n        // „ÇÇ„ÅóWiiÊèèÁîª„ÅÆÁ∑ö„ÅåÁ∂ôÁ∂ö‰∏≠„Å™„ÇâÂå∫Âàá„Çã\n        wasWiiADownRef.current = false;\n        setDrawingPoints((prev) =>\n            prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev\n        );\n    }, [irCursorEnabled]);\n\n    useEffect(() => {\n        if (!isPlaying || !wiiState || eraserMode || !irCursorEnabled) {\n            if (shouldPaint) {\n                setShouldPaint(false);\n                setIsPainting(false);\n            }\n            return;\n        }\n\n        let isPaintButtonPressed = false;\n        for (const btn of Object.keys(wiiState.buttons)) {\n            const isDown = (wiiState.buttons as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n            if (act?.type === \"paint\") {\n                isPaintButtonPressed = true;\n                break;\n            }\n        }\n\n        if (isPaintButtonPressed) {\n            lastPaintInputTimeRef.current = Date.now();\n            if (!shouldPaint) setShouldPaint(true);\n            if (!isPainting) setIsPainting(true);\n        }\n    }, [wiiState, effectiveProjectBindings, isPlaying, eraserMode, irCursorEnabled, shouldPaint, isPainting]);\n\n    useEffect(() => {\n        if (!isPlaying) {\n            setShouldPaint(false);\n            return;\n        }\n\n        const interval = setInterval(() => {\n            const now = Date.now();\n            const paintElapsed = now - lastPaintInputTimeRef.current;\n\n            if (paintElapsed > 100 && shouldPaint) {\n                setShouldPaint(false);\n                setIsPainting(false);\n                // ÊèèÁîª„ÇíÁµÇ‰∫Ü\n                if (isMouseDrawingRef.current) {\n                    isMouseDrawingRef.current = false;\n                    setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n                }\n            }\n        }, 50); // 50ms„Åî„Å®„Å´„ÉÅ„Çß„ÉÉ„ÇØ\n\n        return () => clearInterval(interval);\n    }, [isPlaying, shouldPaint]);\n\n    // --- ÊèèÁîª/Ê∂à„Åó„Ç¥„É†„É≠„Ç∏„ÉÉ„ÇØ (IR„Çª„É≥„Çµ„Éº & PAINT„Éú„Çø„É≥) ---\n    useEffect(() => {\n        // IR„Ç´„Éº„ÇΩ„É´OFF„ÅÆÂ†¥Âêà„ÅØIRÊèèÁîª„ÇíÁÑ°ÂäπÂåñ\n        if (!irCursorEnabled) return;\n\n        if (!wiiState || !wiiState.cursor) return;\n\n        // ‚òÖIR„Ç´„Éº„ÇΩ„É´ONÊôÇÔºö„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Åã„ÇâÂèó‰ø°„Åó„ÅüÊ≠£Ë¶èÂåñÊ∏à„ÅøcursorÂ∫ßÊ®ô„ÅÆ„Åø„Çí‰ΩøÁî®\n        // ‚òÖÈáçË¶ÅÔºöCSS„Åßcursor: url(\"/pen.png\") 0 0„Çí‰ΩøÁî®„Åó„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅ\n        // SetCursorPos„ÅØ„Éö„É≥ÁîªÂÉè„ÅÆÂ∑¶‰∏äÔºà0,0Ôºâ„ÇíÂãï„Åã„Åô„ÄÇ\n        // „Åó„Åã„ÅóÊèèÁîª„ÅØ„Éö„É≥ÂÖà„ÅÆ‰ΩçÁΩÆÔºà‰æã: 6, 28Ôºâ„ÅßË°å„ÅÜÂøÖË¶Å„Åå„ÅÇ„Çã„Åü„ÇÅ„ÄÅ„Ç™„Éï„Çª„ÉÉ„Éà„ÇíÂä†ÁÆó„ÄÇ\n        const PEN_TIP_OFFSET_X = 0;  // pen.png„ÅÆ„Éö„É≥ÂÖàXÂ∫ßÊ®ôÔºàÂÆüÈöõ„ÅÆÁîªÂÉè„Å´Âêà„Çè„Åõ„Å¶Ë™øÊï¥Ôºâ\n        const PEN_TIP_OFFSET_Y = 0; // pen.png„ÅÆ„Éö„É≥ÂÖàYÂ∫ßÊ®ôÔºàÂÆüÈöõ„ÅÆÁîªÂÉè„Å´Âêà„Çè„Åõ„Å¶Ë™øÊï¥Ôºâ\n\n        const pos = {\n            x: wiiState.cursor.x * window.innerWidth + PEN_TIP_OFFSET_X,\n            y: wiiState.cursor.y * window.innerHeight + PEN_TIP_OFFSET_Y,\n        };\n\n        // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠: IR„Åß„Ç´„Éº„ÇΩ„É´„ÇíÁßªÂãï\n        if (eraserMode) {\n            setCursorPos(pos);\n\n            // A„Å®B„ÇíÂêåÊôÇÊäº„Åó„Åó„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ\n            const isAPressed = wiiState.buttons.A;\n            const isBPressed = wiiState.buttons.B;\n\n            if (isAPressed && isBPressed) {\n                // A+BÂêåÊôÇÊäº„Åó„ÅßÊ∂àÂéª\n                setDrawingPoints((prev) => {\n                    const next = prev.slice();\n                    if (!wasWiiADownRef.current) {\n                        if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                    }\n                    next.push({ ...pos, mode: \"erase\" });\n                    return next;\n                });\n                wasWiiADownRef.current = true;\n            } else {\n                // A+B„ÇíÈõ¢„Åó„Åü„ÇâÂå∫Âàá„Çã\n                if (wasWiiADownRef.current) {\n                    wasWiiADownRef.current = false;\n                    setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n                }\n            }\n            return;\n        }\n\n        // PAINT„Éê„Ç§„É≥„Éâ„Åï„Çå„Åü„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„ÅÑ„ÇãÈñì„ÄÅËªåË∑°„ÇíËøΩÂä†\n        if (shouldPaint) {\n            setDrawingPoints((prev) => {\n                const next = prev.slice();\n                if (!wasWiiADownRef.current) {\n                    // ÂâçÂõû„ÅÆÁ∑ö„Å®Áπã„Åå„Çâ„Å™„ÅÑ„Çà„ÅÜ„Å´Âå∫Âàá„Çä„ÇíÂÖ•„Çå„Çã\n                    if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                }\n                next.push({ ...pos, mode: \"draw\" });\n                return next;\n            });\n            wasWiiADownRef.current = true;\n        } else {\n            // Èõ¢„Åó„Åü„Çø„Ç§„Éü„É≥„Ç∞„ÅßÂå∫Âàá„Çã\n            if (wasWiiADownRef.current) {\n                wasWiiADownRef.current = false;\n                setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n            }\n        }\n    }, [wiiState, shouldPaint, irCursorEnabled]);\n\n\n    return (\n        <main\n            ref={containerRef}\n            onMouseDown={(e) => {\n                if (!isPlaying) return;\n                if (e.button !== 0) return;\n                // UI(„Éú„Çø„É≥Á≠â)Êìç‰Ωú„ÅØÈÇ™È≠î„Åó„Å™„ÅÑ\n                const el = e.target as HTMLElement | null;\n                if (el && el.closest(\"button, a, input, textarea, select\")) return;\n                e.preventDefault();\n\n                // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠„ÅØÂ∑¶„ÇØ„É™„ÉÉ„ÇØ„ÅßÊ∂àÂéªÈñãÂßã\n                if (eraserMode) {\n                    isMouseDrawingRef.current = true;\n                    setIsPainting(false); // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠„ÅØ„Éö„É≥„Ç´„Éº„ÇΩ„É´„Å´„Åó„Å™„ÅÑ\n                    setDrawingPoints((prev) => {\n                        const next = prev.slice();\n                        if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                        next.push({ x: e.clientX, y: e.clientY, mode: \"erase\" });\n                        return next;\n                    });\n                    return;\n                }\n\n                // ÈÄöÂ∏∏„É¢„Éº„ÉâÔºöÂ∑¶„ÇØ„É™„ÉÉ„ÇØ„ÅßÊèèÁîªÈñãÂßã\n                isMouseDrawingRef.current = true;\n                setIsPainting(true); // „Éö„É≥„Ç´„Éº„ÇΩ„É´„Å´Â§âÊõ¥\n                setDrawingPoints((prev) => {\n                    const next = prev.slice();\n                    if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                    next.push({ x: e.clientX, y: e.clientY, mode: \"draw\" });\n                    return next;\n                });\n            }}\n            onMouseMove={(e) => {\n                if (!isPlaying) return;\n\n                // Ê∂à„Åó„Ç¥„É†„É¢„Éº„ÉâÊôÇÔºö„Ç´„Éº„ÇΩ„É´‰ΩçÁΩÆ„ÇíÂ∏∏„Å´Êõ¥Êñ∞ÔºàËµ§„ÅÑÂÜÜ„ÇíËøΩÂæì„Åï„Åõ„ÇãÔºâ\n                if (eraserMode) {\n                    setCursorPos({ x: e.clientX, y: e.clientY });\n\n                    // „Éû„Ç¶„Çπ„Éâ„É©„ÉÉ„Ç∞‰∏≠„ÅÆ„ÅøÊ∂àÂéª„ÇíÂÆüË°å\n                    if (isMouseDrawingRef.current) {\n                        e.preventDefault();\n                        setDrawingPoints((prev) => {\n                            const last = prev[prev.length - 1];\n                            if (last && last.x && Math.abs(last.x - e.clientX) + Math.abs(last.y - e.clientY) < 2) return prev;\n                            return [...prev, { x: e.clientX, y: e.clientY, mode: \"erase\" }];\n                        });\n                    }\n                    return;\n                }\n\n                // --- ÈÄöÂ∏∏„É¢„Éº„ÉâÔºöÊèèÁîªÔºà„Éû„Ç¶„Çπ or Wii PAINTÔºâ ---\n\n                // 1) „Éû„Ç¶„Çπ„Éâ„É©„ÉÉ„Ç∞‰∏≠„ÅØÂ∏∏„Å´„Éû„Ç¶„ÇπÊèèÁîª„ÇíÂÑ™ÂÖà\n                if (isMouseDrawingRef.current) {\n                    e.preventDefault();\n                    setDrawingPoints((prev) => {\n                        const last = prev[prev.length - 1];\n                        if (last && last.x && Math.abs(last.x - e.clientX) + Math.abs(last.y - e.clientY) < 2) return prev;\n                        return [...prev, { x: e.clientX, y: e.clientY, mode: \"draw\" }];\n                    });\n                    return;\n                }\n\n                // 2) Wii„ÅÆPAINTÔºàshouldPaint=trueÔºâ„ÅÆÂ†¥Âêà\n                if (shouldPaint) {\n                    // ‚òÖÈáçË¶ÅÔºöIR Cursor ON „ÅÆ„Å®„Åç„ÅØ„ÄåIRÂÅ¥useEffect„Äç„ÅåÁÇπ„ÇíËøΩÂä†„Åô„Çã„ÄÇ\n                    // „Åì„Åì„Åß„Éû„Ç¶„ÇπÂ∫ßÊ®ô(e.clientX/Y)„ÇíÊ∑∑„Åú„Çã„Å®„ÄÅÂà•Â∫ßÊ®ô„ÅåÊ∑∑„Åñ„Å£„Å¶Á∑ö„Åå‰º∏„Å≥„Çã„ÅÆ„Åß‰Ωï„ÇÇ„Åó„Å™„ÅÑ„ÄÇ\n                    if (irCursorEnabled) return;\n\n                    // ‚òÖIR Cursor OFF „ÅÆ„Å®„Åç„Å†„Åë„Äå„Éû„Ç¶„ÇπÂ∫ßÊ®ô„Åß1ÁÇπ„Å†„ÅëÊèè„Åè„ÄçÊåôÂãï„ÇíË®±ÂèØÔºà‰ªïÊßòÈÄö„Çä„ÅÆÊåôÂãïÔºâ\n                    e.preventDefault();\n                    setDrawingPoints((prev) => {\n                        const next = prev.slice();\n                        if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                        next.push({ x: e.clientX, y: e.clientY, mode: \"draw\" });\n                        next.push(null); // ‚îÖ1Êú¨„Å†„Åë„ÅßÂøÖ„ÅöÂå∫Âàá„Çã\n                        return next;\n                    });\n                    return;\n                }\n\n                // 3) ‰Ωï„ÇÇ„Åó„Å¶„Å™„ÅÑ„Å™„Çâ‰Ωï„ÇÇ„Åó„Å™„ÅÑ\n                return;\n            }}\n            onMouseUp={() => {\n                if (!isMouseDrawingRef.current) return;\n                isMouseDrawingRef.current = false;\n                setIsPainting(false); // „Éö„É≥„Ç´„Éº„ÇΩ„É´Ëß£Èô§\n                setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n            }}\n            onMouseLeave={() => {\n                if (!isMouseDrawingRef.current) return;\n                isMouseDrawingRef.current = false;\n                setIsPainting(false); // „Éö„É≥„Ç´„Éº„ÇΩ„É´Ëß£Èô§\n                setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n            }}\n            className={isPainting ? 'presenter-painting' : 'presenter-container'}\n            style={{\n                position: \"relative\",\n                width: \"100vw\",\n                height: \"100vh\",\n                overflow: \"hidden\",\n                background: \"black\",\n            }}\n        >\n\n            <WiiDisconnectPopup\n                isPlaying={isPlaying}\n                startedWithWii={startedWithWii}\n                wiiConnected={wiiConnected}\n                wiiDisconnectedAt={wiiDisconnectedAt}\n                playingSince={playingSince}\n            />\n\n            <WiiReconnectPopup\n                isPlaying={isPlaying}\n                wiiConnected={wiiConnected}\n                startedWithWii={startedWithWii}\n            />\n\n            {/* Êàª„Çã„Éú„Çø„É≥ÔºàÂ∑¶‰∏äÔºâ */}\n            <div style={{ position: \"absolute\", top: 20, left: 20, zIndex: 10000 }}>\n                <button onClick={goBack} style={{ padding: \"10px 14px\", fontSize: 14 }}>\n                    {returnLabel}\n                </button>\n            </div>\n\n            {/* „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ */}\n            <ReactionOverlay emitClap={shouldEmitClap} emitLaugh={shouldEmitLaugh} />\n\n            {/* IR„Éù„Ç§„É≥„Çø„Éº„Ç™„Éº„Éê„Éº„É¨„Ç§ */}\n            <IrPointerOverlay\n                wiiState={wiiState}\n                isPlaying={isPlaying}\n                irCursorEnabled={irCursorEnabled}\n                showIrDebug={showIrDebug}\n            />\n\n            {/* „Çπ„É©„Ç§„ÉâË°®Á§∫„Ç®„É™„Ç¢ (ÂÖ®ÁîªÈù¢„Éª‰ΩôÁôΩ„Å™„Åó„Éª„Ç¢„Çπ„Éö„ÇØ„ÉàÊØîÁ∂≠ÊåÅ) */}\n            <SlideDisplay\n                currentNode={currentNode}\n                error={error}\n                getOrLoadPdfDocument={getOrLoadPdfDocument}\n            />\n\n            {/* ÊèèÁîª„É¨„Ç§„É§„Éº (ÊúÄÂâçÈù¢) */}\n            <DrawingCanvas\n                drawingPoints={drawingPoints}\n                wiiState={wiiState}\n                isPlaying={isPlaying}\n                shouldPaint={shouldPaint}\n                eraserMode={eraserMode}\n                eraserPosition={cursorPos}\n            />\n\n            {/* „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†± (Âè≥‰∏ä) */}\n            {showDebugPanel && (\n                <WiiDebugPanel\n                    wiiState={wiiState}\n                    pressed={pressed}\n                    effectiveProjectBindings={effectiveProjectBindings}\n                    irCursorEnabled={irCursorEnabled}\n                    onToggleIrCursor={() => setIrCursorEnabled(!irCursorEnabled)}\n                />\n            )}\n\n            {/* Êìç‰Ωú„Ç¨„Ç§„Éâ (Â∑¶‰∏ã) */}\n            <div style={{ position: \"absolute\", bottom: 20, left: 20, color: \"rgba(255,255,255,0.5)\", fontSize: 14, pointerEvents: \"none\" }}>\n                [ESC] Êàª„Çã | [SPACE] „Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫ÂàáÊõø\n            </div>\n\n            {/* Ê∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´ */}\n            <EraserCursor\n                position={cursorPos}\n                isActive={eraserMode}\n                buttonName={eraserButtonName}\n            />\n\n            {/* Ê∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´ */}\n            {eraserMode && cursorPos && (\n                <div\n                    style={{\n                        position: \"absolute\",\n                        left: cursorPos.x,\n                        top: cursorPos.y,\n                        width: 120,\n                        height: 120,\n                        borderRadius: \"50%\",\n                        border: \"3px dashed rgba(255, 100, 100, 0.8)\",\n                        background: \"rgba(255, 100, 100, 0.2)\",\n                        transform: \"translate(-50%, -50%)\",\n                        pointerEvents: \"none\",\n                        zIndex: 10000,\n                    }}\n                />\n            )}\n        </main>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}