{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/idbAssets.ts"],"sourcesContent":["const DB_NAME = \"wiislide\";\nconst DB_VERSION = 1;\nconst STORE_NAME = \"assets\";\n\nfunction openDb(): Promise<IDBDatabase> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst req = indexedDB.open(DB_NAME, DB_VERSION);\n\t\treq.onupgradeneeded = () => {\n\t\t\tconst db = req.result;\n\t\t\tif (!db.objectStoreNames.contains(STORE_NAME)) {\n\t\t\t\tdb.createObjectStore(STORE_NAME);\n\t\t\t}\n\t\t};\n\t\treq.onsuccess = () => resolve(req.result);\n\t\treq.onerror = () => reject(req.error);\n\t});\n}\n\nexport async function putAssetBlob(assetId: string, blob: Blob): Promise<void> {\n\tconst db = await openDb();\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readwrite\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t\tresolve();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\ttx.objectStore(STORE_NAME).put(blob, assetId);\n\t});\n}\n\nexport async function getAssetBlob(assetId: string): Promise<Blob | null> {\n\tconst db = await openDb();\n\treturn await new Promise<Blob | null>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readonly\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\tconst req = tx.objectStore(STORE_NAME).get(assetId);\n\t\treq.onsuccess = () => resolve((req.result as Blob | undefined) ?? null);\n\t\treq.onerror = () => reject(req.error);\n\t});\n}\n\nexport async function clearAllAssetBlobs(): Promise<void> {\n\tconst db = await openDb();\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readwrite\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t\tresolve();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\ttx.objectStore(STORE_NAME).clear();\n\t});\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,UAAU;AAChB,MAAM,aAAa;AACnB,MAAM,aAAa;AAEnB,SAAS;IACR,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,MAAM,UAAU,IAAI,CAAC,SAAS;QACpC,IAAI,eAAe,GAAG;YACrB,MAAM,KAAK,IAAI,MAAM;YACrB,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,aAAa;gBAC9C,GAAG,iBAAiB,CAAC;YACtB;QACD;QACA,IAAI,SAAS,GAAG,IAAM,QAAQ,IAAI,MAAM;QACxC,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,KAAK;IACrC;AACD;AAEO,eAAe,aAAa,OAAe,EAAE,IAAU;IAC7D,MAAM,KAAK,MAAM;IACjB,MAAM,IAAI,QAAc,CAAC,SAAS;QACjC,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;YACR;QACD;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,GAAG,WAAW,CAAC,YAAY,GAAG,CAAC,MAAM;IACtC;AACD;AAEO,eAAe,aAAa,OAAe;IACjD,MAAM,KAAK,MAAM;IACjB,OAAO,MAAM,IAAI,QAAqB,CAAC,SAAS;QAC/C,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;QACT;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,MAAM,MAAM,GAAG,WAAW,CAAC,YAAY,GAAG,CAAC;QAC3C,IAAI,SAAS,GAAG,IAAM,QAAQ,AAAC,IAAI,MAAM,IAAyB;QAClE,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,KAAK;IACrC;AACD;AAEO,eAAe;IACrB,MAAM,KAAK,MAAM;IACjB,MAAM,IAAI,QAAc,CAAC,SAAS;QACjC,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;YACR;QACD;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,GAAG,WAAW,CAAC,YAAY,KAAK;IACjC;AACD"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/useWiiController.ts"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\nexport type WiiButtons = {\r\n\tA: boolean;\r\n\tB: boolean;\r\n\tOne: boolean;\r\n\tTwo: boolean;\r\n\tPlus: boolean;\r\n\tMinus: boolean;\r\n\tHome: boolean;\r\n\tUp: boolean;\r\n\tDown: boolean;\r\n\tRight: boolean;\r\n\tLeft: boolean;\r\n};\r\n\r\nexport type WiiState = {\r\n\tbuttons: WiiButtons;\r\n\taccel: { x: number; y: number; z: number };\r\n\tir: { x: number; y: number }[];\r\n\tcursor?: { x: number; y: number } | null;\r\n};\r\n\r\ntype WiiServerMessage =\r\n\t| { type: \"status\"; connected: boolean; irCursorEnabled?: boolean }\r\n\t| { type: \"irCursorStatus\"; enabled: boolean }\r\n\t| { type: \"wiiDisconnected\"; at?: number }\r\n\t| WiiState;\r\n\r\nconst EMPTY_BUTTONS: WiiButtons = {\r\n\tA: false, B: false, One: false, Two: false,\r\n\tPlus: false, Minus: false, Home: false,\r\n\tUp: false, Down: false, Right: false, Left: false,\r\n};\r\n\r\nconst KEY_TO_BUTTON: Record<string, keyof WiiButtons> = {\r\n\ti: \"Up\", j: \"Left\", k: \"Down\", l: \"Right\",\r\n\t\";\": \"Plus\", \"-\": \"Minus\",\r\n\th: \"Home\", o: \"A\", p: \"B\",\r\n\tn: \"One\", m: \"Two\",\r\n};\r\n\r\nfunction keyToButton(key: string): keyof WiiButtons | null {\r\n\tconst k = key.length === 1 ? key.toLowerCase() : key;\r\n\treturn KEY_TO_BUTTON[k] ?? null;\r\n}\r\n\r\nexport function useWiiController() {\r\n\tconst [wiiState, setWiiState] = useState<WiiState | null>(null);\r\n\tconst [wiiConnected, setWiiConnected] = useState(false);\r\n\tconst [wiiDisconnectedAt, setWiiDisconnectedAt] = useState<number | null>(null);\r\n\tconst [irCursorEnabled, setIrCursorEnabled] = useState(false);\r\n\tconst [pressed, setPressed] = useState<Partial<WiiButtons>>({});\r\n\r\n\tconst wasConnectedRef = useRef(false);\r\n\tconst wsRef = useRef<WebSocket | null>(null);\r\n\tconst pressedBufferRef = useRef<Partial<WiiButtons>>({});\r\n\tconst prevButtonsRef = useRef<WiiButtons | null>(null);\r\n\tconst latestWiiDataRef = useRef<WiiState | null>(null);\r\n\tconst pendingPressedRef = useRef<Partial<WiiButtons>>({});\r\n\tconst kbButtonsRef = useRef<WiiButtons>({ ...EMPTY_BUTTONS });\r\n\tconst kbPressedBufferRef = useRef<Partial<WiiButtons>>({});\r\n\r\n\tuseEffect(() => {\r\n\t\tconst onKeyDown = (e: KeyboardEvent) => {\r\n\t\t\tif (e.repeat) return;\r\n\t\t\tconst btn = keyToButton(e.key);\r\n\t\t\tif (!btn) return;\r\n\t\t\tkbButtonsRef.current = { ...kbButtonsRef.current, [btn]: true };\r\n\t\t\tkbPressedBufferRef.current[btn] = true;\r\n\t\t};\r\n\r\n\t\tconst onKeyUp = (e: KeyboardEvent) => {\r\n\t\t\tconst btn = keyToButton(e.key);\r\n\t\t\tif (!btn) return;\r\n\t\t\tkbButtonsRef.current = { ...kbButtonsRef.current, [btn]: false };\r\n\t\t};\r\n\r\n\t\twindow.addEventListener(\"keydown\", onKeyDown);\r\n\t\twindow.addEventListener(\"keyup\", onKeyUp);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"keydown\", onKeyDown);\r\n\t\t\twindow.removeEventListener(\"keyup\", onKeyUp);\r\n\t\t};\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst ws = new WebSocket(\"ws://localhost:8080\");\r\n\t\twsRef.current = ws;\r\n\r\n\t\tws.onopen = () => console.log(\"Connected to Wii Server\");\r\n\r\n\t\tws.onmessage = (event) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst msg = JSON.parse(event.data) as WiiServerMessage;\r\n\r\n\t\t\t\tif (msg && typeof msg === \"object\" && \"type\" in msg) {\r\n\t\t\t\t\tconst typedMsg = msg as { type: string; connected?: boolean; enabled?: boolean; irCursorEnabled?: boolean; at?: number };\r\n\r\n\t\t\t\t\tif (typedMsg.type === \"status\") {\r\n\t\t\t\t\t\tconst connected = !!typedMsg.connected;\r\n\t\t\t\t\t\tsetWiiConnected(connected);\r\n\t\t\t\t\t\twasConnectedRef.current = connected;\r\n\t\t\t\t\t\tif (typeof typedMsg.irCursorEnabled === \"boolean\") {\r\n\t\t\t\t\t\t\tsetIrCursorEnabled(typedMsg.irCursorEnabled);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typedMsg.type === \"irCursorStatus\") {\r\n\t\t\t\t\t\tsetIrCursorEnabled(!!typedMsg.enabled);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typedMsg.type === \"wiiDisconnected\") {\r\n\t\t\t\t\t\tsetWiiConnected(false);\r\n\t\t\t\t\t\twasConnectedRef.current = false;\r\n\t\t\t\t\t\tsetWiiDisconnectedAt(typeof typedMsg.at === \"number\" ? typedMsg.at : Date.now());\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst data = msg as WiiState;\r\n\t\t\t\tsetWiiConnected(true);\r\n\t\t\t\twasConnectedRef.current = true;\r\n\r\n\t\t\t\tif (prevButtonsRef.current) {\r\n\t\t\t\t\t(Object.keys(data.buttons) as Array<keyof WiiButtons>).forEach((key) => {\r\n\t\t\t\t\t\tif (data.buttons[key] && !prevButtonsRef.current![key]) {\r\n\t\t\t\t\t\t\tpressedBufferRef.current[key] = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tprevButtonsRef.current = data.buttons;\r\n\t\t\t\tlatestWiiDataRef.current = data;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"Parse error:\", e);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst handleDisconnect = () => {\r\n\t\t\tconst wasConnected = wasConnectedRef.current;\r\n\t\t\tsetWiiConnected(false);\r\n\t\t\twasConnectedRef.current = false;\r\n\t\t\tif (wasConnected) {\r\n\t\t\t\tsetWiiDisconnectedAt(Date.now());\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tws.onerror = handleDisconnect;\r\n\t\tws.onclose = handleDisconnect;\r\n\r\n\t\treturn () => {\r\n\t\t\ttry { ws.close(); } catch { /* ignore */ }\r\n\t\t\twsRef.current = null;\r\n\t\t};\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet raf = 0;\r\n\r\n\t\tconst flushState = (wiiDataOrNull: WiiState | null) => {\r\n\t\t\tconst wiiButtons = wiiDataOrNull?.buttons ?? null;\r\n\t\t\tconst kbButtons = kbButtonsRef.current;\r\n\r\n\t\t\tconst mergedButtons: WiiButtons = {\r\n\t\t\t\tA: (wiiButtons?.A ?? false) || kbButtons.A,\r\n\t\t\t\tB: (wiiButtons?.B ?? false) || kbButtons.B,\r\n\t\t\t\tOne: (wiiButtons?.One ?? false) || kbButtons.One,\r\n\t\t\t\tTwo: (wiiButtons?.Two ?? false) || kbButtons.Two,\r\n\t\t\t\tPlus: (wiiButtons?.Plus ?? false) || kbButtons.Plus,\r\n\t\t\t\tMinus: (wiiButtons?.Minus ?? false) || kbButtons.Minus,\r\n\t\t\t\tHome: (wiiButtons?.Home ?? false) || kbButtons.Home,\r\n\t\t\t\tUp: (wiiButtons?.Up ?? false) || kbButtons.Up,\r\n\t\t\t\tDown: (wiiButtons?.Down ?? false) || kbButtons.Down,\r\n\t\t\t\tRight: (wiiButtons?.Right ?? false) || kbButtons.Right,\r\n\t\t\t\tLeft: (wiiButtons?.Left ?? false) || kbButtons.Left,\r\n\t\t\t};\r\n\r\n\t\t\tfor (const key of Object.keys(pressedBufferRef.current)) {\r\n\t\t\t\tpendingPressedRef.current[key as keyof WiiButtons] = true;\r\n\t\t\t}\r\n\t\t\tfor (const key of Object.keys(kbPressedBufferRef.current)) {\r\n\t\t\t\tpendingPressedRef.current[key as keyof WiiButtons] = true;\r\n\t\t\t}\r\n\t\t\tpressedBufferRef.current = {};\r\n\t\t\tkbPressedBufferRef.current = {};\r\n\r\n\t\t\tconst mergedPressed: Partial<WiiButtons> = { ...pendingPressedRef.current };\r\n\t\t\tpendingPressedRef.current = {};\r\n\r\n\t\t\tconst mergedState: WiiState = {\r\n\t\t\t\tbuttons: mergedButtons,\r\n\t\t\t\taccel: wiiDataOrNull?.accel ?? { x: 0, y: 0, z: 0 },\r\n\t\t\t\tir: wiiDataOrNull?.ir ?? [],\r\n\t\t\t\tcursor: wiiDataOrNull?.cursor ?? null,\r\n\t\t\t};\r\n\r\n\t\t\tsetWiiState(mergedState);\r\n\t\t\tsetPressed(mergedPressed);\r\n\t\t};\r\n\r\n\t\tconst loop = () => {\r\n\t\t\tflushState(latestWiiDataRef.current);\r\n\t\t\traf = window.requestAnimationFrame(loop);\r\n\t\t};\r\n\r\n\t\traf = window.requestAnimationFrame(loop);\r\n\t\treturn () => window.cancelAnimationFrame(raf);\r\n\t}, []);\r\n\r\n\tconst playWiiSound = (soundType: \"shot\" | \"oh\" | \"uxo\") => {\r\n\t\tif (!wsRef.current || wsRef.current.readyState !== WebSocket.OPEN) return;\r\n\t\ttry {\r\n\t\t\twsRef.current.send(JSON.stringify({ type: \"playSound\", soundType }));\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(\"Failed to send playSound message:\", e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst setIrCursorEnabledFn = (enabled: boolean) => {\r\n\t\tsetIrCursorEnabled(enabled);\r\n\t\tif (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\r\n\t\t\ttry {\r\n\t\t\t\twsRef.current.send(JSON.stringify({ type: \"setIrCursor\", enabled }));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"Failed to send setIrCursor message:\", e);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\twiiState,\r\n\t\tpressed,\r\n\t\twiiConnected,\r\n\t\twiiDisconnectedAt,\r\n\t\tirCursorEnabled,\r\n\t\tsetIrCursorEnabled: setIrCursorEnabledFn,\r\n\t\tplayWiiSound,\r\n\t};\r\n}"],"names":[],"mappings":";;;;AACA;;AADA;;AA8BA,MAAM,gBAA4B;IACjC,GAAG;IAAO,GAAG;IAAO,KAAK;IAAO,KAAK;IACrC,MAAM;IAAO,OAAO;IAAO,MAAM;IACjC,IAAI;IAAO,MAAM;IAAO,OAAO;IAAO,MAAM;AAC7C;AAEA,MAAM,gBAAkD;IACvD,GAAG;IAAM,GAAG;IAAQ,GAAG;IAAQ,GAAG;IAClC,KAAK;IAAQ,KAAK;IAClB,GAAG;IAAQ,GAAG;IAAK,GAAG;IACtB,GAAG;IAAO,GAAG;AACd;AAEA,SAAS,YAAY,GAAW;IAC/B,MAAM,IAAI,IAAI,MAAM,KAAK,IAAI,IAAI,WAAW,KAAK;IACjD,OAAO,aAAa,CAAC,EAAE,IAAI;AAC5B;AAEO,SAAS;;IACf,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,6MAAQ,EAAkB;IAC1D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6MAAQ,EAAC;IACjD,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,6MAAQ,EAAgB;IAC1E,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,6MAAQ,EAAC;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6MAAQ,EAAsB,CAAC;IAE7D,MAAM,kBAAkB,IAAA,2MAAM,EAAC;IAC/B,MAAM,QAAQ,IAAA,2MAAM,EAAmB;IACvC,MAAM,mBAAmB,IAAA,2MAAM,EAAsB,CAAC;IACtD,MAAM,iBAAiB,IAAA,2MAAM,EAAoB;IACjD,MAAM,mBAAmB,IAAA,2MAAM,EAAkB;IACjD,MAAM,oBAAoB,IAAA,2MAAM,EAAsB,CAAC;IACvD,MAAM,eAAe,IAAA,2MAAM,EAAa;QAAE,GAAG,aAAa;IAAC;IAC3D,MAAM,qBAAqB,IAAA,2MAAM,EAAsB,CAAC;IAExD,IAAA,8MAAS;sCAAC;YACT,MAAM;wDAAY,CAAC;oBAClB,IAAI,EAAE,MAAM,EAAE;oBACd,MAAM,MAAM,YAAY,EAAE,GAAG;oBAC7B,IAAI,CAAC,KAAK;oBACV,aAAa,OAAO,GAAG;wBAAE,GAAG,aAAa,OAAO;wBAAE,CAAC,IAAI,EAAE;oBAAK;oBAC9D,mBAAmB,OAAO,CAAC,IAAI,GAAG;gBACnC;;YAEA,MAAM;sDAAU,CAAC;oBAChB,MAAM,MAAM,YAAY,EAAE,GAAG;oBAC7B,IAAI,CAAC,KAAK;oBACV,aAAa,OAAO,GAAG;wBAAE,GAAG,aAAa,OAAO;wBAAE,CAAC,IAAI,EAAE;oBAAM;gBAChE;;YAEA,OAAO,gBAAgB,CAAC,WAAW;YACnC,OAAO,gBAAgB,CAAC,SAAS;YACjC;8CAAO;oBACN,OAAO,mBAAmB,CAAC,WAAW;oBACtC,OAAO,mBAAmB,CAAC,SAAS;gBACrC;;QACD;qCAAG,EAAE;IAEL,IAAA,8MAAS;sCAAC;YACT,MAAM,KAAK,IAAI,UAAU;YACzB,MAAM,OAAO,GAAG;YAEhB,GAAG,MAAM;8CAAG,IAAM,QAAQ,GAAG,CAAC;;YAE9B,GAAG,SAAS;8CAAG,CAAC;oBACf,IAAI;wBACH,MAAM,MAAM,KAAK,KAAK,CAAC,MAAM,IAAI;wBAEjC,IAAI,OAAO,OAAO,QAAQ,YAAY,UAAU,KAAK;4BACpD,MAAM,WAAW;4BAEjB,IAAI,SAAS,IAAI,KAAK,UAAU;gCAC/B,MAAM,YAAY,CAAC,CAAC,SAAS,SAAS;gCACtC,gBAAgB;gCAChB,gBAAgB,OAAO,GAAG;gCAC1B,IAAI,OAAO,SAAS,eAAe,KAAK,WAAW;oCAClD,mBAAmB,SAAS,eAAe;gCAC5C;gCACA;4BACD;4BAEA,IAAI,SAAS,IAAI,KAAK,kBAAkB;gCACvC,mBAAmB,CAAC,CAAC,SAAS,OAAO;gCACrC;4BACD;4BAEA,IAAI,SAAS,IAAI,KAAK,mBAAmB;gCACxC,gBAAgB;gCAChB,gBAAgB,OAAO,GAAG;gCAC1B,qBAAqB,OAAO,SAAS,EAAE,KAAK,WAAW,SAAS,EAAE,GAAG,KAAK,GAAG;gCAC7E;4BACD;wBACD;wBAEA,MAAM,OAAO;wBACb,gBAAgB;wBAChB,gBAAgB,OAAO,GAAG;wBAE1B,IAAI,eAAe,OAAO,EAAE;4BAC1B,OAAO,IAAI,CAAC,KAAK,OAAO,EAA8B,OAAO;8DAAC,CAAC;oCAC/D,IAAI,KAAK,OAAO,CAAC,IAAI,IAAI,CAAC,eAAe,OAAO,AAAC,CAAC,IAAI,EAAE;wCACvD,iBAAiB,OAAO,CAAC,IAAI,GAAG;oCACjC;gCACD;;wBACD;wBACA,eAAe,OAAO,GAAG,KAAK,OAAO;wBACrC,iBAAiB,OAAO,GAAG;oBAC5B,EAAE,OAAO,GAAG;wBACX,QAAQ,KAAK,CAAC,gBAAgB;oBAC/B;gBACD;;YAEA,MAAM;+DAAmB;oBACxB,MAAM,eAAe,gBAAgB,OAAO;oBAC5C,gBAAgB;oBAChB,gBAAgB,OAAO,GAAG;oBAC1B,IAAI,cAAc;wBACjB,qBAAqB,KAAK,GAAG;oBAC9B;gBACD;;YAEA,GAAG,OAAO,GAAG;YACb,GAAG,OAAO,GAAG;YAEb;8CAAO;oBACN,IAAI;wBAAE,GAAG,KAAK;oBAAI,EAAE,OAAM,CAAe;oBACzC,MAAM,OAAO,GAAG;gBACjB;;QACD;qCAAG,EAAE;IAEL,IAAA,8MAAS;sCAAC;YACT,IAAI,MAAM;YAEV,MAAM;yDAAa,CAAC;oBACnB,MAAM,aAAa,eAAe,WAAW;oBAC7C,MAAM,YAAY,aAAa,OAAO;oBAEtC,MAAM,gBAA4B;wBACjC,GAAG,CAAC,YAAY,KAAK,KAAK,KAAK,UAAU,CAAC;wBAC1C,GAAG,CAAC,YAAY,KAAK,KAAK,KAAK,UAAU,CAAC;wBAC1C,KAAK,CAAC,YAAY,OAAO,KAAK,KAAK,UAAU,GAAG;wBAChD,KAAK,CAAC,YAAY,OAAO,KAAK,KAAK,UAAU,GAAG;wBAChD,MAAM,CAAC,YAAY,QAAQ,KAAK,KAAK,UAAU,IAAI;wBACnD,OAAO,CAAC,YAAY,SAAS,KAAK,KAAK,UAAU,KAAK;wBACtD,MAAM,CAAC,YAAY,QAAQ,KAAK,KAAK,UAAU,IAAI;wBACnD,IAAI,CAAC,YAAY,MAAM,KAAK,KAAK,UAAU,EAAE;wBAC7C,MAAM,CAAC,YAAY,QAAQ,KAAK,KAAK,UAAU,IAAI;wBACnD,OAAO,CAAC,YAAY,SAAS,KAAK,KAAK,UAAU,KAAK;wBACtD,MAAM,CAAC,YAAY,QAAQ,KAAK,KAAK,UAAU,IAAI;oBACpD;oBAEA,KAAK,MAAM,OAAO,OAAO,IAAI,CAAC,iBAAiB,OAAO,EAAG;wBACxD,kBAAkB,OAAO,CAAC,IAAwB,GAAG;oBACtD;oBACA,KAAK,MAAM,OAAO,OAAO,IAAI,CAAC,mBAAmB,OAAO,EAAG;wBAC1D,kBAAkB,OAAO,CAAC,IAAwB,GAAG;oBACtD;oBACA,iBAAiB,OAAO,GAAG,CAAC;oBAC5B,mBAAmB,OAAO,GAAG,CAAC;oBAE9B,MAAM,gBAAqC;wBAAE,GAAG,kBAAkB,OAAO;oBAAC;oBAC1E,kBAAkB,OAAO,GAAG,CAAC;oBAE7B,MAAM,cAAwB;wBAC7B,SAAS;wBACT,OAAO,eAAe,SAAS;4BAAE,GAAG;4BAAG,GAAG;4BAAG,GAAG;wBAAE;wBAClD,IAAI,eAAe,MAAM,EAAE;wBAC3B,QAAQ,eAAe,UAAU;oBAClC;oBAEA,YAAY;oBACZ,WAAW;gBACZ;;YAEA,MAAM;mDAAO;oBACZ,WAAW,iBAAiB,OAAO;oBACnC,MAAM,OAAO,qBAAqB,CAAC;gBACpC;;YAEA,MAAM,OAAO,qBAAqB,CAAC;YACnC;8CAAO,IAAM,OAAO,oBAAoB,CAAC;;QAC1C;qCAAG,EAAE;IAEL,MAAM,eAAe,CAAC;QACrB,IAAI,CAAC,MAAM,OAAO,IAAI,MAAM,OAAO,CAAC,UAAU,KAAK,UAAU,IAAI,EAAE;QACnE,IAAI;YACH,MAAM,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;gBAAE,MAAM;gBAAa;YAAU;QAClE,EAAE,OAAO,GAAG;YACX,QAAQ,KAAK,CAAC,qCAAqC;QACpD;IACD;IAEA,MAAM,uBAAuB,CAAC;QAC7B,mBAAmB;QACnB,IAAI,MAAM,OAAO,IAAI,MAAM,OAAO,CAAC,UAAU,KAAK,UAAU,IAAI,EAAE;YACjE,IAAI;gBACH,MAAM,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;oBAAE,MAAM;oBAAe;gBAAQ;YAClE,EAAE,OAAO,GAAG;gBACX,QAAQ,KAAK,CAAC,uCAAuC;YACtD;QACD;IACD;IAEA,OAAO;QACN;QACA;QACA;QACA;QACA;QACA,oBAAoB;QACpB;IACD;AACD;GAjMgB"}},
    {"offset": {"line": 344, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/presentation.ts"],"sourcesContent":["import type { ButtonBindings } from \"@/lib/buttonBindings\";\n\nexport type ProjectAsset = {\n\tid: string;\n\tkind: \"pdf\" | \"video\" | \"image\";\n\tfileName: string;\n\tstoredFileName: string; // assets/ ÈÖç‰∏ã„ÅÆ„Éï„Ç°„Ç§„É´Âêç\n};\n\nexport type AssetRef =\n\t| {\n\t\t\tkind: \"pdf\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tpage: number;\n\t\t\tthumbnailDataUrl?: string;\n\t  }\n\t| {\n\t\t\tkind: \"video\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tthumbnailDataUrl?: string;\n\t  }\n\t| {\n\t\t\tkind: \"image\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tthumbnailDataUrl?: string;\n\t  };\n\nexport type SlideNodeData = {\n\tlabel: string;\n\tasset?: AssetRef;\n\tbindings?: ButtonBindings;\n};\n\nexport type SerializedFlow = {\n\tversion: 1;\n\tassets?: ProjectAsset[];\n\tviewport?: { x: number; y: number; zoom: number };\n\tprojectBindings?: ButtonBindings;\n\tnodes: Array<{\n\t\tid: string;\n\t\ttype?: string;\n\t\tposition: { x: number; y: number };\n\t\tdata: SlideNodeData;\n\t}>;\n\tedges: Array<{\n\t\tid: string;\n\t\tsource: string;\n\t\ttarget: string;\n\t\tlabel?: string;\n\t}>;\n};\n\nconst STORAGE_KEY = \"wiisugeee.editor.flow.v1\";\nconst LAST_SAVED_HASH_KEY = \"wiisugeee.editor.lastSavedHash.v1\";\n\nexport function serializeFlow(flow: SerializedFlow): string {\n\treturn JSON.stringify(flow, null, 2);\n}\n\nexport function tryParseFlowJson(text: string): SerializedFlow | null {\n\ttry {\n\t\tconst parsed = JSON.parse(text) as unknown;\n\t\tif (!parsed || typeof parsed !== \"object\") return null;\n\t\tconst maybe = parsed as Partial<SerializedFlow>;\n\t\tif (maybe.version !== 1) return null;\n\t\tif (!Array.isArray(maybe.nodes) || !Array.isArray(maybe.edges)) return null;\n\t\treturn maybe as SerializedFlow;\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function saveToLocalStorage(flow: SerializedFlow): void {\n\ttry {\n\t\tlocalStorage.setItem(STORAGE_KEY, serializeFlow(flow));\n\t} catch {\n\t\t// ignore\n\t}\n}\n\nexport function loadFromLocalStorage(): SerializedFlow | null {\n\ttry {\n\t\tconst text = localStorage.getItem(STORAGE_KEY);\n\t\tif (!text) return null;\n\t\treturn tryParseFlowJson(text);\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function getLastSavedHash(): string | null {\n\ttry {\n\t\treturn localStorage.getItem(LAST_SAVED_HASH_KEY);\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function setLastSavedHash(hash: string): void {\n\ttry {\n\t\tlocalStorage.setItem(LAST_SAVED_HASH_KEY, hash);\n\t} catch {\n\t\t// ignore\n\t}\n}\n\nexport function clearEditorStorage(): void {\n\ttry {\n\t\tlocalStorage.removeItem(STORAGE_KEY);\n\t\tlocalStorage.removeItem(LAST_SAVED_HASH_KEY);\n\t} catch {\n\t\t// ignore\n\t}\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAuDA,MAAM,cAAc;AACpB,MAAM,sBAAsB;AAErB,SAAS,cAAc,IAAoB;IACjD,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AACnC;AAEO,SAAS,iBAAiB,IAAY;IAC5C,IAAI;QACH,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU,OAAO;QAClD,MAAM,QAAQ;QACd,IAAI,MAAM,OAAO,KAAK,GAAG,OAAO;QAChC,IAAI,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,GAAG,OAAO;QACvE,OAAO;IACR,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS,mBAAmB,IAAoB;IACtD,IAAI;QACH,aAAa,OAAO,CAAC,aAAa,cAAc;IACjD,EAAE,OAAM;IACP,SAAS;IACV;AACD;AAEO,SAAS;IACf,IAAI;QACH,MAAM,OAAO,aAAa,OAAO,CAAC;QAClC,IAAI,CAAC,MAAM,OAAO;QAClB,OAAO,iBAAiB;IACzB,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS;IACf,IAAI;QACH,OAAO,aAAa,OAAO,CAAC;IAC7B,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS,iBAAiB,IAAY;IAC5C,IAAI;QACH,aAAa,OAAO,CAAC,qBAAqB;IAC3C,EAAE,OAAM;IACP,SAAS;IACV;AACD;AAEO,SAAS;IACf,IAAI;QACH,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IACzB,EAAE,OAAM;IACP,SAAS;IACV;AACD"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/buttonBindings.ts"],"sourcesContent":["import type { WiiState } from \"@/hooks/useWiiController\";\r\n\r\nexport type WiiButton = keyof WiiState[\"buttons\"];\r\n\r\nexport type BindingAction =\r\n\t| { type: \"none\"; subtype?: string }\r\n\t| { type: \"next\" }\r\n\t| { type: \"prev\" }\r\n\t| { type: \"branch\"; kind: \"A\" | \"B\" | \"HOME\" }\r\n\t| { type: \"branchIndex\"; index: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 }\r\n\t| { type: \"reaction\"; kind: \"clap\" | \"laugh\" }\r\n\t| { type: \"paint\" }\r\n\t| { type: \"eraser\" }\r\n\t| { type: \"sound\"; kind: \"shot\" | \"oh\" | \"uxo\"; outputDevice?: \"pc\" | \"wii\" }\r\n\t| { type: \"remove\" }\r\n\t| { type: \"irSens\" };\r\n\r\nexport type ButtonBindings = Partial<Record<WiiButton, BindingAction>>;\r\n\r\nexport type SoundOutputDevice = \"pc\" | \"wii\";\r\n\r\nexport interface SoundSettings {\r\n\toutputDevice: SoundOutputDevice;\r\n}\r\n\r\nexport const DEFAULT_SOUND_SETTINGS: SoundSettings = {\r\n\toutputDevice: \"pc\",\r\n};\r\n\r\nexport const DEFAULT_BINDINGS: ButtonBindings = {\r\n\tRight: { type: \"next\" },\r\n\tLeft: { type: \"prev\" },\r\n\tPlus: { type: \"branch\", kind: \"A\" },\r\n\tMinus: { type: \"branch\", kind: \"B\" },\r\n\tHome: { type: \"branch\", kind: \"HOME\" },\r\n\tOne: { type: \"reaction\", kind: \"clap\" },\r\n\tTwo: { type: \"reaction\", kind: \"laugh\" },\r\n};\r\n\r\nexport function formatAction(a: BindingAction): string {\r\n\tswitch (a.type) {\r\n\t\tcase \"none\":\r\n\t\t\treturn \"Êú™Ââ≤ÂΩì\";\r\n\t\tcase \"next\":\r\n\t\t\treturn \"Ê¨°„Å∏\";\r\n\t\tcase \"prev\":\r\n\t\t\treturn \"Êàª„Çã\";\r\n\t\tcase \"branch\":\r\n\t\t\tswitch (a.kind) {\r\n\t\t\t\tcase \"A\":\r\n\t\t\t\t\treturn \"A„É´„Éº„Éà„Å∏ÂàÜÂ≤ê\";\r\n\t\t\t\tcase \"B\":\r\n\t\t\t\t\treturn \"B„É´„Éº„Éà„Å∏ÂàÜÂ≤ê\";\r\n\t\t\t\tcase \"HOME\":\r\n\t\t\t\t\treturn \"HOME„Å∏Êàª„Çã\";\r\n\t\t\t}\r\n\t\tcase \"branchIndex\":\r\n\t\t\treturn `ÂàÜÂ≤ê ${a.index}`;\r\n\t\tcase \"reaction\":\r\n\t\t\treturn a.kind === \"clap\" ? \"ÊãçÊâã\" : \"Á¨ë„ÅÑ\";\r\n\t\tcase \"paint\":\r\n\t\t\treturn \"PAINTüé®\";\r\n\t\tcase \"eraser\":\r\n\t\t\treturn \"ERASER\";\r\n\t\tcase \"sound\": {\r\n\t\t\tconst device = a.outputDevice === \"wii\" ? \"[Wii]\" : \"[PC]\";\r\n\t\t\tswitch (a.kind) {\r\n\t\t\t\tcase \"shot\":\r\n\t\t\t\t\treturn `SHOTüîä${device}`;\r\n\t\t\t\tcase \"oh\":\r\n\t\t\t\t\treturn `Oh...üîä${device}`;\r\n\t\t\t\tcase \"uxo\":\r\n\t\t\t\t\treturn `Uxo~üîä${device}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase \"remove\":\r\n\t\t\treturn \"REMOVE\";\r\n\t\tcase \"irSens\":\r\n\t\t\treturn \"IRSensÂàáÊõø\";\r\n\t}\r\n}\r\n\r\nexport function mergeBindings(bindings?: ButtonBindings): ButtonBindings {\r\n\treturn {\r\n\t\t...DEFAULT_BINDINGS,\r\n\t\t...(bindings ?? {}),\r\n\t};\r\n}\r\n\r\nexport function encodeAction(a: BindingAction): string {\r\n\treturn JSON.stringify(a);\r\n}\r\n\r\nexport function decodeAction(s: string): BindingAction {\r\n\treturn JSON.parse(s) as BindingAction;\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAyBO,MAAM,yBAAwC;IACpD,cAAc;AACf;AAEO,MAAM,mBAAmC;IAC/C,OAAO;QAAE,MAAM;IAAO;IACtB,MAAM;QAAE,MAAM;IAAO;IACrB,MAAM;QAAE,MAAM;QAAU,MAAM;IAAI;IAClC,OAAO;QAAE,MAAM;QAAU,MAAM;IAAI;IACnC,MAAM;QAAE,MAAM;QAAU,MAAM;IAAO;IACrC,KAAK;QAAE,MAAM;QAAY,MAAM;IAAO;IACtC,KAAK;QAAE,MAAM;QAAY,MAAM;IAAQ;AACxC;AAEO,SAAS,aAAa,CAAgB;IAC5C,OAAQ,EAAE,IAAI;QACb,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAQ,EAAE,IAAI;gBACb,KAAK;oBACJ,OAAO;gBACR,KAAK;oBACJ,OAAO;gBACR,KAAK;oBACJ,OAAO;YACT;QACD,KAAK;YACJ,OAAO,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE;QACvB,KAAK;YACJ,OAAO,EAAE,IAAI,KAAK,SAAS,OAAO;QACnC,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YAAS;gBACb,MAAM,SAAS,EAAE,YAAY,KAAK,QAAQ,UAAU;gBACpD,OAAQ,EAAE,IAAI;oBACb,KAAK;wBACJ,OAAO,CAAC,MAAM,EAAE,QAAQ;oBACzB,KAAK;wBACJ,OAAO,CAAC,OAAO,EAAE,QAAQ;oBAC1B,KAAK;wBACJ,OAAO,CAAC,MAAM,EAAE,QAAQ;gBAC1B;YACD;QACA,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;IACT;AACD;AAEO,SAAS,cAAc,QAAyB;IACtD,OAAO;QACN,GAAG,gBAAgB;QACnB,GAAI,YAAY,CAAC,CAAC;IACnB;AACD;AAEO,SAAS,aAAa,CAAgB;IAC5C,OAAO,KAAK,SAAS,CAAC;AACvB;AAEO,SAAS,aAAa,CAAS;IACrC,OAAO,KAAK,KAAK,CAAC;AACnB"}},
    {"offset": {"line": 529, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/projectBindingsStorage.ts"],"sourcesContent":["import type { ButtonBindings } from \"@/lib/buttonBindings\";\r\n\r\nfunction key(projectId: string) {\r\n    return `wiiSugeee:projectBindings:${projectId}`;\r\n}\r\n\r\nexport function loadProjectBindings(projectId: string): ButtonBindings | undefined {\r\n    try {\r\n        const raw = localStorage.getItem(key(projectId));\r\n        if (!raw) return undefined;\r\n        return JSON.parse(raw) as ButtonBindings;\r\n    } catch {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nexport function saveProjectBindings(projectId: string, bindings: ButtonBindings) {\r\n    try {\r\n        localStorage.setItem(key(projectId), JSON.stringify(bindings));\r\n    } catch {\r\n        // ignore\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA,SAAS,IAAI,SAAiB;IAC1B,OAAO,CAAC,0BAA0B,EAAE,WAAW;AACnD;AAEO,SAAS,oBAAoB,SAAiB;IACjD,IAAI;QACA,MAAM,MAAM,aAAa,OAAO,CAAC,IAAI;QACrC,IAAI,CAAC,KAAK,OAAO;QACjB,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,OAAO;IACX;AACJ;AAEO,SAAS,oBAAoB,SAAiB,EAAE,QAAwB;IAC3E,IAAI;QACA,aAAa,OAAO,CAAC,IAAI,YAAY,KAAK,SAAS,CAAC;IACxD,EAAE,OAAM;IACJ,SAAS;IACb;AACJ"}},
    {"offset": {"line": 561, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/currentProjectStore.ts"],"sourcesContent":["import type { SerializedFlow } from \"@/lib/presentation\";\r\nimport type { ButtonBindings, SoundSettings } from \"@/lib/buttonBindings\";\r\nimport { DEFAULT_SOUND_SETTINGS } from \"@/lib/buttonBindings\";\r\nimport { loadProjectBindings, saveProjectBindings } from \"@/lib/projectBindingsStorage\";\r\n\r\ntype Listener = () => void;\r\n\r\nlet currentFlow: SerializedFlow | null = null;\r\nlet currentProjectId = \"default\";\r\nconst listeners = new Set<Listener>();\r\n\r\nexport function setCurrentProjectId(projectId: string) {\r\n\tcurrentProjectId = projectId || \"default\";\r\n\tfor (const l of listeners) l();\r\n}\r\n\r\nexport function getCurrentProjectId() {\r\n\treturn currentProjectId;\r\n}\r\n\r\nexport function getCurrentFlow(): SerializedFlow | null {\r\n\treturn currentFlow;\r\n}\r\n\r\nexport function setCurrentFlow(flow: SerializedFlow | null) {\r\n\tif (flow) {\r\n\t\tconst stored = typeof window !== \"undefined\" ? loadProjectBindings(currentProjectId) : undefined;\r\n\t\tcurrentFlow = stored ? { ...flow, projectBindings: stored } : flow;\r\n\t} else {\r\n\t\tcurrentFlow = null;\r\n\t}\r\n\tfor (const l of listeners) l();\r\n}\r\n\r\nexport function subscribeCurrentFlow(listener: Listener) {\r\n\tlisteners.add(listener);\r\n\treturn () => listeners.delete(listener);\r\n}\r\n\r\nexport function getProjectBindings(): ButtonBindings | undefined {\r\n\tif (currentFlow?.projectBindings) {\r\n\t\treturn currentFlow.projectBindings;\r\n\t}\r\n\tif (typeof window === \"undefined\") return undefined;\r\n\treturn loadProjectBindings(currentProjectId);\r\n}\r\n\r\nexport function setProjectBindings(bindings: ButtonBindings) {\r\n\tif (currentFlow) {\r\n\t\tcurrentFlow = { ...currentFlow, projectBindings: bindings };\r\n\t}\r\n\r\n\tif (typeof window !== \"undefined\") {\r\n\t\tsaveProjectBindings(currentProjectId, bindings);\r\n\t}\r\n\r\n\tfor (const l of listeners) l();\r\n}\r\n\r\nconst SOUND_SETTINGS_KEY_PREFIX = \"wiiSugeee_soundSettings_\";\r\n\r\nexport function getSoundSettings(): SoundSettings {\r\n\tif (typeof window === \"undefined\") {\r\n\t\treturn { ...DEFAULT_SOUND_SETTINGS };\r\n\t}\r\n\r\n\tconst key = SOUND_SETTINGS_KEY_PREFIX + currentProjectId;\r\n\tconst stored = localStorage.getItem(key);\r\n\r\n\tif (!stored) {\r\n\t\treturn { ...DEFAULT_SOUND_SETTINGS };\r\n\t}\r\n\r\n\ttry {\r\n\t\treturn JSON.parse(stored) as SoundSettings;\r\n\t} catch {\r\n\t\treturn { ...DEFAULT_SOUND_SETTINGS };\r\n\t}\r\n}\r\n\r\nexport function setSoundSettings(settings: SoundSettings) {\r\n\tif (typeof window === \"undefined\") return;\r\n\r\n\tconst key = SOUND_SETTINGS_KEY_PREFIX + currentProjectId;\r\n\tlocalStorage.setItem(key, JSON.stringify(settings));\r\n\r\n\tfor (const l of listeners) l();\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAEA;AACA;;;AAIA,IAAI,cAAqC;AACzC,IAAI,mBAAmB;AACvB,MAAM,YAAY,IAAI;AAEf,SAAS,oBAAoB,SAAiB;IACpD,mBAAmB,aAAa;IAChC,KAAK,MAAM,KAAK,UAAW;AAC5B;AAEO,SAAS;IACf,OAAO;AACR;AAEO,SAAS;IACf,OAAO;AACR;AAEO,SAAS,eAAe,IAA2B;IACzD,IAAI,MAAM;QACT,MAAM,SAAS,uCAAgC,IAAA,kMAAmB,EAAC,oBAAoB;QACvF,cAAc,SAAS;YAAE,GAAG,IAAI;YAAE,iBAAiB;QAAO,IAAI;IAC/D,OAAO;QACN,cAAc;IACf;IACA,KAAK,MAAM,KAAK,UAAW;AAC5B;AAEO,SAAS,qBAAqB,QAAkB;IACtD,UAAU,GAAG,CAAC;IACd,OAAO,IAAM,UAAU,MAAM,CAAC;AAC/B;AAEO,SAAS;IACf,IAAI,aAAa,iBAAiB;QACjC,OAAO,YAAY,eAAe;IACnC;IACA;;IACA,OAAO,IAAA,kMAAmB,EAAC;AAC5B;AAEO,SAAS,mBAAmB,QAAwB;IAC1D,IAAI,aAAa;QAChB,cAAc;YAAE,GAAG,WAAW;YAAE,iBAAiB;QAAS;IAC3D;IAEA,wCAAmC;QAClC,IAAA,kMAAmB,EAAC,kBAAkB;IACvC;IAEA,KAAK,MAAM,KAAK,UAAW;AAC5B;AAEA,MAAM,4BAA4B;AAE3B,SAAS;IACf;;IAIA,MAAM,MAAM,4BAA4B;IACxC,MAAM,SAAS,aAAa,OAAO,CAAC;IAEpC,IAAI,CAAC,QAAQ;QACZ,OAAO;YAAE,GAAG,6LAAsB;QAAC;IACpC;IAEA,IAAI;QACH,OAAO,KAAK,KAAK,CAAC;IACnB,EAAE,OAAM;QACP,OAAO;YAAE,GAAG,6LAAsB;QAAC;IACpC;AACD;AAEO,SAAS,iBAAiB,QAAuB;IACvD;;IAEA,MAAM,MAAM,4BAA4B;IACxC,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;IAEzC,KAAK,MAAM,KAAK,UAAW;AAC5B"}},
    {"offset": {"line": 667, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/usePresentation.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useMemo, useRef, useState, useEffect } from \"react\";\nimport { loadFromLocalStorage, type SerializedFlow } from \"@/lib/presentation\";\nimport { getProjectBindings } from \"@/lib/currentProjectStore\";\n\ninterface UsePresentationOptions {\n\twiiConnected: boolean;\n}\n\nexport function usePresentation({ wiiConnected }: UsePresentationOptions) {\n\tconst [flow, setFlow] = useState<SerializedFlow | null>(null);\n\tconst [error, setError] = useState<string | null>(null);\n\tconst [currentNodeId, setCurrentNodeId] = useState<string | null>(null);\n\tconst [startedWithWii, setStartedWithWii] = useState(false);\n\tconst [playingSince, setPlayingSince] = useState<number>(0);\n\tconst lastNavTime = useRef<number>(0);\n\n\tconst isPlaying = flow != null && currentNodeId != null;\n\n\tconst currentNode = useMemo(\n\t\t() => flow?.nodes.find((n) => n.id === currentNodeId),\n\t\t[flow, currentNodeId]\n\t);\n\n\tconst outgoingEdges = useMemo(() => {\n\t\tif (!flow || !currentNodeId) return [];\n\t\treturn flow.edges.filter((e) => e.source === currentNodeId);\n\t}, [flow, currentNodeId]);\n\n\tconst hasMultipleBranches = outgoingEdges.length >= 2;\n\n\tconst branchOptions = useMemo(() => {\n\t\tconst options: Array<{ key: string; target: string }> = [];\n\t\tconst used = new Set<string>();\n\n\t\tfor (const edge of outgoingEdges) {\n\t\t\tconst label = (edge.label ?? \"\").trim();\n\t\t\tconst m = label.match(/^([1-9])(?:\\b|\\s|:|-)/);\n\t\t\tif (m && !used.has(m[1])) {\n\t\t\t\toptions.push({ key: m[1], target: edge.target });\n\t\t\t\tused.add(m[1]);\n\t\t\t}\n\t\t}\n\n\t\tfor (const edge of outgoingEdges) {\n\t\t\tif (options.length >= 9) break;\n\t\t\tconst nextKey = String(options.length + 1);\n\t\t\tif (used.has(nextKey)) continue;\n\t\t\toptions.push({ key: nextKey, target: edge.target });\n\t\t\tused.add(nextKey);\n\t\t}\n\n\t\treturn options;\n\t}, [outgoingEdges]);\n\n\tconst navigateTo = useCallback(\n\t\t(nodeId: string, onNavigate?: () => void) => {\n\t\t\tconst now = Date.now();\n\t\t\tif (now - lastNavTime.current < 500) return;\n\t\t\tlastNavTime.current = now;\n\t\t\tsetCurrentNodeId(nodeId);\n\t\t\tonNavigate?.();\n\t\t},\n\t\t[]\n\t);\n\n\tconst nextSlide = useCallback(\n\t\t(onNavigate?: () => void) => {\n\t\t\tif (!flow || !currentNodeId) return;\n\t\t\tconst edges = flow.edges.filter((e) => e.source === currentNodeId);\n\t\t\tif (edges.length >= 2 || edges.length === 0) return;\n\n\t\t\tconst targetEdge =\n\t\t\t\tedges.find((e) => !e.label || e.label.trim() === \"\") ||\n\t\t\t\tedges.find((e) => e.label === \"next\") ||\n\t\t\t\tedges[0];\n\n\t\t\tif (targetEdge) navigateTo(targetEdge.target, onNavigate);\n\t\t},\n\t\t[flow, currentNodeId, navigateTo]\n\t);\n\n\tconst prevSlide = useCallback(\n\t\t(onNavigate?: () => void) => {\n\t\t\tif (!flow || !currentNodeId) return;\n\t\t\tconst edge = flow.edges.find((e) => e.target === currentNodeId);\n\t\t\tif (edge) navigateTo(edge.source, onNavigate);\n\t\t},\n\t\t[flow, currentNodeId, navigateTo]\n\t);\n\n\tconst branchByNumberKey = useCallback(\n\t\t(key: string, onNavigate?: () => void) => {\n\t\t\tif (!hasMultipleBranches) return;\n\t\t\tconst opt = branchOptions.find((o) => o.key === key);\n\t\t\tif (opt) navigateTo(opt.target, onNavigate);\n\t\t},\n\t\t[branchOptions, hasMultipleBranches, navigateTo]\n\t);\n\n\tuseEffect(() => {\n\t\tconst loaded = loadFromLocalStorage();\n\t\tif (!loaded || loaded.nodes.length === 0) {\n\t\t\tsetError(\"„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇEditor„Åß‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\");\n\t\t\tsetFlow(null);\n\t\t\tsetCurrentNodeId(null);\n\t\t\treturn;\n\t\t}\n\n\t\tconst storedBindings = getProjectBindings();\n\t\tconst flowWithBindings = storedBindings ? { ...loaded, projectBindings: storedBindings } : loaded;\n\n\t\tsetError(null);\n\t\tsetFlow(flowWithBindings);\n\n\t\tconst startNode = loaded.nodes.find((n) => n.data.label === \"Start\") || loaded.nodes[0];\n\t\tsetCurrentNodeId(startNode.id);\n\t\tsetStartedWithWii(!!wiiConnected);\n\t\tsetPlayingSince(Date.now());\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (wiiConnected) setStartedWithWii(true);\n\t}, [wiiConnected]);\n\n\treturn {\n\t\tflow,\n\t\terror,\n\t\tisPlaying,\n\t\tcurrentNode,\n\t\tcurrentNodeId,\n\t\tstartedWithWii,\n\t\tplayingSince,\n\t\toutgoingEdges,\n\t\thasMultipleBranches,\n\t\tbranchOptions,\n\t\tnextSlide,\n\t\tprevSlide,\n\t\tbranchByNumberKey,\n\t\tnavigateTo,\n\t};\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAUO,SAAS,gBAAgB,EAAE,YAAY,EAA0B;;IACvE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6MAAQ,EAAwB;IACxD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6MAAQ,EAAgB;IAClD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6MAAQ,EAAgB;IAClE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,6MAAQ,EAAC;IACrD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6MAAQ,EAAS;IACzD,MAAM,cAAc,IAAA,2MAAM,EAAS;IAEnC,MAAM,YAAY,QAAQ,QAAQ,iBAAiB;IAEnD,MAAM,cAAc,IAAA,4MAAO;gDAC1B,IAAM,MAAM,MAAM;wDAAK,CAAC,IAAM,EAAE,EAAE,KAAK;;+CACvC;QAAC;QAAM;KAAc;IAGtB,MAAM,gBAAgB,IAAA,4MAAO;kDAAC;YAC7B,IAAI,CAAC,QAAQ,CAAC,eAAe,OAAO,EAAE;YACtC,OAAO,KAAK,KAAK,CAAC,MAAM;0DAAC,CAAC,IAAM,EAAE,MAAM,KAAK;;QAC9C;iDAAG;QAAC;QAAM;KAAc;IAExB,MAAM,sBAAsB,cAAc,MAAM,IAAI;IAEpD,MAAM,gBAAgB,IAAA,4MAAO;kDAAC;YAC7B,MAAM,UAAkD,EAAE;YAC1D,MAAM,OAAO,IAAI;YAEjB,KAAK,MAAM,QAAQ,cAAe;gBACjC,MAAM,QAAQ,CAAC,KAAK,KAAK,IAAI,EAAE,EAAE,IAAI;gBACrC,MAAM,IAAI,MAAM,KAAK,CAAC;gBACtB,IAAI,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG;oBACzB,QAAQ,IAAI,CAAC;wBAAE,KAAK,CAAC,CAAC,EAAE;wBAAE,QAAQ,KAAK,MAAM;oBAAC;oBAC9C,KAAK,GAAG,CAAC,CAAC,CAAC,EAAE;gBACd;YACD;YAEA,KAAK,MAAM,QAAQ,cAAe;gBACjC,IAAI,QAAQ,MAAM,IAAI,GAAG;gBACzB,MAAM,UAAU,OAAO,QAAQ,MAAM,GAAG;gBACxC,IAAI,KAAK,GAAG,CAAC,UAAU;gBACvB,QAAQ,IAAI,CAAC;oBAAE,KAAK;oBAAS,QAAQ,KAAK,MAAM;gBAAC;gBACjD,KAAK,GAAG,CAAC;YACV;YAEA,OAAO;QACR;iDAAG;QAAC;KAAc;IAElB,MAAM,aAAa,IAAA,gNAAW;mDAC7B,CAAC,QAAgB;YAChB,MAAM,MAAM,KAAK,GAAG;YACpB,IAAI,MAAM,YAAY,OAAO,GAAG,KAAK;YACrC,YAAY,OAAO,GAAG;YACtB,iBAAiB;YACjB;QACD;kDACA,EAAE;IAGH,MAAM,YAAY,IAAA,gNAAW;kDAC5B,CAAC;YACA,IAAI,CAAC,QAAQ,CAAC,eAAe;YAC7B,MAAM,QAAQ,KAAK,KAAK,CAAC,MAAM;gEAAC,CAAC,IAAM,EAAE,MAAM,KAAK;;YACpD,IAAI,MAAM,MAAM,IAAI,KAAK,MAAM,MAAM,KAAK,GAAG;YAE7C,MAAM,aACL,MAAM,IAAI;0DAAC,CAAC,IAAM,CAAC,EAAE,KAAK,IAAI,EAAE,KAAK,CAAC,IAAI,OAAO;4DACjD,MAAM,IAAI;0DAAC,CAAC,IAAM,EAAE,KAAK,KAAK;4DAC9B,KAAK,CAAC,EAAE;YAET,IAAI,YAAY,WAAW,WAAW,MAAM,EAAE;QAC/C;iDACA;QAAC;QAAM;QAAe;KAAW;IAGlC,MAAM,YAAY,IAAA,gNAAW;kDAC5B,CAAC;YACA,IAAI,CAAC,QAAQ,CAAC,eAAe;YAC7B,MAAM,OAAO,KAAK,KAAK,CAAC,IAAI;+DAAC,CAAC,IAAM,EAAE,MAAM,KAAK;;YACjD,IAAI,MAAM,WAAW,KAAK,MAAM,EAAE;QACnC;iDACA;QAAC;QAAM;QAAe;KAAW;IAGlC,MAAM,oBAAoB,IAAA,gNAAW;0DACpC,CAAC,KAAa;YACb,IAAI,CAAC,qBAAqB;YAC1B,MAAM,MAAM,cAAc,IAAI;sEAAC,CAAC,IAAM,EAAE,GAAG,KAAK;;YAChD,IAAI,KAAK,WAAW,IAAI,MAAM,EAAE;QACjC;yDACA;QAAC;QAAe;QAAqB;KAAW;IAGjD,IAAA,8MAAS;qCAAC;YACT,MAAM,SAAS,IAAA,yLAAoB;YACnC,IAAI,CAAC,UAAU,OAAO,KAAK,CAAC,MAAM,KAAK,GAAG;gBACzC,SAAS;gBACT,QAAQ;gBACR,iBAAiB;gBACjB;YACD;YAEA,MAAM,iBAAiB,IAAA,8LAAkB;YACzC,MAAM,mBAAmB,iBAAiB;gBAAE,GAAG,MAAM;gBAAE,iBAAiB;YAAe,IAAI;YAE3F,SAAS;YACT,QAAQ;YAER,MAAM,YAAY,OAAO,KAAK,CAAC,IAAI;6CAAC,CAAC,IAAM,EAAE,IAAI,CAAC,KAAK,KAAK;+CAAY,OAAO,KAAK,CAAC,EAAE;YACvF,iBAAiB,UAAU,EAAE;YAC7B,kBAAkB,CAAC,CAAC;YACpB,gBAAgB,KAAK,GAAG;QACzB;oCAAG,EAAE;IAEL,IAAA,8MAAS;qCAAC;YACT,IAAI,cAAc,kBAAkB;QACrC;oCAAG;QAAC;KAAa;IAEjB,OAAO;QACN;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACD;AACD;GApIgB"}},
    {"offset": {"line": 848, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/useDrawing.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useRef, useState } from \"react\";\nimport type { DrawingPoint, Position } from \"@/types\";\n\nexport function useDrawing() {\n\tconst [drawingPoints, setDrawingPoints] = useState<DrawingPoint[]>([]);\n\tconst [eraserMode, setEraserMode] = useState(false);\n\tconst [eraserButtonName, setEraserButtonName] = useState<string | null>(null);\n\tconst [cursorPos, setCursorPos] = useState<Position | null>(null);\n\tconst [isPainting, setIsPainting] = useState(false);\n\tconst isMouseDrawingRef = useRef(false);\n\tconst wasWiiADownRef = useRef(false);\n\n\tconst clearDrawing = useCallback(() => {\n\t\tsetDrawingPoints([]);\n\t\tisMouseDrawingRef.current = false;\n\t\twasWiiADownRef.current = false;\n\t}, []);\n\n\tconst addSeparator = useCallback(() => {\n\t\tsetDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n\t}, []);\n\n\tconst addPoint = useCallback((point: { x: number; y: number; mode?: \"draw\" | \"erase\" }) => {\n\t\tsetDrawingPoints((prev) => [...prev, point]);\n\t}, []);\n\n\tconst toggleEraserMode = useCallback((buttonName?: string) => {\n\t\tsetEraserMode((prev) => {\n\t\t\tconst next = !prev;\n\t\t\tif (next) {\n\t\t\t\tsetEraserButtonName(buttonName || \"X\");\n\t\t\t\tsetCursorPos({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n\t\t\t} else {\n\t\t\t\tsetEraserButtonName(null);\n\t\t\t\tsetCursorPos(null);\n\t\t\t}\n\t\t\treturn next;\n\t\t});\n\t}, []);\n\n\tconst startMouseDrawing = useCallback(\n\t\t(x: number, y: number) => {\n\t\t\tisMouseDrawingRef.current = true;\n\t\t\tif (eraserMode) {\n\t\t\t\tsetIsPainting(false);\n\t\t\t\tsetDrawingPoints((prev) => {\n\t\t\t\t\tconst next = prev.slice();\n\t\t\t\t\tif (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n\t\t\t\t\tnext.push({ x, y, mode: \"erase\" });\n\t\t\t\t\treturn next;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsetIsPainting(true);\n\t\t\t\tsetDrawingPoints((prev) => {\n\t\t\t\t\tconst next = prev.slice();\n\t\t\t\t\tif (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n\t\t\t\t\tnext.push({ x, y, mode: \"draw\" });\n\t\t\t\t\treturn next;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t[eraserMode]\n\t);\n\n\tconst continueMouseDrawing = useCallback(\n\t\t(x: number, y: number) => {\n\t\t\tif (!isMouseDrawingRef.current) return;\n\t\t\tconst mode = eraserMode ? \"erase\" : \"draw\";\n\t\t\tsetDrawingPoints((prev) => {\n\t\t\t\tconst last = prev[prev.length - 1];\n\t\t\t\tif (last && Math.abs(last.x - x) + Math.abs(last.y - y) < 2) return prev;\n\t\t\t\treturn [...prev, { x, y, mode }];\n\t\t\t});\n\t\t},\n\t\t[eraserMode]\n\t);\n\n\tconst endMouseDrawing = useCallback(() => {\n\t\tif (!isMouseDrawingRef.current) return;\n\t\tisMouseDrawingRef.current = false;\n\t\tsetIsPainting(false);\n\t\taddSeparator();\n\t}, [addSeparator]);\n\n\tconst startWiiDrawing = useCallback((pos: Position, mode: \"draw\" | \"erase\") => {\n\t\tsetDrawingPoints((prev) => {\n\t\t\tconst next = prev.slice();\n\t\t\tif (!wasWiiADownRef.current && next.length > 0 && next[next.length - 1] !== null) {\n\t\t\t\tnext.push(null);\n\t\t\t}\n\t\t\tnext.push({ ...pos, mode });\n\t\t\treturn next;\n\t\t});\n\t\twasWiiADownRef.current = true;\n\t}, []);\n\n\tconst endWiiDrawing = useCallback(() => {\n\t\tif (wasWiiADownRef.current) {\n\t\t\twasWiiADownRef.current = false;\n\t\t\taddSeparator();\n\t\t}\n\t}, [addSeparator]);\n\n\treturn {\n\t\tdrawingPoints,\n\t\tsetDrawingPoints,\n\t\teraserMode,\n\t\tsetEraserMode,\n\t\teraserButtonName,\n\t\tcursorPos,\n\t\tsetCursorPos,\n\t\tisPainting,\n\t\tsetIsPainting,\n\t\tisMouseDrawingRef,\n\t\twasWiiADownRef,\n\t\tclearDrawing,\n\t\taddSeparator,\n\t\taddPoint,\n\t\ttoggleEraserMode,\n\t\tstartMouseDrawing,\n\t\tcontinueMouseDrawing,\n\t\tendMouseDrawing,\n\t\tstartWiiDrawing,\n\t\tendWiiDrawing,\n\t};\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1039, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/useAudio.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useRef, useEffect, useState } from \"react\";\n\nconst SOUND_URLS = {\n\tq: \"https://www.myinstants.com/media/sounds/nice-shot-wii-sports_DJJ0VOz.mp3\",\n\tw: \"https://www.myinstants.com/media/sounds/crowdaw.mp3\",\n\te: \"https://www.myinstants.com/media/sounds/crowdoh.mp3\",\n} as const;\n\ntype SoundKey = keyof typeof SOUND_URLS;\n\nexport function useAudio(playWiiSound: (soundType: \"shot\" | \"oh\" | \"uxo\") => void) {\n\tconst soundboardRef = useRef<Record<SoundKey, HTMLAudioElement | undefined>>({\n\t\tq: undefined,\n\t\tw: undefined,\n\t\te: undefined,\n\t});\n\tconst audioUnlockedRef = useRef(false);\n\tconst pendingSoundRef = useRef<SoundKey | null>(null);\n\n\tconst tryUnlockAudio = useCallback(async () => {\n\t\tif (audioUnlockedRef.current) return;\n\n\t\tconst audios = Object.values(soundboardRef.current).filter(Boolean) as HTMLAudioElement[];\n\t\tif (audios.length === 0) return;\n\n\t\ttry {\n\t\t\tconst a = audios[0];\n\t\t\tconst prevMuted = a.muted;\n\t\t\tconst prevVolume = a.volume;\n\t\t\ta.muted = true;\n\t\t\ta.volume = 0;\n\t\t\tawait a.play();\n\t\t\ta.pause();\n\t\t\ta.currentTime = 0;\n\t\t\ta.muted = prevMuted;\n\t\t\ta.volume = prevVolume;\n\t\t\taudioUnlockedRef.current = true;\n\n\t\t\tconst pending = pendingSoundRef.current;\n\t\t\tpendingSoundRef.current = null;\n\t\t\tif (pending && soundboardRef.current[pending]) {\n\t\t\t\tsoundboardRef.current[pending]!.currentTime = 0;\n\t\t\t\tvoid soundboardRef.current[pending]!.play().catch(() => {});\n\t\t\t}\n\t\t} catch {\n\t\t\t// Ignore unlock failure\n\t\t}\n\t}, []);\n\n\tconst playSoundOnPC = useCallback(\n\t\tasync (key: SoundKey) => {\n\t\t\tconst a = soundboardRef.current[key];\n\t\t\tif (!a) return;\n\n\t\t\tif (!audioUnlockedRef.current) {\n\t\t\t\tpendingSoundRef.current = key;\n\t\t\t\tawait tryUnlockAudio();\n\t\t\t\tif (!audioUnlockedRef.current) return;\n\t\t\t}\n\n\t\t\ta.currentTime = 0;\n\t\t\tvoid a.play().catch(() => {\n\t\t\t\tpendingSoundRef.current = key;\n\t\t\t});\n\t\t},\n\t\t[tryUnlockAudio]\n\t);\n\n\tconst playSoundOnWii = useCallback(\n\t\t(key: SoundKey) => {\n\t\t\tconst mapping: Record<SoundKey, \"shot\" | \"oh\" | \"uxo\"> = { q: \"shot\", e: \"oh\", w: \"uxo\" };\n\t\t\tplayWiiSound(mapping[key]);\n\t\t},\n\t\t[playWiiSound]\n\t);\n\n\tconst playSound = useCallback(\n\t\t(key: SoundKey, outputDevice: \"pc\" | \"wii\" = \"pc\") => {\n\t\t\tif (outputDevice === \"wii\") {\n\t\t\t\tplaySoundOnWii(key);\n\t\t\t} else {\n\t\t\t\tplaySoundOnPC(key);\n\t\t\t}\n\t\t},\n\t\t[playSoundOnPC, playSoundOnWii]\n\t);\n\n\tuseEffect(() => {\n\t\tconst q = new Audio(SOUND_URLS.q);\n\t\tconst w = new Audio(SOUND_URLS.w);\n\t\tconst e = new Audio(SOUND_URLS.e);\n\t\tq.preload = \"auto\";\n\t\tw.preload = \"auto\";\n\t\te.preload = \"auto\";\n\t\tsoundboardRef.current = { q, w, e };\n\n\t\tconst unlockOnInteraction = () => {\n\t\t\tif (audioUnlockedRef.current) return;\n\t\t\tvoid tryUnlockAudio();\n\t\t};\n\n\t\twindow.addEventListener(\"click\", unlockOnInteraction);\n\t\twindow.addEventListener(\"touchstart\", unlockOnInteraction);\n\t\twindow.addEventListener(\"keydown\", unlockOnInteraction);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener(\"click\", unlockOnInteraction);\n\t\t\twindow.removeEventListener(\"touchstart\", unlockOnInteraction);\n\t\t\twindow.removeEventListener(\"keydown\", unlockOnInteraction);\n\t\t\tfor (const a of [q, w, e]) {\n\t\t\t\ttry {\n\t\t\t\t\ta.pause();\n\t\t\t\t} catch {\n\t\t\t\t\t// Ignore\n\t\t\t\t}\n\t\t\t}\n\t\t\tsoundboardRef.current = { q: undefined, w: undefined, e: undefined };\n\t\t};\n\t}, [tryUnlockAudio]);\n\n\treturn { playSound };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1195, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/useBindings.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useRef, useMemo } from \"react\";\nimport { mergeBindings, type BindingAction, type ButtonBindings } from \"@/lib/buttonBindings\";\nimport type { WiiState } from \"@/hooks/useWiiController\";\nimport type { SerializedFlow } from \"@/types\";\n\ninterface UseBindingsOptions {\n\tflow: SerializedFlow | null;\n\tcurrentNode: SerializedFlow[\"nodes\"][number] | undefined;\n}\n\ninterface ActionCallbacks {\n\tnextSlide: () => void;\n\tprevSlide: () => void;\n\tbranchByNumberKey: (key: string) => void;\n\thasMultipleBranches: boolean;\n\ttoggleEraser: (buttonName?: string) => void;\n\ttoggleIrCursor: () => void;\n\tclearDrawing: () => void;\n\tplaySound: (key: \"q\" | \"w\" | \"e\", outputDevice?: \"pc\" | \"wii\") => void;\n\teraserMode: boolean;\n\tirCursorEnabled: boolean;\n}\n\nexport function useBindings({ flow, currentNode }: UseBindingsOptions) {\n\tconst lastEraserToggleTimeRef = useRef<number>(0);\n\tconst lastIrSensToggleTimeRef = useRef<number>(0);\n\n\tconst effectiveProjectBindings = useMemo(() => {\n\t\tconst combined = {\n\t\t\t...(flow?.projectBindings ?? {}),\n\t\t\t...(currentNode?.data.bindings ?? {}),\n\t\t};\n\t\treturn mergeBindings(combined);\n\t}, [flow, currentNode]);\n\n\tconst runAction = useCallback(\n\t\t(act: BindingAction, callbacks: ActionCallbacks, btnName?: string) => {\n\t\t\tconst {\n\t\t\t\tnextSlide,\n\t\t\t\tprevSlide,\n\t\t\t\tbranchByNumberKey,\n\t\t\t\thasMultipleBranches,\n\t\t\t\ttoggleEraser,\n\t\t\t\ttoggleIrCursor,\n\t\t\t\tclearDrawing,\n\t\t\t\tplaySound,\n\t\t\t\teraserMode,\n\t\t\t\tirCursorEnabled,\n\t\t\t} = callbacks;\n\n\t\t\tif (eraserMode && act.type !== \"eraser\") return;\n\n\t\t\tswitch (act.type) {\n\t\t\t\tcase \"next\":\n\t\t\t\t\tnextSlide();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"prev\":\n\t\t\t\t\tprevSlide();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"branchIndex\":\n\t\t\t\t\tbranchByNumberKey(String(act.index));\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"branch\": {\n\t\t\t\t\tif (!hasMultipleBranches) return;\n\t\t\t\t\tconst map: Record<string, string> = { A: \"1\", B: \"2\", HOME: \"3\" };\n\t\t\t\t\tconst k = map[act.kind];\n\t\t\t\t\tif (k) branchByNumberKey(k);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"reaction\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"paint\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"eraser\": {\n\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\tif (now - lastEraserToggleTimeRef.current < 500) return;\n\t\t\t\t\tlastEraserToggleTimeRef.current = now;\n\t\t\t\t\ttoggleEraser(btnName);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"sound\":\n\t\t\t\t\tif (act.kind === \"shot\") playSound(\"q\", act.outputDevice);\n\t\t\t\t\telse if (act.kind === \"oh\") playSound(\"e\", act.outputDevice);\n\t\t\t\t\telse if (act.kind === \"uxo\") playSound(\"w\", act.outputDevice);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"remove\":\n\t\t\t\t\tclearDrawing();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"irSens\": {\n\t\t\t\t\tconst now = Date.now();\n\t\t\t\t\tif (now - lastIrSensToggleTimeRef.current < 500) return;\n\t\t\t\t\tlastIrSensToggleTimeRef.current = now;\n\t\t\t\t\ttoggleIrCursor();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"none\":\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\t[]\n\t);\n\n\tconst checkShouldEmitReaction = useCallback(\n\t\t(\n\t\t\tpressed: Partial<WiiState[\"buttons\"]>,\n\t\t\tkind: \"clap\" | \"laugh\"\n\t\t): boolean => {\n\t\t\tfor (const btn of Object.keys(pressed)) {\n\t\t\t\tconst isDown = (pressed as Record<string, boolean>)[btn];\n\t\t\t\tif (!isDown) continue;\n\t\t\t\tconst act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n\t\t\t\tif (act?.type === \"reaction\" && act.kind === kind) return true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t[effectiveProjectBindings]\n\t);\n\n\tconst checkIsPaintPressed = useCallback(\n\t\t(buttons: WiiState[\"buttons\"]): boolean => {\n\t\t\tfor (const btn of Object.keys(buttons)) {\n\t\t\t\tconst isDown = (buttons as Record<string, boolean>)[btn];\n\t\t\t\tif (!isDown) continue;\n\t\t\t\tconst act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n\t\t\t\tif (act?.type === \"paint\") return true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t[effectiveProjectBindings]\n\t);\n\n\treturn {\n\t\teffectiveProjectBindings,\n\t\trunAction,\n\t\tcheckShouldEmitReaction,\n\t\tcheckIsPaintPressed,\n\t};\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAyBO,SAAS,YAAY,EAAE,IAAI,EAAE,WAAW,EAAsB;;IACpE,MAAM,0BAA0B,IAAA,2MAAM,EAAS;IAC/C,MAAM,0BAA0B,IAAA,2MAAM,EAAS;IAE/C,MAAM,2BAA2B,IAAA,4MAAO;yDAAC;YACxC,MAAM,WAAW;gBAChB,GAAI,MAAM,mBAAmB,CAAC,CAAC;gBAC/B,GAAI,aAAa,KAAK,YAAY,CAAC,CAAC;YACrC;YACA,OAAO,IAAA,oLAAa,EAAC;QACtB;wDAAG;QAAC;QAAM;KAAY;IAEtB,MAAM,YAAY,IAAA,gNAAW;8CAC5B,CAAC,KAAoB,WAA4B;YAChD,MAAM,EACL,SAAS,EACT,SAAS,EACT,iBAAiB,EACjB,mBAAmB,EACnB,YAAY,EACZ,cAAc,EACd,YAAY,EACZ,SAAS,EACT,UAAU,EACV,eAAe,EACf,GAAG;YAEJ,IAAI,cAAc,IAAI,IAAI,KAAK,UAAU;YAEzC,OAAQ,IAAI,IAAI;gBACf,KAAK;oBACJ;oBACA;gBACD,KAAK;oBACJ;oBACA;gBACD,KAAK;oBACJ,kBAAkB,OAAO,IAAI,KAAK;oBAClC;gBACD,KAAK;oBAAU;wBACd,IAAI,CAAC,qBAAqB;wBAC1B,MAAM,MAA8B;4BAAE,GAAG;4BAAK,GAAG;4BAAK,MAAM;wBAAI;wBAChE,MAAM,IAAI,GAAG,CAAC,IAAI,IAAI,CAAC;wBACvB,IAAI,GAAG,kBAAkB;wBACzB;oBACD;gBACA,KAAK;oBACJ;gBACD,KAAK;oBACJ;gBACD,KAAK;oBAAU;wBACd,MAAM,MAAM,KAAK,GAAG;wBACpB,IAAI,MAAM,wBAAwB,OAAO,GAAG,KAAK;wBACjD,wBAAwB,OAAO,GAAG;wBAClC,aAAa;wBACb;oBACD;gBACA,KAAK;oBACJ,IAAI,IAAI,IAAI,KAAK,QAAQ,UAAU,KAAK,IAAI,YAAY;yBACnD,IAAI,IAAI,IAAI,KAAK,MAAM,UAAU,KAAK,IAAI,YAAY;yBACtD,IAAI,IAAI,IAAI,KAAK,OAAO,UAAU,KAAK,IAAI,YAAY;oBAC5D;gBACD,KAAK;oBACJ;oBACA;gBACD,KAAK;oBAAU;wBACd,MAAM,MAAM,KAAK,GAAG;wBACpB,IAAI,MAAM,wBAAwB,OAAO,GAAG,KAAK;wBACjD,wBAAwB,OAAO,GAAG;wBAClC;wBACA;oBACD;gBACA,KAAK;gBACL;oBACC;YACF;QACD;6CACA,EAAE;IAGH,MAAM,0BAA0B,IAAA,gNAAW;4DAC1C,CACC,SACA;YAEA,KAAK,MAAM,OAAO,OAAO,IAAI,CAAC,SAAU;gBACvC,MAAM,SAAS,AAAC,OAAmC,CAAC,IAAI;gBACxD,IAAI,CAAC,QAAQ;gBACb,MAAM,MAAM,AAAC,wBAAsE,CAAC,IAAI;gBACxF,IAAI,KAAK,SAAS,cAAc,IAAI,IAAI,KAAK,MAAM,OAAO;YAC3D;YACA,OAAO;QACR;2DACA;QAAC;KAAyB;IAG3B,MAAM,sBAAsB,IAAA,gNAAW;wDACtC,CAAC;YACA,KAAK,MAAM,OAAO,OAAO,IAAI,CAAC,SAAU;gBACvC,MAAM,SAAS,AAAC,OAAmC,CAAC,IAAI;gBACxD,IAAI,CAAC,QAAQ;gBACb,MAAM,MAAM,AAAC,wBAAsE,CAAC,IAAI;gBACxF,IAAI,KAAK,SAAS,SAAS,OAAO;YACnC;YACA,OAAO;QACR;uDACA;QAAC;KAAyB;IAG3B,OAAO;QACN;QACA;QACA;QACA;IACD;AACD;GAnHgB"}},
    {"offset": {"line": 1328, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/WiiDebugPanel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\nimport type { BindingAction, ButtonBindings } from \"@/lib/buttonBindings\";\r\nimport { formatAction } from \"@/lib/buttonBindings\";\r\n\r\ninterface WiiDebugPanelProps {\r\n\twiiState: WiiState | null;\r\n\tpressed: Record<string, boolean>;\r\n\teffectiveProjectBindings: ButtonBindings;\r\n\tirCursorEnabled?: boolean;\r\n\tonToggleIrCursor?: () => void;\r\n}\r\n\r\nconst BUTTON_ORDER = [\"Up\", \"Down\", \"Right\", \"Left\", \"A\", \"B\", \"Minus\", \"Home\", \"Plus\", \"One\", \"Two\"];\r\nconst ACCEL_UPDATE_INTERVAL = 200;\r\n\r\nexport function WiiDebugPanel({\r\n\twiiState,\r\n\tpressed,\r\n\teffectiveProjectBindings,\r\n\tirCursorEnabled,\r\n\tonToggleIrCursor,\r\n}: WiiDebugPanelProps) {\r\n\tconst [displayAccel, setDisplayAccel] = useState({ x: 0, y: 0, z: 0 });\r\n\tconst displayIrCountRef = useRef(0);\r\n\tconst displayButtonsRef = useRef(\"(none)\");\r\n\tconst displayBindingsRef = useRef<string[]>([]);\r\n\tconst lastAccelUpdateRef = useRef(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!wiiState?.accel) return;\r\n\r\n\t\tconst now = Date.now();\r\n\t\tif (now - lastAccelUpdateRef.current < ACCEL_UPDATE_INTERVAL) return;\r\n\r\n\t\tconst { x, y, z } = wiiState.accel;\r\n\t\tif (x === 0 && y === 0 && z === 0) return;\r\n\r\n\t\tsetDisplayAccel((prev) => {\r\n\t\t\tif (x !== prev.x || y !== prev.y || z !== prev.z) {\r\n\t\t\t\tlastAccelUpdateRef.current = now;\r\n\t\t\t\treturn { x, y, z };\r\n\t\t\t}\r\n\t\t\treturn prev;\r\n\t\t});\r\n\t}, [wiiState]);\r\n\r\n\tif (wiiState?.ir) {\r\n\t\tconst currentCount = wiiState.ir.length;\r\n\t\tif (currentCount !== displayIrCountRef.current) {\r\n\t\t\tdisplayIrCountRef.current = currentCount;\r\n\t\t}\r\n\t}\r\n\r\n\tconst pressedButtons = Object.entries(pressed)\r\n\t\t.filter(([, isDown]) => isDown)\r\n\t\t.map(([btn]) => btn);\r\n\tif (pressedButtons.length > 0) {\r\n\t\tdisplayButtonsRef.current = pressedButtons.join(\", \");\r\n\t}\r\n\r\n\tconst entries = Object.entries(effectiveProjectBindings) as Array<[string, BindingAction | undefined]>;\r\n\tentries.sort((a, b) => {\r\n\t\tconst indexA = BUTTON_ORDER.indexOf(a[0]);\r\n\t\tconst indexB = BUTTON_ORDER.indexOf(b[0]);\r\n\t\tif (indexA !== -1 && indexB !== -1) return indexA - indexB;\r\n\t\tif (indexA !== -1) return -1;\r\n\t\tif (indexB !== -1) return 1;\r\n\t\treturn a[0].localeCompare(b[0]);\r\n\t});\r\n\r\n\tconst currentBindings = entries.map(\r\n\t\t([btn, action]) => `${btn.padEnd(8)} ‚Üí ${action ? formatAction(action) : \"(unassigned)\"}`\r\n\t);\r\n\r\n\tif (\r\n\t\tcurrentBindings.length !== displayBindingsRef.current.length ||\r\n\t\tcurrentBindings.some((line, i) => line !== displayBindingsRef.current[i])\r\n\t) {\r\n\t\tdisplayBindingsRef.current = currentBindings;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\ttop: 20,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(0,0,0,0.82)\",\r\n\t\t\t\tcolor: \"#d1fae5\",\r\n\t\t\t\tpadding: \"12px 14px\",\r\n\t\t\t\tborderRadius: 10,\r\n\t\t\t\tfontSize: 14,\r\n\t\t\t\tfontFamily: \"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace\",\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t\tpointerEvents: \"auto\",\r\n\t\t\t\tminWidth: 360,\r\n\t\t\t\twhiteSpace: \"pre\",\r\n\t\t\t\tlineHeight: 1.35,\r\n\t\t\t\tborder: \"1px solid rgba(255,255,255,0.12)\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div style={{ fontWeight: 800, color: \"#a7f3d0\", marginBottom: 8 }}>Wii Debug</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>\r\n\t\t\t\tAcc: X={String(displayAccel.x).padStart(3)} Y={String(displayAccel.y).padStart(3)} Z=\r\n\t\t\t\t{String(displayAccel.z).padStart(3)}\r\n\t\t\t</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>IR : {displayIrCountRef.current}</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>{`Btn: ${displayButtonsRef.current}`}</div>\r\n\r\n\t\t\t{onToggleIrCursor && (\r\n\t\t\t\t<div style={{ marginTop: 8 }}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onToggleIrCursor}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackground: irCursorEnabled ? \"#10b981\" : \"#374151\",\r\n\t\t\t\t\t\t\tcolor: \"#fff\",\r\n\t\t\t\t\t\t\tborder: \"none\",\r\n\t\t\t\t\t\t\tborderRadius: 6,\r\n\t\t\t\t\t\t\tpadding: \"6px 12px\",\r\n\t\t\t\t\t\t\tcursor: \"pointer\",\r\n\t\t\t\t\t\t\tfontWeight: 700,\r\n\t\t\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{irCursorEnabled ? \"IR Cursor: ON\" : \"IR Cursor: OFF\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t<div style={{ margin: \"10px 0\", borderTop: \"1px solid rgba(255,255,255,0.12)\" }} />\r\n\t\t\t<div style={{ fontWeight: 800, color: \"#a7f3d0\", marginBottom: 6 }}>Bindings (project)</div>\r\n\t\t\t{displayBindingsRef.current.map((line) => (\r\n\t\t\t\t<div key={line}>{line}</div>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1570, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/PdfSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ninterface PdfSlideProps {\r\n\tassetId: string;\r\n\tpage: number;\r\n\tfallbackDataUrl?: string;\r\n\talt: string;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<unknown>;\r\n}\r\n\r\nexport function PdfSlide({ assetId, page, fallbackDataUrl, alt, getOrLoadPdfDocument }: PdfSlideProps) {\r\n\tconst wrapperRef = useRef<HTMLDivElement | null>(null);\r\n\tconst canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n\tconst [size, setSize] = useState<{ w: number; h: number } | null>(null);\r\n\tconst [renderError, setRenderError] = useState<string | null>(null);\r\n\tconst renderTaskRef = useRef<{ cancel: () => void } | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst el = wrapperRef.current;\r\n\t\tif (!el) return;\r\n\r\n\t\tconst update = () => {\r\n\t\t\tconst rect = el.getBoundingClientRect();\r\n\t\t\tsetSize({ w: Math.max(0, rect.width), h: Math.max(0, rect.height) });\r\n\t\t};\r\n\t\tupdate();\r\n\r\n\t\tconst ro = new ResizeObserver(update);\r\n\t\tro.observe(el);\r\n\t\treturn () => ro.disconnect();\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet cancelled = false;\r\n\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetRenderError(null);\r\n\r\n\t\t\t\tconst el = wrapperRef.current;\r\n\t\t\t\tconst canvas = canvasRef.current;\r\n\t\t\t\tif (!el || !canvas || !size || size.w === 0 || size.h === 0) return;\r\n\r\n\t\t\t\tif (renderTaskRef.current) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\trenderTaskRef.current.cancel();\r\n\t\t\t\t\t} catch {\r\n\t\t\t\t\t\t// Already cancelled\r\n\t\t\t\t\t}\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst pdf = (await getOrLoadPdfDocument(assetId)) as {\r\n\t\t\t\t\tgetPage: (page: number) => Promise<{\r\n\t\t\t\t\t\tgetViewport: (options: { scale: number }) => { width: number; height: number };\r\n\t\t\t\t\t\trender: (options: { canvasContext: CanvasRenderingContext2D; canvas: HTMLCanvasElement; viewport: unknown }) => { promise: Promise<void> };\r\n\t\t\t\t\t}>;\r\n\t\t\t\t};\r\n\t\t\t\tif (cancelled) return;\r\n\r\n\t\t\t\tconst pdfPage = await pdf.getPage(page);\r\n\t\t\t\tif (cancelled) return;\r\n\r\n\t\t\t\tconst viewport1 = pdfPage.getViewport({ scale: 1 });\r\n\t\t\t\tconst scale = Math.min(size.w / viewport1.width, size.h / viewport1.height);\r\n\t\t\t\tconst dpr = typeof window !== \"undefined\" ? window.devicePixelRatio || 1 : 1;\r\n\t\t\t\tconst renderViewport = pdfPage.getViewport({ scale: scale * dpr });\r\n\r\n\t\t\t\tcanvas.width = Math.floor(renderViewport.width);\r\n\t\t\t\tcanvas.height = Math.floor(renderViewport.height);\r\n\t\t\t\tcanvas.style.width = `${Math.floor(renderViewport.width / dpr)}px`;\r\n\t\t\t\tcanvas.style.height = `${Math.floor(renderViewport.height / dpr)}px`;\r\n\r\n\t\t\t\tconst ctx = canvas.getContext(\"2d\");\r\n\t\t\t\tif (!ctx) return;\r\n\r\n\t\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tconst task = pdfPage.render({ canvasContext: ctx, canvas, viewport: renderViewport });\r\n\t\t\t\trenderTaskRef.current = task as unknown as { cancel: () => void };\r\n\r\n\t\t\t\tawait task.promise;\r\n\r\n\t\t\t\tif (renderTaskRef.current === (task as unknown)) {\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t}\r\n\t\t\t} catch (e: unknown) {\r\n\t\t\t\tconst error = e as { name?: string; message?: string };\r\n\t\t\t\tconst msg = error?.name === \"RenderingCancelledException\" ? null : error?.message || String(e);\r\n\t\t\t\tif (!cancelled && msg) setRenderError(msg);\r\n\t\t\t}\r\n\t\t})();\r\n\r\n\t\treturn () => {\r\n\t\t\tcancelled = true;\r\n\t\t\tif (renderTaskRef.current) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\trenderTaskRef.current.cancel();\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// Already cancelled\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}, [assetId, getOrLoadPdfDocument, page, size]);\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tref={wrapperRef}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}\r\n\t\t>\r\n\t\t\t{renderError && fallbackDataUrl ? (\r\n\t\t\t\t<img src={fallbackDataUrl} style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }} alt={alt} />\r\n\t\t\t) : (\r\n\t\t\t\t<canvas ref={canvasRef} aria-label={alt} />\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1729, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/VideoSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAssetBlob } from \"@/lib/idbAssets\";\r\n\r\ninterface VideoSlideProps {\r\n\tassetId: string;\r\n\talt: string;\r\n}\r\n\r\nexport function VideoSlide({ assetId, alt }: VideoSlideProps) {\r\n\tconst [src, setSrc] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet active = true;\r\n\t\tlet url: string | null = null;\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetError(null);\r\n\t\t\t\tsetSrc(null);\r\n\t\t\t\tconst blob = await getAssetBlob(assetId);\r\n\t\t\t\tif (!blob) throw new Error(\"ÂãïÁîª„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\r\n\t\t\t\turl = URL.createObjectURL(blob);\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetSrc(url);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetError(e instanceof Error ? e.message : String(e));\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tactive = false;\r\n\t\t\tif (url) URL.revokeObjectURL(url);\r\n\t\t};\r\n\t}, [assetId]);\r\n\r\n\tif (error) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÂãïÁîª„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: {error}</div>;\r\n\t}\r\n\tif (!src) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÂãïÁîª„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<video\r\n\t\t\tsrc={src}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\r\n\t\t\tcontrols\r\n\t\t\tautoPlay\r\n\t\t\tplaysInline\r\n\t\t\taria-label={alt}\r\n\t\t/>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAUO,SAAS,WAAW,EAAE,OAAO,EAAE,GAAG,EAAmB;;IAC3D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,6MAAQ,EAAgB;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6MAAQ,EAAgB;IAElD,IAAA,8MAAS;gCAAC;YACT,IAAI,SAAS;YACb,IAAI,MAAqB;YACzB;wCAAC;oBACA,IAAI;wBACH,SAAS;wBACT,OAAO;wBACP,MAAM,OAAO,MAAM,AAJrB,IAIqB,8KAAY,AAShC,EATiC;wBAChC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;wBAC3B,MAAM,IAAI,eAAe,CAAC;wBAC1B,IAAI,CAAC,QAAQ;wBACb,OAAO;oBACR,EAAE,OAAO,GAAG;wBACX,IAAI,CAAC,QAAQ;wBACb,SAAS,aAAa,QAAQ,EAAE,OAAO,GAAG,OAAO;oBAClD;gBACD;;YACA;wCAAO;oBACN,SAAS;oBACT,IAAI,KAAK,IAAI,eAAe,CAAC;gBAC9B;;QACD;+BAAG;QAAC;KAAQ;IAEZ,IAAI,OAAO;QACV,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;;gBAAG;gBAAiB;;;;;;;IAC9E;IACA,IAAI,CAAC,KAAK;QACT,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;sBAAG;;;;;;IAC7D;IAEA,qBACC,iOAAC;QACA,KAAK;QACL,OAAO;YAAE,OAAO;YAAQ,QAAQ;YAAQ,WAAW;QAAU;QAC7D,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,cAAY;;;;;;AAGf;GA5CgB;KAAA"}},
    {"offset": {"line": 1832, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/ImageSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAssetBlob } from \"@/lib/idbAssets\";\r\n\r\ninterface ImageSlideProps {\r\n\tassetId: string;\r\n\talt: string;\r\n}\r\n\r\nexport function ImageSlide({ assetId, alt }: ImageSlideProps) {\r\n\tconst [src, setSrc] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet active = true;\r\n\t\tlet url: string | null = null;\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetError(null);\r\n\t\t\t\tsetSrc(null);\r\n\t\t\t\tconst blob = await getAssetBlob(assetId);\r\n\t\t\t\tif (!blob) throw new Error(\"ÁîªÂÉè„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\r\n\t\t\t\turl = URL.createObjectURL(blob);\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetSrc(url);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetError(e instanceof Error ? e.message : String(e));\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tactive = false;\r\n\t\t\tif (url) URL.revokeObjectURL(url);\r\n\t\t};\r\n\t}, [assetId]);\r\n\r\n\tif (error) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: {error}</div>;\r\n\t}\r\n\tif (!src) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÁîªÂÉè„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<img\r\n\t\t\tsrc={src}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\r\n\t\t\talt={alt}\r\n\t\t/>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAUO,SAAS,WAAW,EAAE,OAAO,EAAE,GAAG,EAAmB;;IAC3D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,6MAAQ,EAAgB;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6MAAQ,EAAgB;IAElD,IAAA,8MAAS;gCAAC;YACT,IAAI,SAAS;YACb,IAAI,MAAqB;YACzB;wCAAC;oBACA,IAAI;wBACH,SAAS;wBACT,OAAO;wBACP,MAAM,OAAO,MAAM,AAJrB,IAIqB,8KAAY,AAShC,EATiC;wBAChC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;wBAC3B,MAAM,IAAI,eAAe,CAAC;wBAC1B,IAAI,CAAC,QAAQ;wBACb,OAAO;oBACR,EAAE,OAAO,GAAG;wBACX,IAAI,CAAC,QAAQ;wBACb,SAAS,aAAa,QAAQ,EAAE,OAAO,GAAG,OAAO;oBAClD;gBACD;;YACA;wCAAO;oBACN,SAAS;oBACT,IAAI,KAAK,IAAI,eAAe,CAAC;gBAC9B;;QACD;+BAAG;QAAC;KAAQ;IAEZ,IAAI,OAAO;QACV,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;;gBAAG;gBAAiB;;;;;;;IAC9E;IACA,IAAI,CAAC,KAAK;QACT,qBAAO,iOAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;sBAAG;;;;;;IAC7D;IAEA,qBACC,iOAAC;QACA,KAAK;QACL,OAAO;YAAE,OAAO;YAAQ,QAAQ;YAAQ,WAAW;QAAU;QAC7D,KAAK;;;;;;AAGR;GAzCgB;KAAA"}},
    {"offset": {"line": 1932, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/SlideDisplay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { Node } from \"@xyflow/react\";\r\nimport type { SlideNodeData } from \"@/types\";\r\nimport { PdfSlide } from \"./PdfSlide\";\r\nimport { VideoSlide } from \"./VideoSlide\";\r\nimport { ImageSlide } from \"./ImageSlide\";\r\n\r\ninterface SlideDisplayProps {\r\n\tcurrentNode: Node<SlideNodeData> | undefined;\r\n\terror: string | null;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<unknown>;\r\n}\r\n\r\nexport function SlideDisplay({ currentNode, error, getOrLoadPdfDocument }: SlideDisplayProps) {\r\n\treturn (\r\n\t\t<div style={{ position: \"absolute\", inset: 0, display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n\t\t\t{currentNode ? (\r\n\t\t\t\t<SlideContent currentNode={currentNode} getOrLoadPdfDocument={getOrLoadPdfDocument} />\r\n\t\t\t) : (\r\n\t\t\t\t<div style={{ color: \"white\" }}>{error ?? \"„Çπ„É©„Ç§„Éâ„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì\"}</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction SlideContent({\r\n\tcurrentNode,\r\n\tgetOrLoadPdfDocument,\r\n}: {\r\n\tcurrentNode: Node<SlideNodeData>;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<unknown>;\r\n}) {\r\n\tconst asset = currentNode.data.asset;\r\n\r\n\tif (!asset) {\r\n\t\treturn (\r\n\t\t\t<h1 style={{ fontSize: 80, color: \"white\", textAlign: \"center\", maxWidth: \"80%\" }}>\r\n\t\t\t\t{currentNode.data.label}\r\n\t\t\t</h1>\r\n\t\t);\r\n\t}\r\n\r\n\tswitch (asset.kind) {\r\n\t\tcase \"pdf\":\r\n\t\t\treturn (\r\n\t\t\t\t<PdfSlide\r\n\t\t\t\t\tassetId={asset.assetId}\r\n\t\t\t\t\tpage={asset.page ?? 1}\r\n\t\t\t\t\tfallbackDataUrl={asset.thumbnailDataUrl}\r\n\t\t\t\t\talt={currentNode.data.label}\r\n\t\t\t\t\tgetOrLoadPdfDocument={getOrLoadPdfDocument}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\tcase \"video\":\r\n\t\t\treturn <VideoSlide assetId={asset.assetId} alt={currentNode.data.label} />;\r\n\t\tcase \"image\":\r\n\t\t\treturn <ImageSlide assetId={asset.assetId} alt={currentNode.data.label} />;\r\n\t\tdefault:\r\n\t\t\treturn null;\r\n\t}\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AACA;AACA;AANA;;;;;AAcO,SAAS,aAAa,EAAE,WAAW,EAAE,KAAK,EAAE,oBAAoB,EAAqB;IAC3F,qBACC,iOAAC;QAAI,OAAO;YAAE,UAAU;YAAY,OAAO;YAAG,SAAS;YAAQ,YAAY;YAAU,gBAAgB;QAAS;kBAC5G,4BACA,iOAAC;YAAa,aAAa;YAAa,sBAAsB;;;;;iCAE9D,iOAAC;YAAI,OAAO;gBAAE,OAAO;YAAQ;sBAAI,SAAS;;;;;;;;;;;AAI9C;KAVgB;AAYhB,SAAS,aAAa,EACrB,WAAW,EACX,oBAAoB,EAIpB;IACA,MAAM,QAAQ,YAAY,IAAI,CAAC,KAAK;IAEpC,IAAI,CAAC,OAAO;QACX,qBACC,iOAAC;YAAG,OAAO;gBAAE,UAAU;gBAAI,OAAO;gBAAS,WAAW;gBAAU,UAAU;YAAM;sBAC9E,YAAY,IAAI,CAAC,KAAK;;;;;;IAG1B;IAEA,OAAQ,MAAM,IAAI;QACjB,KAAK;YACJ,qBACC,iOAAC,8LAAQ;gBACR,SAAS,MAAM,OAAO;gBACtB,MAAM,MAAM,IAAI,IAAI;gBACpB,iBAAiB,MAAM,gBAAgB;gBACvC,KAAK,YAAY,IAAI,CAAC,KAAK;gBAC3B,sBAAsB;;;;;;QAGzB,KAAK;YACJ,qBAAO,iOAAC,kMAAU;gBAAC,SAAS,MAAM,OAAO;gBAAE,KAAK,YAAY,IAAI,CAAC,KAAK;;;;;;QACvE,KAAK;YACJ,qBAAO,iOAAC,kMAAU;gBAAC,SAAS,MAAM,OAAO;gBAAE,KAAK,YAAY,IAAI,CAAC,KAAK;;;;;;QACvE;YACC,OAAO;IACT;AACD;MAnCS"}},
    {"offset": {"line": 2041, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/DrawingCanvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\nimport type { DrawingPoint, Position } from \"@/types\";\r\n\r\ninterface DrawingCanvasProps {\r\n\tdrawingPoints: DrawingPoint[];\r\n\twiiState: WiiState | null;\r\n\tisPlaying: boolean;\r\n\tshouldPaint: boolean;\r\n\teraserMode: boolean;\r\n\teraserPosition: Position | null;\r\n}\r\n\r\nconst ERASER_RADIUS = 60;\r\nconst ERASER_STEP = 12;\r\nconst ERASER_ALPHA = 0.18;\r\nconst ERASER_BLUR = 25;\r\nconst PEN_WIDTH = 5;\r\nconst PEN_COLOR = \"red\";\r\n\r\nexport function DrawingCanvas({\r\n\tdrawingPoints,\r\n\teraserMode,\r\n\teraserPosition,\r\n}: DrawingCanvasProps) {\r\n\tconst drawingCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\tconst cursorCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\tconst lastDrawnIndexRef = useRef(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tconst width = window.innerWidth;\r\n\t\t\tconst height = window.innerHeight;\r\n\r\n\t\t\tif (drawingCanvasRef.current) {\r\n\t\t\t\tdrawingCanvasRef.current.width = width;\r\n\t\t\t\tdrawingCanvasRef.current.height = height;\r\n\t\t\t\tlastDrawnIndexRef.current = 0;\r\n\t\t\t}\r\n\t\t\tif (cursorCanvasRef.current) {\r\n\t\t\t\tcursorCanvasRef.current.width = width;\r\n\t\t\t\tcursorCanvasRef.current.height = height;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\thandleResize();\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => window.removeEventListener(\"resize\", handleResize);\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst canvas = drawingCanvasRef.current;\r\n\t\tconst ctx = canvas?.getContext(\"2d\");\r\n\t\tif (!canvas || !ctx) return;\r\n\r\n\t\tif (drawingPoints.length < lastDrawnIndexRef.current) {\r\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\t\tlastDrawnIndexRef.current = 0;\r\n\t\t}\r\n\r\n\t\tif (drawingPoints.length === lastDrawnIndexRef.current) return;\r\n\r\n\t\tctx.lineCap = \"round\";\r\n\t\tctx.lineJoin = \"round\";\r\n\r\n\t\tfor (let i = lastDrawnIndexRef.current; i < drawingPoints.length; i++) {\r\n\t\t\tconst point = drawingPoints[i];\r\n\t\t\tif (!point) continue;\r\n\r\n\t\t\tconst prev = i > 0 ? drawingPoints[i - 1] : null;\r\n\t\t\tconst mode = point.mode || \"draw\";\r\n\t\t\tconst isStart = !prev || prev.mode !== point.mode;\r\n\r\n\t\t\tif (isStart && mode === \"erase\") {\r\n\t\t\t\tdrawEraserStamp(ctx, point.x, point.y);\r\n\t\t\t} else if (!isStart && prev) {\r\n\t\t\t\tif (mode === \"draw\") {\r\n\t\t\t\t\tdrawLine(ctx, prev.x, prev.y, point.x, point.y);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdrawEraserPath(ctx, prev.x, prev.y, point.x, point.y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlastDrawnIndexRef.current = drawingPoints.length;\r\n\t}, [drawingPoints]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst canvas = cursorCanvasRef.current;\r\n\t\tconst ctx = canvas?.getContext(\"2d\");\r\n\t\tif (!canvas || !ctx) return;\r\n\r\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\tif (eraserMode && eraserPosition) {\r\n\t\t\tctx.save();\r\n\t\t\tctx.strokeStyle = \"rgba(255, 100, 100, 0.6)\";\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.setLineDash([8, 4]);\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(eraserPosition.x, eraserPosition.y, ERASER_RADIUS, 0, Math.PI * 2);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.setLineDash([]);\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}, [eraserMode, eraserPosition]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<canvas\r\n\t\t\t\tref={drawingCanvasRef}\r\n\t\t\t\tstyle={{ position: \"absolute\", top: 0, left: 0, pointerEvents: \"none\" }}\r\n\t\t\t/>\r\n\t\t\t<canvas\r\n\t\t\t\tref={cursorCanvasRef}\r\n\t\t\t\tstyle={{ position: \"absolute\", top: 0, left: 0, pointerEvents: \"none\" }}\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nfunction drawEraserStamp(ctx: CanvasRenderingContext2D, x: number, y: number) {\r\n\tctx.globalCompositeOperation = \"destination-out\";\r\n\tctx.fillStyle = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\tctx.shadowBlur = ERASER_BLUR;\r\n\tctx.shadowColor = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\tctx.beginPath();\r\n\tctx.arc(x, y, ERASER_RADIUS, 0, Math.PI * 2);\r\n\tctx.fill();\r\n}\r\n\r\nfunction drawLine(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number) {\r\n\tctx.globalCompositeOperation = \"source-over\";\r\n\tctx.strokeStyle = PEN_COLOR;\r\n\tctx.lineWidth = PEN_WIDTH;\r\n\tctx.shadowBlur = 0;\r\n\tctx.shadowColor = \"transparent\";\r\n\tctx.beginPath();\r\n\tctx.moveTo(x1, y1);\r\n\tctx.lineTo(x2, y2);\r\n\tctx.stroke();\r\n}\r\n\r\nfunction drawEraserPath(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number) {\r\n\tctx.globalCompositeOperation = \"destination-out\";\r\n\tctx.fillStyle = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\tctx.shadowBlur = ERASER_BLUR;\r\n\tctx.shadowColor = `rgba(0,0,0,${ERASER_ALPHA})`;\r\n\r\n\tconst dist = Math.hypot(x2 - x1, y2 - y1);\r\n\tconst angle = Math.atan2(y2 - y1, x2 - x1);\r\n\r\n\tfor (let d = ERASER_STEP; d <= dist; d += ERASER_STEP) {\r\n\t\tconst bx = x1 + Math.cos(angle) * d;\r\n\t\tconst by = y1 + Math.sin(angle) * d;\r\n\t\tctx.beginPath();\r\n\t\tctx.arc(bx, by, ERASER_RADIUS, 0, Math.PI * 2);\r\n\t\tctx.fill();\r\n\t}\r\n\r\n\tctx.beginPath();\r\n\tctx.arc(x2, y2, ERASER_RADIUS, 0, Math.PI * 2);\r\n\tctx.fill();\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2224, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/IrPointerOverlay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\n\r\ninterface IrPointerOverlayProps {\r\n\twiiState: WiiState | null;\r\n\tisPlaying: boolean;\r\n\tirCursorEnabled: boolean;\r\n\tshowIrDebug?: boolean;\r\n}\r\n\r\nfunction mapIrToScreen(irX: number, irY: number, screenW: number, screenH: number) {\r\n\treturn {\r\n\t\tx: (1 - irX / 1024) * screenW,\r\n\t\ty: (irY / 768) * screenH,\r\n\t};\r\n}\r\n\r\nexport function IrPointerOverlay({ wiiState, irCursorEnabled, showIrDebug = false }: IrPointerOverlayProps) {\r\n\tif (!showIrDebug || !wiiState) return null;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\tbottom: 60,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(0, 0, 0, 0.85)\",\r\n\t\t\t\tcolor: \"lime\",\r\n\t\t\t\tpadding: \"12px 16px\",\r\n\t\t\t\tborderRadius: 8,\r\n\t\t\t\tfontFamily: \"monospace\",\r\n\t\t\t\tfontSize: 12,\r\n\t\t\t\tlineHeight: 1.6,\r\n\t\t\t\tborder: \"1px solid rgba(0, 255, 0, 0.3)\",\r\n\t\t\t\tmaxWidth: 320,\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div style={{ fontWeight: \"bold\", marginBottom: 8, color: \"#0ff\" }}>üì° IR Sensor Debug</div>\r\n\t\t\t<div>\r\n\t\t\t\t<span style={{ color: \"#888\" }}>IRCursor:</span>{\" \"}\r\n\t\t\t\t<span style={{ color: irCursorEnabled ? \"#0f0\" : \"#f55\" }}>{irCursorEnabled ? \"ON\" : \"OFF\"}</span>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<span style={{ color: \"#888\" }}>Detected:</span> {wiiState.ir?.length || 0} point(s)\r\n\t\t\t</div>\r\n\t\t\t{wiiState.ir && wiiState.ir.length > 0 && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<hr style={{ margin: \"8px 0\", border: \"none\", borderTop: \"1px solid rgba(0,255,0,0.2)\" }} />\r\n\t\t\t\t\t{wiiState.ir.map((dot, index) => {\r\n\t\t\t\t\t\tconst screen = mapIrToScreen(dot.x, dot.y, window.innerWidth, window.innerHeight);\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div key={index} style={{ marginBottom: 4 }}>\r\n\t\t\t\t\t\t\t\t<div style={{ color: \"#0ff\" }}>IR {index + 1}:</div>\r\n\t\t\t\t\t\t\t\t<div style={{ paddingLeft: 12 }}>\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Raw:</span> ({dot.x}, {dot.y})\r\n\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Screen:</span> ({Math.round(screen.x)}, {Math.round(screen.y)})\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</>\r\n\t\t\t)}\r\n\t\t\t<hr style={{ margin: \"8px 0\", border: \"none\", borderTop: \"1px solid rgba(0,255,0,0.2)\" }} />\r\n\t\t\t<div style={{ fontSize: 10, color: \"#666\" }}>\r\n\t\t\t\tÂ∫ßÊ®ôÁØÑÂõ≤: X(0-1023), Y(0-767)\r\n\t\t\t\t<br />\r\n\t\t\t\t[C] IR„Ç´„Éº„ÇΩ„É´ÂàáÊõø / [Space] „Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫ÂàáÊõø\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAWA,SAAS,cAAc,GAAW,EAAE,GAAW,EAAE,OAAe,EAAE,OAAe;IAChF,OAAO;QACN,GAAG,CAAC,IAAI,MAAM,IAAI,IAAI;QACtB,GAAG,AAAC,MAAM,MAAO;IAClB;AACD;AAEO,SAAS,iBAAiB,EAAE,QAAQ,EAAE,eAAe,EAAE,cAAc,KAAK,EAAyB;IACzG,IAAI,CAAC,eAAe,CAAC,UAAU,OAAO;IAEtC,qBACC,iOAAC;QACA,OAAO;YACN,UAAU;YACV,QAAQ;YACR,OAAO;YACP,YAAY;YACZ,OAAO;YACP,SAAS;YACT,cAAc;YACd,YAAY;YACZ,UAAU;YACV,YAAY;YACZ,QAAQ;YACR,UAAU;YACV,QAAQ;QACT;;0BAEA,iOAAC;gBAAI,OAAO;oBAAE,YAAY;oBAAQ,cAAc;oBAAG,OAAO;gBAAO;0BAAG;;;;;;0BACpE,iOAAC;;kCACA,iOAAC;wBAAK,OAAO;4BAAE,OAAO;wBAAO;kCAAG;;;;;;oBAAiB;kCACjD,iOAAC;wBAAK,OAAO;4BAAE,OAAO,kBAAkB,SAAS;wBAAO;kCAAI,kBAAkB,OAAO;;;;;;;;;;;;0BAEtF,iOAAC;;kCACA,iOAAC;wBAAK,OAAO;4BAAE,OAAO;wBAAO;kCAAG;;;;;;oBAAgB;oBAAE,SAAS,EAAE,EAAE,UAAU;oBAAE;;;;;;;YAE3E,SAAS,EAAE,IAAI,SAAS,EAAE,CAAC,MAAM,GAAG,mBACpC;;kCACC,iOAAC;wBAAG,OAAO;4BAAE,QAAQ;4BAAS,QAAQ;4BAAQ,WAAW;wBAA8B;;;;;;oBACtF,SAAS,EAAE,CAAC,GAAG,CAAC,CAAC,KAAK;wBACtB,MAAM,SAAS,cAAc,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,OAAO,UAAU,EAAE,OAAO,WAAW;wBAChF,qBACC,iOAAC;4BAAgB,OAAO;gCAAE,cAAc;4BAAE;;8CACzC,iOAAC;oCAAI,OAAO;wCAAE,OAAO;oCAAO;;wCAAG;wCAAI,QAAQ;wCAAE;;;;;;;8CAC7C,iOAAC;oCAAI,OAAO;wCAAE,aAAa;oCAAG;;sDAC7B,iOAAC;4CAAK,OAAO;gDAAE,OAAO;4CAAO;sDAAG;;;;;;wCAAW;wCAAG,IAAI,CAAC;wCAAC;wCAAG,IAAI,CAAC;wCAAC;sDAC7D,iOAAC;;;;;sDACD,iOAAC;4CAAK,OAAO;gDAAE,OAAO;4CAAO;sDAAG;;;;;;wCAAc;wCAAG,KAAK,KAAK,CAAC,OAAO,CAAC;wCAAE;wCAAG,KAAK,KAAK,CAAC,OAAO,CAAC;wCAAE;;;;;;;;2BALtF;;;;;oBASZ;;;0BAGF,iOAAC;gBAAG,OAAO;oBAAE,QAAQ;oBAAS,QAAQ;oBAAQ,WAAW;gBAA8B;;;;;;0BACvF,iOAAC;gBAAI,OAAO;oBAAE,UAAU;oBAAI,OAAO;gBAAO;;oBAAG;kCAE5C,iOAAC;;;;;oBAAK;;;;;;;;;;;;;AAKV;KAvDgB"}},
    {"offset": {"line": 2454, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/EraserCursor.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { Position } from \"@/types\";\r\n\r\ninterface EraserCursorProps {\r\n\tposition: Position | null;\r\n\tisActive: boolean;\r\n\tbuttonName?: string | null;\r\n}\r\n\r\nexport function EraserCursor({ position, isActive, buttonName }: EraserCursorProps) {\r\n\tif (!isActive || !position) return null;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"fixed\",\r\n\t\t\t\tbottom: 80,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(255, 100, 100, 0.7)\",\r\n\t\t\t\tcolor: \"white\",\r\n\t\t\t\tpadding: \"8px 16px\",\r\n\t\t\t\tborderRadius: 6,\r\n\t\t\t\tfontSize: 13,\r\n\t\t\t\tfontWeight: \"normal\",\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t\tboxShadow: \"0 2px 8px rgba(0,0,0,0.2)\",\r\n\t\t\t\tpointerEvents: \"none\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\tÊ∂à„Åó„Ç¥„É†„É¢„Éº„Éâ ON\r\n\t\t\t<br />\r\n\t\t\t<small style={{ fontSize: 11 }}>Â∑¶„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØA+B„ÅßÊ∂àÂéª | {buttonName || \"X\"}„ÅßËß£Èô§</small>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAUO,SAAS,aAAa,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAqB;IACjF,IAAI,CAAC,YAAY,CAAC,UAAU,OAAO;IAEnC,qBACC,iOAAC;QACA,OAAO;YACN,UAAU;YACV,QAAQ;YACR,OAAO;YACP,YAAY;YACZ,OAAO;YACP,SAAS;YACT,cAAc;YACd,UAAU;YACV,YAAY;YACZ,QAAQ;YACR,WAAW;YACX,eAAe;QAChB;;YACA;0BAEA,iOAAC;;;;;0BACD,iOAAC;gBAAM,OAAO;oBAAE,UAAU;gBAAG;;oBAAG;oBAAkB,cAAc;oBAAI;;;;;;;;;;;;;AAGvE;KAzBgB"}}]
}