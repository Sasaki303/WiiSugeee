{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/presentation.ts"],"sourcesContent":["import type { ButtonBindings } from \"@/lib/buttonBindings\";\n\nexport type ProjectAsset = {\n\tid: string;\n\tkind: \"pdf\" | \"video\" | \"image\";\n\tfileName: string;\n\tstoredFileName: string; // assets/ ÈÖç‰∏ã„ÅÆ„Éï„Ç°„Ç§„É´Âêç\n};\n\nexport type AssetRef =\n\t| {\n\t\t\tkind: \"pdf\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tpage: number;\n\t\t\tthumbnailDataUrl?: string;\n\t  }\n\t| {\n\t\t\tkind: \"video\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tthumbnailDataUrl?: string;\n\t  }\n\t| {\n\t\t\tkind: \"image\";\n\t\t\tassetId: string;\n\t\t\tfileName: string;\n\t\t\tthumbnailDataUrl?: string;\n\t  };\n\nexport type SlideNodeData = {\n\tlabel: string;\n\tasset?: AssetRef;\n\t/**\n\t * „Çπ„É©„Ç§„Éâ„Åî„Å®„ÅÆ Wii „Éú„Çø„É≥Ââ≤„ÇäÂΩì„Å¶„ÄÇ\n\t * Êú™Ë®≠ÂÆö„ÅÆÂ†¥Âêà„ÅØ„Éá„Éï„Ç©„É´„ÉàÂâ≤„ÇäÂΩì„Å¶„ÇíÈÅ©Áî®„Åô„Çã„ÄÇ\n\t */\n\tbindings?: ButtonBindings;\n};\n\nexport type SerializedFlow = {\n\tversion: 1;\n\tassets?: ProjectAsset[];\n\tviewport?: { x: number; y: number; zoom: number };\n\t/**\n\t * „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„ÅÆ Wii „Éú„Çø„É≥Ââ≤„ÇäÂΩì„Å¶„ÄÇ\n\t * Êú™Ë®≠ÂÆö„ÅÆÂ†¥Âêà„ÅØ„Éá„Éï„Ç©„É´„ÉàÂâ≤„ÇäÂΩì„Å¶„ÇíÈÅ©Áî®„Åô„Çã„ÄÇ\n\t */\n\tprojectBindings?: ButtonBindings;\n\tnodes: Array<{\n\t\tid: string;\n\t\ttype?: string;\n\t\tposition: { x: number; y: number };\n\t\tdata: SlideNodeData;\n\t}>;\n\tedges: Array<{\n\t\tid: string;\n\t\tsource: string;\n\t\ttarget: string;\n\t\tlabel?: string;\n\t}>;\n};\n\nconst STORAGE_KEY = \"wiisugeee.editor.flow.v1\";\nconst LAST_SAVED_HASH_KEY = \"wiisugeee.editor.lastSavedHash.v1\";\n\nexport function serializeFlow(flow: SerializedFlow): string {\n\treturn JSON.stringify(flow, null, 2);\n}\n\nexport function tryParseFlowJson(text: string): SerializedFlow | null {\n\ttry {\n\t\tconst parsed = JSON.parse(text) as unknown;\n\t\tif (!parsed || typeof parsed !== \"object\") return null;\n\t\tconst maybe = parsed as Partial<SerializedFlow>;\n\t\tif (maybe.version !== 1) return null;\n\t\tif (!Array.isArray(maybe.nodes) || !Array.isArray(maybe.edges)) return null;\n\t\treturn maybe as SerializedFlow;\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function saveToLocalStorage(flow: SerializedFlow): void {\n\ttry {\n\t\tlocalStorage.setItem(STORAGE_KEY, serializeFlow(flow));\n\t} catch {\n\t\t// ignore\n\t}\n}\n\nexport function loadFromLocalStorage(): SerializedFlow | null {\n\ttry {\n\t\tconst text = localStorage.getItem(STORAGE_KEY);\n\t\tif (!text) return null;\n\t\treturn tryParseFlowJson(text);\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function getLastSavedHash(): string | null {\n\ttry {\n\t\treturn localStorage.getItem(LAST_SAVED_HASH_KEY);\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport function setLastSavedHash(hash: string): void {\n\ttry {\n\t\tlocalStorage.setItem(LAST_SAVED_HASH_KEY, hash);\n\t} catch {\n\t\t// ignore\n\t}\n}\n\nexport function clearEditorStorage(): void {\n\ttry {\n\t\tlocalStorage.removeItem(STORAGE_KEY);\n\t\tlocalStorage.removeItem(LAST_SAVED_HASH_KEY);\n\t} catch {\n\t\t// ignore\n\t}\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;AA+DA,MAAM,cAAc;AACpB,MAAM,sBAAsB;AAErB,SAAS,cAAc,IAAoB;IACjD,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AACnC;AAEO,SAAS,iBAAiB,IAAY;IAC5C,IAAI;QACH,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU,OAAO;QAClD,MAAM,QAAQ;QACd,IAAI,MAAM,OAAO,KAAK,GAAG,OAAO;QAChC,IAAI,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,GAAG,OAAO;QACvE,OAAO;IACR,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS,mBAAmB,IAAoB;IACtD,IAAI;QACH,aAAa,OAAO,CAAC,aAAa,cAAc;IACjD,EAAE,OAAM;IACP,SAAS;IACV;AACD;AAEO,SAAS;IACf,IAAI;QACH,MAAM,OAAO,aAAa,OAAO,CAAC;QAClC,IAAI,CAAC,MAAM,OAAO;QAClB,OAAO,iBAAiB;IACzB,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS;IACf,IAAI;QACH,OAAO,aAAa,OAAO,CAAC;IAC7B,EAAE,OAAM;QACP,OAAO;IACR;AACD;AAEO,SAAS,iBAAiB,IAAY;IAC5C,IAAI;QACH,aAAa,OAAO,CAAC,qBAAqB;IAC3C,EAAE,OAAM;IACP,SAAS;IACV;AACD;AAEO,SAAS;IACf,IAAI;QACH,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IACzB,EAAE,OAAM;IACP,SAAS;IACV;AACD"}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/idbAssets.ts"],"sourcesContent":["const DB_NAME = \"wiislide\";\nconst DB_VERSION = 1;\nconst STORE_NAME = \"assets\";\n\nfunction openDb(): Promise<IDBDatabase> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst req = indexedDB.open(DB_NAME, DB_VERSION);\n\t\treq.onupgradeneeded = () => {\n\t\t\tconst db = req.result;\n\t\t\tif (!db.objectStoreNames.contains(STORE_NAME)) {\n\t\t\t\tdb.createObjectStore(STORE_NAME);\n\t\t\t}\n\t\t};\n\t\treq.onsuccess = () => resolve(req.result);\n\t\treq.onerror = () => reject(req.error);\n\t});\n}\n\nexport async function putAssetBlob(assetId: string, blob: Blob): Promise<void> {\n\tconst db = await openDb();\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readwrite\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t\tresolve();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\ttx.objectStore(STORE_NAME).put(blob, assetId);\n\t});\n}\n\nexport async function getAssetBlob(assetId: string): Promise<Blob | null> {\n\tconst db = await openDb();\n\treturn await new Promise<Blob | null>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readonly\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\tconst req = tx.objectStore(STORE_NAME).get(assetId);\n\t\treq.onsuccess = () => resolve((req.result as Blob | undefined) ?? null);\n\t\treq.onerror = () => reject(req.error);\n\t});\n}\n\nexport async function clearAllAssetBlobs(): Promise<void> {\n\tconst db = await openDb();\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst tx = db.transaction(STORE_NAME, \"readwrite\");\n\t\ttx.oncomplete = () => {\n\t\t\tdb.close();\n\t\t\tresolve();\n\t\t};\n\t\ttx.onerror = () => {\n\t\t\tdb.close();\n\t\t\treject(tx.error);\n\t\t};\n\t\ttx.objectStore(STORE_NAME).clear();\n\t});\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,UAAU;AAChB,MAAM,aAAa;AACnB,MAAM,aAAa;AAEnB,SAAS;IACR,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC5B,MAAM,MAAM,UAAU,IAAI,CAAC,SAAS;QACpC,IAAI,eAAe,GAAG;YACrB,MAAM,KAAK,IAAI,MAAM;YACrB,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,aAAa;gBAC9C,GAAG,iBAAiB,CAAC;YACtB;QACD;QACA,IAAI,SAAS,GAAG,IAAM,QAAQ,IAAI,MAAM;QACxC,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,KAAK;IACrC;AACD;AAEO,eAAe,aAAa,OAAe,EAAE,IAAU;IAC7D,MAAM,KAAK,MAAM;IACjB,MAAM,IAAI,QAAc,CAAC,SAAS;QACjC,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;YACR;QACD;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,GAAG,WAAW,CAAC,YAAY,GAAG,CAAC,MAAM;IACtC;AACD;AAEO,eAAe,aAAa,OAAe;IACjD,MAAM,KAAK,MAAM;IACjB,OAAO,MAAM,IAAI,QAAqB,CAAC,SAAS;QAC/C,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;QACT;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,MAAM,MAAM,GAAG,WAAW,CAAC,YAAY,GAAG,CAAC;QAC3C,IAAI,SAAS,GAAG,IAAM,QAAQ,AAAC,IAAI,MAAM,IAAyB;QAClE,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,KAAK;IACrC;AACD;AAEO,eAAe;IACrB,MAAM,KAAK,MAAM;IACjB,MAAM,IAAI,QAAc,CAAC,SAAS;QACjC,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY;QACtC,GAAG,UAAU,GAAG;YACf,GAAG,KAAK;YACR;QACD;QACA,GAAG,OAAO,GAAG;YACZ,GAAG,KAAK;YACR,OAAO,GAAG,KAAK;QAChB;QACA,GAAG,WAAW,CAAC,YAAY,KAAK;IACjC;AACD"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/hooks/useWiiController.ts"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useMemo, useRef, useState } from \"react\";\r\n\r\nexport type WiiState = {\r\n\tbuttons: {\r\n\t\tA: boolean;\r\n\t\tB: boolean;\r\n\t\tOne: boolean;\r\n\t\tTwo: boolean;\r\n\t\tPlus: boolean;\r\n\t\tMinus: boolean;\r\n\t\tHome: boolean;\r\n\t\tUp: boolean;\r\n\t\tDown: boolean;\r\n\t\tRight: boolean;\r\n\t\tLeft: boolean;\r\n\t};\r\n\taccel: { x: number; y: number; z: number };\r\n\tir: { x: number; y: number }[];\r\n\tcursor?: {\r\n\t\tx: number; // 0‚Äì1\r\n\t\ty: number; // 0‚Äì1\r\n\t} | null;\r\n};\r\n\r\ntype WiiServerMessage =\r\n\t| { type: \"status\"; connected: boolean }\r\n\t| { type: \"wiiDisconnected\"; at?: number }\r\n\t| WiiState;\r\n\r\nconst EMPTY_BUTTONS: WiiState[\"buttons\"] = {\r\n\tA: false,\r\n\tB: false,\r\n\tOne: false,\r\n\tTwo: false,\r\n\tPlus: false,\r\n\tMinus: false,\r\n\tHome: false,\r\n\tUp: false,\r\n\tDown: false,\r\n\tRight: false,\r\n\tLeft: false,\r\n};\r\n\r\nfunction keyToButton(key: string): keyof WiiState[\"buttons\"] | null {\r\n\t// e.key „ÅØÁí∞Â¢ÉÂ∑Æ„ÅåÂá∫„Çã„ÅÆ„Åß„ÄÅÊñáÂ≠ó„ÅØÂ∞èÊñáÂ≠óÂåñ„Åó„Å¶Âà§ÂÆö\r\n\tconst k = key.length === 1 ? key.toLowerCase() : key;\r\n\r\n\tswitch (k) {\r\n\t\t// D-Pad (I J K L)\r\n\t\tcase \"i\":\r\n\t\t\treturn \"Up\";\r\n\t\tcase \"j\":\r\n\t\t\treturn \"Left\";\r\n\t\tcase \"k\":\r\n\t\t\treturn \"Down\";\r\n\t\tcase \"l\":\r\n\t\t\treturn \"Right\";\r\n\r\n\t\t// + ;  / - -\r\n\t\tcase \";\":\r\n\t\t\treturn \"Plus\";\r\n\t\tcase \"-\":\r\n\t\t\treturn \"Minus\";\r\n\r\n\t\t// Home / A / B\r\n\t\tcase \"h\":\r\n\t\t\treturn \"Home\";\r\n\t\tcase \"o\":\r\n\t\t\treturn \"A\";\r\n\t\tcase \"p\":\r\n\t\t\treturn \"B\";\r\n\r\n\t\t// 1 / 2Ôºà„É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Å´„ÇÇ‰Ωø„ÅÜÔºâ\r\n\t\tcase \"n\":\r\n\t\t\treturn \"One\";\r\n\t\tcase \"m\":\r\n\t\t\treturn \"Two\";\r\n\r\n\t\tdefault:\r\n\t\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport function useWiiController() {\r\n\tconst [wiiState, setWiiState] = useState<WiiState | null>(null);\r\n\tconst [wiiConnected, setWiiConnected] = useState(false);\r\n\t// ‚òÖËøΩÂä†: backend„Åã„ÇâÊù•„ÅüÂàáÊñ≠„Ç§„Éô„É≥„Éà„ÅÆ„Çø„Ç§„É†„Çπ„Çø„É≥„ÉóÔºàÊõ¥Êñ∞„Åï„Çå„Çã„Åü„Å≥„Å´„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„ÇíÈñã„ÅèÔºâ\r\n\tconst [wiiDisconnectedAt, setWiiDisconnectedAt] = useState<number | null>(null);\r\n\r\n\t// ‚òÖËøΩÂä†: „Äå‰∏ÄÂ∫¶„Åß„ÇÇÊ≠£Â∏∏„Å´Êé•Á∂ö„Åß„Åç„Å¶„ÅÑ„Åü„Åã„Äç„Çí‰øùÊåÅÔºàÊé•Á∂öÂ§±Êïó„ÅÆË™§ÁàÜÈò≤Ê≠¢Ôºâ\r\n\tconst wasConnectedRef = useRef(false);\r\n\t\t\r\n\t// ‚òÖËøΩÂä†: IR„Ç´„Éº„ÇΩ„É´Âà∂Âæ°„ÅÆÊúâÂäπ/ÁÑ°Âäπ\r\n\tconst [irCursorEnabled, setIrCursorEnabled] = useState(false);\r\n\tconst wsRef = useRef<WebSocket | null>(null);\r\n\r\n\t// (wsRef „ÅØ‰∏ä„ÅßÂÆöÁæ©Ê∏à„Åø)\r\n\r\n\t// „Äå„Åì„ÅÆ„Éï„É¨„Éº„É†„ÅßÊäº„Åï„Çå„Åü„ÄçÊÉÖÂ†±ÔºàWii + „Ç≠„Éº„Éú„Éº„ÉâÂêàÊàêÔºâ\r\n\tconst [pressed, setPressed] = useState<Partial<WiiState[\"buttons\"]>>({});\r\n\r\n\t// --- Wii „Åã„ÇâÊù•„ÇãÊäº‰∏ã„Éà„É™„Ç¨„ÉºÁî® ---\r\n\tconst pressedBufferRef = useRef<Partial<WiiState[\"buttons\"]>>({});\r\n\tconst prevButtonsRef = useRef<WiiState[\"buttons\"] | null>(null);\r\n\tconst lastUpdateRef = useRef<number>(0);\r\n\t// ‚òÖËøΩÂä†: ÊúÄÊñ∞„ÅÆWii„Éá„Éº„Çø„Çí‰øùÊåÅÔºàrAF„ÅßÂèÇÁÖßÔºâ\r\n\tconst latestWiiDataRef = useRef<WiiState | null>(null);\r\n\t// ‚òÖËøΩÂä†: pressedÁä∂ÊÖã„ÇíÁ¥ØÁ©ç„Åó„Å¶‰øùÊåÅ„Åó„ÄÅÊ¨°„ÅÆflush„ÅßÊ∂àË≤ª„Åô„Çã\r\n\tconst pendingPressedRef = useRef<Partial<WiiState[\"buttons\"]>>({});\r\n\r\n\t// --- „Ç≠„Éº„Éú„Éº„Éâ„ÅÆÊäº‰∏ãÁä∂ÊÖãÔºà„Éõ„Éº„É´„ÉâÔºâ ---\r\n\tconst kbButtonsRef = useRef<WiiState[\"buttons\"]>({ ...EMPTY_BUTTONS });\r\n\t// „Ç≠„Éº„Éú„Éº„Éâ„ÅÆ„Äå„Åì„ÅÆ„Éï„É¨„Éº„É†„ÅßÊäº„Åï„Çå„Åü„Äç\r\n\tconst kbPressedBufferRef = useRef<Partial<WiiState[\"buttons\"]>>({});\r\n\r\n\t// „Ç≠„Éº„Éú„Éº„Éâ„Ç§„Éô„É≥„ÉàË≥ºË™≠\r\n\tuseEffect(() => {\r\n\t\tconst onKeyDown = (e: KeyboardEvent) => {\r\n\t\t\tif (e.repeat) return;\r\n\t\t\tconst btn = keyToButton(e.key);\r\n\t\t\tif (!btn) return;\r\n\r\n\t\t\t// ÂÖ•Âäõ„ÇíÂ•™„ÅÑ„Åü„ÅÑÂ†¥Âêà„Å†„Åë preventDefaultÔºàÂøÖË¶Å„Å™„ÇâÂ§ñ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºâ\r\n\t\t\t// e.preventDefault();\r\n\r\n\t\t\tkbButtonsRef.current = { ...kbButtonsRef.current, [btn]: true };\r\n\t\t\tkbPressedBufferRef.current[btn] = true;\r\n\t\t};\r\n\r\n\t\tconst onKeyUp = (e: KeyboardEvent) => {\r\n\t\t\tconst btn = keyToButton(e.key);\r\n\t\t\tif (!btn) return;\r\n\t\t\tkbButtonsRef.current = { ...kbButtonsRef.current, [btn]: false };\r\n\t\t};\r\n\r\n\t\twindow.addEventListener(\"keydown\", onKeyDown);\r\n\t\twindow.addEventListener(\"keyup\", onKeyUp);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"keydown\", onKeyDown);\r\n\t\t\twindow.removeEventListener(\"keyup\", onKeyUp);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// WebSocket (Wii)\r\n\tuseEffect(() => {\r\n\t\tconst ws = new WebSocket(\"ws://localhost:8080\");\r\n\t\twsRef.current = ws; // WebSocket„Çí‰øùÊåÅ\r\n\r\n\t\tws.onopen = () => {\r\n\t\t\tconsole.log(\"Connected to Wii Server\");\r\n\t\t};\r\n\r\n\t\tws.onmessage = (event) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst msg = JSON.parse(event.data) as WiiServerMessage;\r\n\r\n\t\t\t\tif (msg && typeof msg === \"object\" && \"type\" in msg) {\r\n\t\t\t\t\tconst t = (msg as any).type;\r\n\r\n\t\t\t\t\tif (t === \"status\") {\r\n\t\t\t\t\t\tconst connected = !!(msg as any).connected;\r\n\t\t\t\t\t\tsetWiiConnected(connected);\r\n\t\t\t\t\t\twasConnectedRef.current = connected; // ‚òÖËøΩÂä†\r\n\t\t\t\t\t\t// IR„Ç´„Éº„ÇΩ„É´Áä∂ÊÖã„ÇÇÂèó‰ø°\r\n\t\t\t\t\t\tif (typeof (msg as any).irCursorEnabled === \"boolean\") {\r\n\t\t\t\t\t\t\tsetIrCursorEnabled((msg as any).irCursorEnabled);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (t === \"irCursorStatus\") {\r\n\t\t\t\t\t\tsetIrCursorEnabled(!!(msg as any).enabled);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (t === \"wiiDisconnected\") {\r\n\t\t\t\t\t\tsetWiiConnected(false);\r\n\t\t\t\t\t\twasConnectedRef.current = false; // ‚òÖËøΩÂä†\r\n\t\t\t\t\t\tsetWiiDisconnectedAt(typeof (msg as any).at === \"number\" ? (msg as any).at : Date.now());\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst data = msg as WiiState;\r\n\r\n\t\t\t\tsetWiiConnected(true);\r\n\t\t\t\twasConnectedRef.current = true; // ‚òÖËøΩÂä†: „Éá„Éº„Çø„ÅåÊù•„Å¶„ÅÑ„Çã=Êé•Á∂ö„Åß„Åç„Å¶„ÅÑ„Çã\r\n\r\n\t\t\t\t// WiiÂÅ¥„ÅÆ„ÄåÊäº„Åï„Çå„ÅüÁû¨Èñì„ÄçÊ§úÁü• - pressedBuffer„Å´ËøΩÂä†ÔºàrAF„ÅßÊ∂àË≤ªÔºâ\r\n\t\t\t\tif (prevButtonsRef.current) {\r\n\t\t\t\t\t(Object.keys(data.buttons) as Array<keyof WiiState[\"buttons\"]>).forEach((key) => {\r\n\t\t\t\t\t\tif (data.buttons[key] && !prevButtonsRef.current![key]) {\r\n\t\t\t\t\t\t\tpressedBufferRef.current[key] = true;\r\n\t\t\t\t\t\t\tconsole.log(`[WS] Button pressed detected: ${key}`); // „Éá„Éê„ÉÉ„Ç∞\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tprevButtonsRef.current = data.buttons;\r\n\r\n\t\t\t\t// ‚òÖ‰øÆÊ≠£: flushState„ÅØÂëº„Å∞„Åö„ÄÅÊúÄÊñ∞„Éá„Éº„Çø„ÇíRef„Å´‰øùÂ≠ò„Åô„Çã„Å†„Åë\r\n\t\t\t\t// rAF„É´„Éº„Éó„ÅßÁµ±‰∏ÄÁöÑ„Å´stateÊõ¥Êñ∞„Åô„Çã\r\n\t\t\t\tlatestWiiDataRef.current = data;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"Parse error:\", e);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// ‚òÖ‰øÆÊ≠£: „ÄåÊé•Á∂ö‰∏≠„Å´Âàá„Çå„Åü„ÄçÂ†¥Âêà„Å†„Åë disconnect Êâ±„ÅÑ„Å´„Åô„ÇãÔºàÊé•Á∂öÂ§±Êïó„ÅÆË™§ÁàÜÈò≤Ê≠¢Ôºâ\r\n\t\tws.onerror = () => {\r\n\t\t\tconst wasConnected = wasConnectedRef.current;\r\n\t\t\tsetWiiConnected(false);\r\n\t\t\twasConnectedRef.current = false;\r\n\r\n\t\t\tif (wasConnected) {\r\n\t\t\t\tsetWiiDisconnectedAt(Date.now());\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tws.onclose = () => {\r\n\t\t\tconst wasConnected = wasConnectedRef.current;\r\n\t\t\tsetWiiConnected(false);\r\n\t\t\twasConnectedRef.current = false;\r\n\r\n\t\t\tif (wasConnected) {\r\n\t\t\t\tsetWiiDisconnectedAt(Date.now());\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn () => {\r\n\t\t\ttry {\r\n\t\t\t\tws.close();\r\n\t\t\t} catch {}\r\n\t\t\twsRef.current = null; // WebSocket„Çí„ÇØ„É™„Ç¢\r\n\t\t};\r\n\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\t// ‚òÖ‰øÆÊ≠£: rAF„É´„Éº„Éó„ÅßstateÊõ¥Êñ∞ÔºàWebSocketÂèó‰ø°„Å®„ÅØÂàÜÈõ¢Ôºâ\r\n\tuseEffect(() => {\r\n\t\tlet raf = 0;\r\n\r\n\t\tconst loop = () => {\r\n\t\t\t// ÊúÄÊñ∞„ÅÆWii„Éá„Éº„Çø„ÇíÂèñÂæóÔºà„ÅÇ„Çå„Å∞Ôºâ\r\n\t\t\tconst wiiData = latestWiiDataRef.current;\r\n\t\t\tflushState(wiiData);\r\n\t\t\traf = window.requestAnimationFrame(loop);\r\n\t\t};\r\n\r\n\t\traf = window.requestAnimationFrame(loop);\r\n\t\treturn () => window.cancelAnimationFrame(raf);\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tconst flushState = (wiiDataOrNull: WiiState | null) => {\r\n\t\t// „ÇΩ„Éº„Çπ„ÅÆ buttons „ÇíÂêàÊàêÔºàWii„Åå„ÅÇ„Çå„Å∞ OR„ÄÅ„Å™„Åë„Çå„Å∞„Ç≠„Éº„Éú„Éº„Éâ„ÅÆ„ÅøÔºâ\r\n\t\tconst wiiButtons = wiiDataOrNull?.buttons ?? null;\r\n\t\tconst kbButtons = kbButtonsRef.current;\r\n\r\n\t\tconst mergedButtons: WiiState[\"buttons\"] = {\r\n\t\t\tA: (wiiButtons?.A ?? false) || kbButtons.A,\r\n\t\t\tB: (wiiButtons?.B ?? false) || kbButtons.B,\r\n\t\t\tOne: (wiiButtons?.One ?? false) || kbButtons.One,\r\n\t\t\tTwo: (wiiButtons?.Two ?? false) || kbButtons.Two,\r\n\t\t\tPlus: (wiiButtons?.Plus ?? false) || kbButtons.Plus,\r\n\t\t\tMinus: (wiiButtons?.Minus ?? false) || kbButtons.Minus,\r\n\t\t\tHome: (wiiButtons?.Home ?? false) || kbButtons.Home,\r\n\t\t\tUp: (wiiButtons?.Up ?? false) || kbButtons.Up,\r\n\t\t\tDown: (wiiButtons?.Down ?? false) || kbButtons.Down,\r\n\t\t\tRight: (wiiButtons?.Right ?? false) || kbButtons.Right,\r\n\t\t\tLeft: (wiiButtons?.Left ?? false) || kbButtons.Left,\r\n\t\t};\r\n\r\n\t\t// ‚òÖ‰øÆÊ≠£: Êñ∞„Åó„ÅèÊäº„Åï„Çå„Åü„Éú„Çø„É≥„ÇíÁ¥ØÁ©ç„Éê„ÉÉ„Éï„Ç°„Å´ËøΩÂä†\r\n\t\tfor (const key of Object.keys(pressedBufferRef.current)) {\r\n\t\t\tpendingPressedRef.current[key as keyof WiiState[\"buttons\"]] = true;\r\n\t\t}\r\n\t\tfor (const key of Object.keys(kbPressedBufferRef.current)) {\r\n\t\t\tpendingPressedRef.current[key as keyof WiiState[\"buttons\"]] = true;\r\n\t\t}\r\n\t\tpressedBufferRef.current = {};\r\n\t\tkbPressedBufferRef.current = {};\r\n\r\n\t\t// ‚òÖ‰øÆÊ≠£: Á¥ØÁ©ç„Éê„ÉÉ„Éï„Ç°„Åã„ÇâÁèæÂú®„ÅÆpressed„ÇíÂèñÂæó„Åó„ÄÅ„Éê„ÉÉ„Éï„Ç°„Çí„ÇØ„É™„Ç¢\r\n\t\tconst mergedPressed: Partial<WiiState[\"buttons\"]> = { ...pendingPressedRef.current };\r\n\t\tpendingPressedRef.current = {};\r\n\r\n\t\t// ‚òÖ„Éá„Éê„ÉÉ„Ç∞: Êäº„Åï„Çå„Åü„Éú„Çø„É≥„Åå„ÅÇ„Çå„Å∞„É≠„Ç∞Âá∫Âäõ\r\n\t\tconst pressedKeys = Object.keys(mergedPressed).filter(k => (mergedPressed as Record<string, boolean>)[k]);\r\n\t\tif (pressedKeys.length > 0) {\r\n\t\t\tconsole.log(`[flushState] Pressed buttons: ${pressedKeys.join(', ')}`);\r\n\t\t}\r\n\r\n\t\t// accel/ir „ÅØ Wii „ÅåÁÑ°„Åë„Çå„Å∞„ÉÄ„Éü„Éº\r\n\t\tconst mergedState: WiiState = {\r\n\t\t\tbuttons: mergedButtons,\r\n\t\t\taccel: wiiDataOrNull?.accel ?? { x: 0, y: 0, z: 0 },\r\n\t\t\tir: wiiDataOrNull?.ir ?? [],\r\n\t\t\tcursor: wiiDataOrNull?.cursor ?? null, // ‚òÖËøΩÂä†\r\n\t\t};\r\n\r\n\t\tsetWiiState(mergedState);\r\n\t\tsetPressed(mergedPressed);\r\n\t};\r\n\r\n\t// WiiÂÅ¥„ÅßÈü≥„ÇíÈ≥¥„Çâ„ÅôÔºàWebSocketÁµåÁî±Ôºâ\r\n\tconst playWiiSound = (soundType: 'shot' | 'oh' | 'uxo') => {\r\n\t\tif (!wsRef.current || wsRef.current.readyState !== WebSocket.OPEN) {\r\n\t\t\tconsole.warn('Cannot play sound: WebSocket not connected');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\twsRef.current.send(JSON.stringify({ type: 'playSound', soundType }));\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('Failed to send playSound message:', e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst setIrCursorEnabledFn = (enabled: boolean) => {\r\n\t\tsetIrCursorEnabled(enabled);\r\n\t\tif (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\r\n\t\t\ttry {\r\n\t\t\t\twsRef.current.send(JSON.stringify({ type: \"setIrCursor\", enabled }));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('Failed to send setIrCursor message:', e);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\twiiState,\r\n\t\tpressed,\r\n\t\twiiConnected,\r\n\t\twiiDisconnectedAt,\r\n\t\tirCursorEnabled,\r\n\t\tsetIrCursorEnabled: setIrCursorEnabledFn,\r\n\t\tplayWiiSound,\r\n\t};\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 470, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/ReactionOverlay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\n\r\ntype ReactionType = \"clap\" | \"laugh\";\r\n\r\ntype Reaction = {\r\n    id: string;\r\n    type: ReactionType;\r\n    createdAt: number;\r\n    x: number; // 0..1 (È†òÂüüÂÜÖ„ÅÆÊ®™ÊñπÂêë)\r\n    size: number; // px\r\n    durationMs: number;\r\n    rotateDeg: number;\r\n};\r\n\r\nexport function ReactionOverlay(props: {\r\n    emitClap?: boolean;\r\n    emitLaugh?: boolean;\r\n}) {\r\n    const { emitClap, emitLaugh } = props;\r\n    const [items, setItems] = useState<Reaction[]>([]);\r\n\r\n    // „Åì„Åì„ÇíÂ§âÊõ¥„Åô„Çã„Å®ÂÖ®‰Ωì„ÅÆÂ§ß„Åç„Åï„ÇíÂõ∫ÂÆö„ÅßÂ§â„Åà„Çâ„Çå„Åæ„ÅôÔºà‰æã: 2.5 => Á¥Ñ2.5ÂÄçÔºâ\r\n    const SCALE = 3.5;\r\n\r\n    const add = (type: ReactionType) => {\r\n        const now = Date.now();\r\n        const r: Reaction = {\r\n            id: `${now}-${Math.random().toString(16).slice(2)}`,\r\n            type,\r\n            createdAt: now,\r\n            // Âè≥‰∏ã„ÅÆÁã≠„ÅÑÁØÑÂõ≤„ÅßÂ∞ë„Åó„Å†„ÅëÂ∑¶Âè≥„Å´Êï£„ÇãÔºà„Ç§„É≥„Çπ„Çø„ÅÆ„Éè„Éº„Éà„Å£„ÅΩ„ÅïÔºâ\r\n            x: 0.65 + Math.random() * 0.3,\r\n            // ÂøÖË¶Å„Å™„Çâ„Åì„Åì„ÅÆ„Éô„Éº„ÇπÂÄ§(ÁèæÂú®40)„ÇíÂ§â„Åà„Çã„Å®Êõ¥„Å´Â§ß„Åç„Åè„Åß„Åç„Åæ„Åô\r\n            size: 26 + Math.floor(Math.random() * 18),\r\n            durationMs: 1200 + Math.floor(Math.random() * 700),\r\n            rotateDeg: -10 + Math.random() * 20,\r\n        };\r\n        setItems((prev) => [...prev, r]);\r\n    };\r\n\r\n    // ÔºàÁîªÈù¢„Çµ„Ç§„Ç∫‰æùÂ≠ò„ÅÆ„Çπ„Ç±„Éº„É´Ë®àÁÆó„ÅØÈô§Âéª„Åó„Å¶Âõ∫ÂÆö„Çπ„Ç±„Éº„É´„Çí‰Ωø„ÅÜÔºâ\r\n    // „Äå„Åù„ÅÆ„Éï„É¨„Éº„É†„Å†„Åë true„Äç„ÅåÊù•„ÇãÂâçÊèêÔºàpressed.* „Çí„Åù„ÅÆ„Åæ„ÅæÊ∏°„Åõ„Å∞OKÔºâ\r\n    useEffect(() => {\r\n        if (emitClap) add(\"clap\");\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [emitClap]);\r\n\r\n    useEffect(() => {\r\n        if (emitLaugh) add(\"laugh\");\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [emitLaugh]);\r\n\r\n    // ÊéÉÈô§\r\n    useEffect(() => {\r\n        const t = setInterval(() => {\r\n            const now = Date.now();\r\n            setItems((prev) => prev.filter((r) => now - r.createdAt < r.durationMs + 250));\r\n        }, 250);\r\n        return () => clearInterval(t);\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            aria-hidden\r\n            style={{\r\n                position: \"absolute\",\r\n                right: 24,\r\n                bottom: 24,\r\n                width: 240,\r\n                // È´ò„Åï„ÇíÂ¢ó„ÇÑ„Åó„Å¶„Çà„Çä‰∏ä„Åæ„ÅßË°®Á§∫„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åô„Çã\r\n                height: 420,\r\n                pointerEvents: \"none\",\r\n                overflow: \"hidden\",\r\n                zIndex: 10001, // „Çπ„É©„Ç§„Éâ„Çà„ÇäÂâç„ÄÅÊàª„Çã„Éú„Çø„É≥„Å®ÂêåÁ≠â„Çà„ÇäÂ∞ë„Åó‰∏ä\r\n                transform: `scale(${SCALE})`,\r\n                transformOrigin: \"right bottom\",\r\n            }}\r\n        >\r\n            {items.map((r) => (\r\n                <ReactionItem key={r.id} r={r} />\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction ReactionItem({ r }: { r: Reaction }) {\r\n    const glyph = r.type === \"clap\" ? \"üëè\" : \"üòÜ\";\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                position: \"absolute\",\r\n                bottom: 0,\r\n                left: `${Math.round(r.x * 100)}%`,\r\n                fontSize: r.size,\r\n                transform: `translateX(-50%) rotate(${r.rotateDeg}deg)`,\r\n                willChange: \"transform, opacity\",\r\n                animation: `reaction-float ${r.durationMs}ms ease-out forwards`,\r\n                filter: \"drop-shadow(0 8px 12px rgba(0,0,0,0.35))\"  ,\r\n                userSelect: \"none\",\r\n            }}\r\n        >\r\n            {glyph}\r\n            <style jsx>{`\r\n                @keyframes reaction-float {\r\n                    0% {\r\n                        opacity: 0;\r\n                        transform: translateX(-50%) translateY(14px) scale(0.9) rotate(${r.rotateDeg}deg);\r\n                    }\r\n                    12% {\r\n                        opacity: 0.95;\r\n                        transform: translateX(-50%) translateY(0px) scale(1) rotate(${r.rotateDeg}deg);\r\n                    }\r\n                    100% {\r\n                        opacity: 0;\r\n                        /* „Åì„Åì„ÇíÂ§ß„Åç„Åè„Åô„Çã„Å®„Çà„Çä‰∏ä„Åæ„ÅßÊµÆ„Åã„Åõ„Çâ„Çå„Åæ„ÅôÔºàÁèæÂú® -420pxÔºâ */\r\n                        transform: translateX(-50%) translateY(-420px) scale(1.08) rotate(${r.rotateDeg}deg);\r\n                    }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":";;;;;;AAEA;AAFA;;;;AAgBO,SAAS,gBAAgB,KAG/B;IACG,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG;IAChC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,qPAAQ,EAAa,EAAE;IAEjD,4CAA4C;IAC5C,MAAM,QAAQ;IAEd,MAAM,MAAM,CAAC;QACT,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,IAAc;YAChB,IAAI,GAAG,IAAI,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,IAAI;YACnD;YACA,WAAW;YACX,iCAAiC;YACjC,GAAG,OAAO,KAAK,MAAM,KAAK;YAC1B,kCAAkC;YAClC,MAAM,KAAK,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;YACtC,YAAY,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;YAC9C,WAAW,CAAC,KAAK,KAAK,MAAM,KAAK;QACrC;QACA,SAAS,CAAC,OAAS;mBAAI;gBAAM;aAAE;IACnC;IAEA,iCAAiC;IACjC,6CAA6C;IAC7C,IAAA,sPAAS,EAAC;QACN,IAAI,UAAU,IAAI;IAClB,uDAAuD;IAC3D,GAAG;QAAC;KAAS;IAEb,IAAA,sPAAS,EAAC;QACN,IAAI,WAAW,IAAI;IACnB,uDAAuD;IAC3D,GAAG;QAAC;KAAU;IAEd,KAAK;IACL,IAAA,sPAAS,EAAC;QACN,MAAM,IAAI,YAAY;YAClB,MAAM,MAAM,KAAK,GAAG;YACpB,SAAS,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,IAAM,MAAM,EAAE,SAAS,GAAG,EAAE,UAAU,GAAG;QAC7E,GAAG;QACH,OAAO,IAAM,cAAc;IAC/B,GAAG,EAAE;IAEL,qBACI,kRAAC;QACG,aAAW;QACX,OAAO;YACH,UAAU;YACV,OAAO;YACP,QAAQ;YACR,OAAO;YACP,yBAAyB;YACzB,QAAQ;YACR,eAAe;YACf,UAAU;YACV,QAAQ;YACR,WAAW,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5B,iBAAiB;QACrB;kBAEC,MAAM,GAAG,CAAC,CAAC,kBACR,kRAAC;gBAAwB,GAAG;eAAT,EAAE,EAAE;;;;;;;;;;AAIvC;AAEA,SAAS,aAAa,EAAE,CAAC,EAAmB;IACxC,MAAM,QAAQ,EAAE,IAAI,KAAK,SAAS,OAAO;IAEzC,qBACI,kRAAC;QACG,OAAO;YACH,UAAU;YACV,QAAQ;YACR,MAAM,GAAG,KAAK,KAAK,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,CAAC;YACjC,UAAU,EAAE,IAAI;YAChB,WAAW,CAAC,wBAAwB,EAAE,EAAE,SAAS,CAAC,IAAI,CAAC;YACvD,YAAY;YACZ,WAAW,CAAC,eAAe,EAAE,EAAE,UAAU,CAAC,oBAAoB,CAAC;YAC/D,QAAQ;YACR,YAAY;QAChB;;;;;oBAO6E,EAAE,SAAS;oBAId,EAAE,SAAS;oBAKL,EAAE,SAAS;;;;;YAd1F;;;;oBAK4E,EAAE,SAAS;oBAId,EAAE,SAAS;oBAKL,EAAE,SAAS;;8HATd,EAAE,SAAS,gFAId,EAAE,SAAS,mFAKL,EAAE,SAAS;;;;;;;;AAMvG"}},
    {"offset": {"line": 600, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/buttonBindings.ts"],"sourcesContent":["import type { WiiState } from \"@/hooks/useWiiController\";\r\n\r\nexport type WiiButton = keyof WiiState[\"buttons\"];\r\n\r\nexport type BindingAction =\r\n\t| { type: \"none\"; subtype?: string }\r\n\t| { type: \"next\" }\r\n\t| { type: \"prev\" }\r\n\t| { type: \"branch\"; kind: \"A\" | \"B\" | \"HOME\" }\r\n\t| { type: \"branchIndex\"; index: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 }\r\n\t| { type: \"reaction\"; kind: \"clap\" | \"laugh\" }\r\n\t| { type: \"paint\" }\r\n\t| { type: \"eraser\" }\r\n    | { type: \"sound\"; kind: \"shot\" | \"oh\" | \"uxo\"; outputDevice?: \"pc\" | \"wii\" }\r\n    | { type: \"remove\" }\r\n    | { type: \"irSens\" }; // ‚òÖËøΩÂä†: IR„Çª„É≥„Çµ„Éº„Ç´„Éº„ÇΩ„É´ÂàáÊõø\r\n\r\nexport type ButtonBindings = Partial<Record<WiiButton, BindingAction>>;\r\n\r\n// Èü≥Â£∞Âá∫Âäõ„Éá„Éê„Ç§„Çπ„ÅÆË®≠ÂÆö\r\nexport type SoundOutputDevice = \"pc\" | \"wii\";\r\n\r\nexport interface SoundSettings {\r\n\toutputDevice: SoundOutputDevice;\r\n}\r\n\r\nexport const DEFAULT_SOUND_SETTINGS: SoundSettings = {\r\n\toutputDevice: \"pc\",\r\n};\r\n\r\nexport const DEFAULT_BINDINGS: ButtonBindings = {\r\n\tRight: { type: \"next\" },\r\n\tLeft: { type: \"prev\" },\r\n\tPlus: { type: \"branch\", kind: \"A\" },\r\n\tMinus: { type: \"branch\", kind: \"B\" },\r\n\tHome: { type: \"branch\", kind: \"HOME\" },\r\n\tOne: { type: \"reaction\", kind: \"clap\" },\r\n\tTwo: { type: \"reaction\", kind: \"laugh\" },\r\n};\r\n\r\nexport function formatAction(a: BindingAction): string {\r\n\tswitch (a.type) {\r\n\t\tcase \"none\":\r\n\t\t\treturn \"Êú™Ââ≤ÂΩì\";\r\n\t\tcase \"next\":\r\n\t\t\treturn \"Ê¨°„Å∏\";\r\n\t\tcase \"prev\":\r\n\t\t\treturn \"Êàª„Çã\";\r\n\t\tcase \"branch\":\r\n\t\t\tswitch (a.kind) {\r\n\t\t\t\tcase \"A\":\r\n\t\t\t\t\treturn \"A„É´„Éº„Éà„Å∏ÂàÜÂ≤ê\";\r\n\t\t\t\tcase \"B\":\r\n\t\t\t\t\treturn \"B„É´„Éº„Éà„Å∏ÂàÜÂ≤ê\";\r\n\t\t\t\tcase \"HOME\":\r\n\t\t\t\t\treturn \"HOME„Å∏Êàª„Çã\";\r\n\t\t\t}\r\n\t\tcase \"branchIndex\":\r\n\t\t\treturn `ÂàÜÂ≤ê ${a.index}`;\r\n\t\tcase \"reaction\":\r\n\t\t\treturn a.kind === \"clap\" ? \"ÊãçÊâã\" : \"Á¨ë„ÅÑ\";\r\n\t\tcase \"paint\":\r\n\t\t\treturn \"PAINTüé®\";\r\n\t\tcase \"eraser\":\r\n\t\t\treturn \"ERASER\";\r\n\t\tcase \"sound\": {\r\n\t\t\tconst device = a.outputDevice === \"wii\" ? \"[Wii]\" : \"[PC]\";\r\n\t\t\tswitch (a.kind) {\r\n\t\t\t\tcase \"shot\":\r\n\t\t\t\t\treturn `SHOTüîä${device}`;\r\n\t\t\t\tcase \"oh\":\r\n\t\t\t\t\treturn `Oh...üîä${device}`;\r\n\t\t\t\tcase \"uxo\":\r\n\t\t\t\t\treturn `Uxo~üîä${device}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase \"remove\":\r\n\t\t\treturn \"REMOVE\";\r\n\t\tcase \"irSens\":\r\n\t\t\treturn \"IRSensÂàáÊõø\";\r\n\t}\r\n}\r\n\r\nexport function mergeBindings(bindings?: ButtonBindings): ButtonBindings {\r\n\treturn {\r\n\t\t...DEFAULT_BINDINGS,\r\n\t\t...(bindings ?? {}),\r\n\t};\r\n}\r\n\r\nexport function encodeAction(a: BindingAction): string {\r\n\treturn JSON.stringify(a);\r\n}\r\n\r\nexport function decodeAction(s: string): BindingAction {\r\n\treturn JSON.parse(s) as BindingAction;\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AA0BO,MAAM,yBAAwC;IACpD,cAAc;AACf;AAEO,MAAM,mBAAmC;IAC/C,OAAO;QAAE,MAAM;IAAO;IACtB,MAAM;QAAE,MAAM;IAAO;IACrB,MAAM;QAAE,MAAM;QAAU,MAAM;IAAI;IAClC,OAAO;QAAE,MAAM;QAAU,MAAM;IAAI;IACnC,MAAM;QAAE,MAAM;QAAU,MAAM;IAAO;IACrC,KAAK;QAAE,MAAM;QAAY,MAAM;IAAO;IACtC,KAAK;QAAE,MAAM;QAAY,MAAM;IAAQ;AACxC;AAEO,SAAS,aAAa,CAAgB;IAC5C,OAAQ,EAAE,IAAI;QACb,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAQ,EAAE,IAAI;gBACb,KAAK;oBACJ,OAAO;gBACR,KAAK;oBACJ,OAAO;gBACR,KAAK;oBACJ,OAAO;YACT;QACD,KAAK;YACJ,OAAO,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE;QACvB,KAAK;YACJ,OAAO,EAAE,IAAI,KAAK,SAAS,OAAO;QACnC,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;QACR,KAAK;YAAS;gBACb,MAAM,SAAS,EAAE,YAAY,KAAK,QAAQ,UAAU;gBACpD,OAAQ,EAAE,IAAI;oBACb,KAAK;wBACJ,OAAO,CAAC,MAAM,EAAE,QAAQ;oBACzB,KAAK;wBACJ,OAAO,CAAC,OAAO,EAAE,QAAQ;oBAC1B,KAAK;wBACJ,OAAO,CAAC,MAAM,EAAE,QAAQ;gBAC1B;YACD;QACA,KAAK;YACJ,OAAO;QACR,KAAK;YACJ,OAAO;IACT;AACD;AAEO,SAAS,cAAc,QAAyB;IACtD,OAAO;QACN,GAAG,gBAAgB;QACnB,GAAI,YAAY,CAAC,CAAC;IACnB;AACD;AAEO,SAAS,aAAa,CAAgB;IAC5C,OAAO,KAAK,SAAS,CAAC;AACvB;AAEO,SAAS,aAAa,CAAS;IACrC,OAAO,KAAK,KAAK,CAAC;AACnB"}},
    {"offset": {"line": 704, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/WiiDebugPanel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\nimport type { BindingAction, ButtonBindings } from \"@/lib/buttonBindings\";\r\nimport { formatAction } from \"@/lib/buttonBindings\";\r\n\r\ntype WiiDebugPanelProps = {\r\n\twiiState: WiiState | null;\r\n\tpressed: Record<string, boolean>;\r\n\teffectiveProjectBindings: ButtonBindings;\r\n\tirCursorEnabled?: boolean;\r\n\tonToggleIrCursor?: () => void;\r\n};\r\n\r\nexport function WiiDebugPanel({ wiiState, pressed, effectiveProjectBindings, irCursorEnabled, onToggleIrCursor }: WiiDebugPanelProps) {\r\n\t// Ë°®Á§∫Áî®„ÅÆÂÄ§„Çí‰øùÊåÅ\r\n\tconst [displayAccel, setDisplayAccel] = useState({ x: 0, y: 0, z: 0 });\r\n\tconst displayIrCountRef = useRef(0);\r\n\tconst displayButtonsRef = useRef(\"(none)\");\r\n\tconst displayBindingsRef = useRef<string[]>([]);\r\n\tconst lastAccelUpdateRef = useRef(0);\r\n\r\n\t// Âä†ÈÄüÂ∫¶„Çª„É≥„Çµ„Éº„ÅÆÊõ¥Êñ∞Ôºà200ms„Åî„Å®„Å´Êõ¥Êñ∞Ôºâ\r\n\tuseEffect(() => {\r\n\t\tif (!wiiState || !wiiState.accel) return;\r\n\r\n\t\tconst now = Date.now();\r\n\t\tconst timeSinceLastUpdate = now - lastAccelUpdateRef.current;\r\n\r\n\t\t// 200msÁµåÈÅé„Åó„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„ÅøÊõ¥Êñ∞\r\n\t\tif (timeSinceLastUpdate >= 200) {\r\n\t\t\tconst current = wiiState.accel;\r\n\t\t\t\r\n\t\t\t// ÂÖ®„Å¶0„ÅÆÂ†¥Âêà„ÅØÁÑ°Ë¶ñÔºàÁÑ°Âäπ„Å™„Éá„Éº„ÇøÔºâ\r\n\t\t\tif (current.x === 0 && current.y === 0 && current.z === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsetDisplayAccel(prev => {\r\n\t\t\t\t// ÂÄ§„ÅåÂ§â„Çè„Å£„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„ÅøÊõ¥Êñ∞\r\n\t\t\t\tif (current.x !== prev.x || current.y !== prev.y || current.z !== prev.z) {\r\n\t\t\t\t\tlastAccelUpdateRef.current = now;\r\n\t\t\t\t\treturn { x: current.x, y: current.y, z: current.z };\r\n\t\t\t\t}\r\n\t\t\t\treturn prev;\r\n\t\t\t});\r\n\t\t}\r\n\t}, [wiiState]);\r\n\r\n\t// IR„Ç´„É°„É©„ÅÆÊõ¥Êñ∞Ôºà„É¨„É≥„ÉÄ„É™„É≥„Ç∞‰∏≠„Å´Áõ¥Êé•Êõ¥Êñ∞Ôºâ\r\n\tif (wiiState && wiiState.ir) {\r\n\t\tconst currentCount = wiiState.ir.length;\r\n\t\tconst prevCount = displayIrCountRef.current;\r\n\t\t\r\n\t\tif (currentCount !== prevCount) {\r\n\t\t\tdisplayIrCountRef.current = currentCount;\r\n\t\t}\r\n\t}\r\n\r\n\t// „Éú„Çø„É≥„ÅÆÊõ¥Êñ∞ÔºàÊäº„Åï„Çå„Å¶„ÅÑ„Çã„Éú„Çø„É≥„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆ„ÅøÊõ¥Êñ∞Ôºâ\r\n\tconst on: string[] = [];\r\n\tfor (const [btn, isDown] of Object.entries(pressed) as Array<[string, unknown]>) {\r\n\t\tif (isDown) on.push(btn);\r\n\t}\r\n\t// „Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„ÅøÊõ¥Êñ∞Ôºà‰Ωï„ÇÇÊäº„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØÂâçÂõû„ÅÆÂÄ§„Çí‰øùÊåÅÔºâ\r\n\tif (on.length > 0) {\r\n\t\tconst currentButtons = on.join(\", \");\r\n\t\tdisplayButtonsRef.current = currentButtons;\r\n\t}\r\n\r\n\t// „Éê„Ç§„É≥„Éá„Ç£„É≥„Ç∞ÊÉÖÂ†±„ÅÆÊõ¥Êñ∞Ôºà„É¨„É≥„ÉÄ„É™„É≥„Ç∞‰∏≠„Å´Áõ¥Êé•Êõ¥Êñ∞Ôºâ\r\n\tconst entries = Object.entries(effectiveProjectBindings) as Array<[string, BindingAction | undefined]>;\r\n\t\r\n\t// ÊåáÂÆö„Åï„Çå„ÅüÈ†ÜÂ∫è„Åß„ÇΩ„Éº„ÉàÔºà„Éú„Çø„É≥Âêç„ÅÆÂ§ßÊñáÂ≠óÂ∞èÊñáÂ≠ó„Å´Ê≥®ÊÑèÔºâ\r\n\tconst buttonOrder = [\"Up\", \"Down\", \"Right\", \"Left\", \"A\", \"B\", \"Minus\", \"Home\", \"Plus\", \"One\", \"Two\"];\r\n\tentries.sort((a, b) => {\r\n\t\tconst indexA = buttonOrder.indexOf(a[0]);\r\n\t\tconst indexB = buttonOrder.indexOf(b[0]);\r\n\t\t// ‰∏°Êñπ„Å®„ÇÇÈ†ÜÂ∫è„É™„Çπ„Éà„Å´„ÅÇ„ÇãÂ†¥Âêà„ÅØÈ†ÜÂ∫è„Å´Âæì„ÅÜ\r\n\t\tif (indexA !== -1 && indexB !== -1) return indexA - indexB;\r\n\t\t// a„ÅÆ„ÅøÈ†ÜÂ∫è„É™„Çπ„Éà„Å´„ÅÇ„ÇãÂ†¥Âêà„ÅØa„ÇíÂâç„Å´\r\n\t\tif (indexA !== -1) return -1;\r\n\t\t// b„ÅÆ„ÅøÈ†ÜÂ∫è„É™„Çπ„Éà„Å´„ÅÇ„ÇãÂ†¥Âêà„ÅØb„ÇíÂâç„Å´\r\n\t\tif (indexB !== -1) return 1;\r\n\t\t// ‰∏°Êñπ„Å®„ÇÇÈ†ÜÂ∫è„É™„Çπ„Éà„Å´„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç¢„É´„Éï„Ç°„Éô„ÉÉ„ÉàÈ†Ü\r\n\t\treturn a[0].localeCompare(b[0]);\r\n\t});\r\n\t\r\n\tconst currentBindings = entries.map(\r\n\t\t([btn, action]) => `${btn.padEnd(8)} ‚Üí ${action ? formatAction(action) : \"(unassigned)\"}`\r\n\t);\r\n\t\r\n\tconst prevBindings = displayBindingsRef.current;\r\n\tconst hasChanged = \r\n\t\tcurrentBindings.length !== prevBindings.length ||\r\n\t\tcurrentBindings.some((line, i) => line !== prevBindings[i]);\r\n\t\r\n\tif (hasChanged) {\r\n\t\tdisplayBindingsRef.current = currentBindings;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\ttop: 20,\r\n\t\t\t\tright: 20,\r\n\t\t\t\tbackground: \"rgba(0,0,0,0.82)\",\r\n\t\t\t\tcolor: \"#d1fae5\",\r\n\t\t\t\tpadding: \"12px 14px\",\r\n\t\t\t\tborderRadius: 10,\r\n\t\t\t\tfontSize: 14,\r\n\t\t\t\tfontFamily:\r\n\t\t\t\t\t\"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\",\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t\tpointerEvents: \"auto\",\r\n\t\t\t\tminWidth: 360,\r\n\t\t\t\twhiteSpace: \"pre\",\r\n\t\t\t\tlineHeight: 1.35,\r\n\t\t\t\tborder: \"1px solid rgba(255,255,255,0.12)\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<div style={{ fontWeight: 800, color: \"#a7f3d0\", marginBottom: 8 }}>Wii Debug</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>\r\n\t\t\t\tAcc: X={String(displayAccel.x).padStart(3)} Y={String(displayAccel.y).padStart(3)} Z={String(\r\n\t\t\t\t\tdisplayAccel.z,\r\n\t\t\t\t).padStart(3)}\r\n\t\t\t</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>IR : {displayIrCountRef.current}</div>\r\n\t\t\t<div style={{ color: \"rgba(209,250,229,0.9)\" }}>{`Btn: ${displayButtonsRef.current}`}</div>\r\n\t\t\t\r\n\t\t\t{/* IR„Ç´„Éº„ÇΩ„É´Âà∂Âæ°„Éà„Ç∞„É´ */}\r\n\t\t\t{onToggleIrCursor && (\r\n\t\t\t\t<div style={{ marginTop: 8 }}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onToggleIrCursor}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackground: irCursorEnabled ? \"#10b981\" : \"#374151\",\r\n\t\t\t\t\t\t\tcolor: \"#fff\",\r\n\t\t\t\t\t\t\tborder: \"none\",\r\n\t\t\t\t\t\t\tborderRadius: 6,\r\n\t\t\t\t\t\t\tpadding: \"6px 12px\",\r\n\t\t\t\t\t\t\tcursor: \"pointer\",\r\n\t\t\t\t\t\t\tfontWeight: 700,\r\n\t\t\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{irCursorEnabled ? \"IR Cursor: ON\" : \"IR Cursor: OFF\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t\r\n\t\t\t<div style={{ margin: \"10px 0\", borderTop: \"1px solid rgba(255,255,255,0.12)\" }} />\r\n\t\t\t<div style={{ fontWeight: 800, color: \"#a7f3d0\", marginBottom: 6 }}>Bindings (project)</div>\r\n\t\t\t{displayBindingsRef.current.map((line) => (\r\n\t\t\t\t<div key={line}>{line}</div>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 945, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/projectBindingsStorage.ts"],"sourcesContent":["import type { ButtonBindings } from \"@/lib/buttonBindings\";\r\n\r\nfunction key(projectId: string) {\r\n    return `wiiSugeee:projectBindings:${projectId}`;\r\n}\r\n\r\nexport function loadProjectBindings(projectId: string): ButtonBindings | undefined {\r\n    try {\r\n        const raw = localStorage.getItem(key(projectId));\r\n        if (!raw) return undefined;\r\n        return JSON.parse(raw) as ButtonBindings;\r\n    } catch {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nexport function saveProjectBindings(projectId: string, bindings: ButtonBindings) {\r\n    try {\r\n        localStorage.setItem(key(projectId), JSON.stringify(bindings));\r\n    } catch {\r\n        // ignore\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA,SAAS,IAAI,SAAiB;IAC1B,OAAO,CAAC,0BAA0B,EAAE,WAAW;AACnD;AAEO,SAAS,oBAAoB,SAAiB;IACjD,IAAI;QACA,MAAM,MAAM,aAAa,OAAO,CAAC,IAAI;QACrC,IAAI,CAAC,KAAK,OAAO;QACjB,OAAO,KAAK,KAAK,CAAC;IACtB,EAAE,OAAM;QACJ,OAAO;IACX;AACJ;AAEO,SAAS,oBAAoB,SAAiB,EAAE,QAAwB;IAC3E,IAAI;QACA,aAAa,OAAO,CAAC,IAAI,YAAY,KAAK,SAAS,CAAC;IACxD,EAAE,OAAM;IACJ,SAAS;IACb;AACJ"}},
    {"offset": {"line": 974, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/lib/currentProjectStore.ts"],"sourcesContent":["import type { SerializedFlow } from \"@/lib/presentation\";\r\nimport type { ButtonBindings, SoundSettings } from \"@/lib/buttonBindings\";\r\nimport { DEFAULT_SOUND_SETTINGS } from \"@/lib/buttonBindings\";\r\nimport { loadProjectBindings, saveProjectBindings } from \"@/lib/projectBindingsStorage\";\r\n\r\ntype Listener = () => void;\r\n\r\nlet currentFlow: SerializedFlow | null = null;\r\nlet currentProjectId = \"default\"; // ‚òÖËøΩÂä†\r\nconst listeners = new Set<Listener>();\r\n\r\nexport function setCurrentProjectId(projectId: string) {\r\n    currentProjectId = projectId || \"default\";\r\n    for (const l of listeners) l();\r\n}\r\n\r\nexport function getCurrentProjectId() {\r\n    return currentProjectId;\r\n}\r\n\r\nexport function getCurrentFlow(): SerializedFlow | null {\r\n    return currentFlow;\r\n}\r\n\r\nexport function setCurrentFlow(flow: SerializedFlow | null) {\r\n    if (flow) {\r\n        const stored = typeof window !== \"undefined\" ? loadProjectBindings(currentProjectId) : undefined;\r\n        currentFlow = stored ? { ...flow, projectBindings: stored } : flow;\r\n    } else {\r\n        currentFlow = null;\r\n    }\r\n    for (const l of listeners) l();\r\n}\r\n\r\nexport function subscribeCurrentFlow(listener: Listener) {\r\n    listeners.add(listener);\r\n    return () => listeners.delete(listener);\r\n}\r\n\r\nexport function getProjectBindings(): ButtonBindings | undefined {\r\n    // ‚òÖ‰øÆÊ≠£: currentFlow„Å´ÁÑ°„Åè„Å¶„ÇÇ localStorage „Åã„ÇâË™≠„ÇÅ„Çã„Çà„ÅÜ„Å´„Åô„Çã\r\n    if (currentFlow?.projectBindings) {\r\n        console.log(\"[Bindings] Loaded from currentFlow:\", currentFlow.projectBindings);\r\n        return currentFlow.projectBindings;\r\n    }\r\n    if (typeof window === \"undefined\") return undefined;\r\n    const stored = loadProjectBindings(currentProjectId);\r\n    console.log(`[Bindings] Loaded from localStorage (projectId: ${currentProjectId}):`, stored);\r\n    return stored;\r\n}\r\n\r\nexport function setProjectBindings(bindings: ButtonBindings) {\r\n    // ‚òÖ‰øÆÊ≠£: currentFlow„ÅåÁÑ°„Åè„Å¶„ÇÇ‰øùÂ≠ò„ÅØ„Åß„Åç„Çã\r\n    if (currentFlow) {\r\n        currentFlow = { ...currentFlow, projectBindings: bindings };\r\n    }\r\n\r\n    if (typeof window !== \"undefined\") {\r\n        saveProjectBindings(currentProjectId, bindings);\r\n    }\r\n\r\n    for (const l of listeners) l();\r\n}\r\n\r\n// Èü≥Â£∞Ë®≠ÂÆö„ÅÆ‰øùÂ≠ò„ÉªË™≠„ÅøËæº„Åø\r\nconst SOUND_SETTINGS_KEY_PREFIX = \"wiiSugeee_soundSettings_\";\r\n\r\nexport function getSoundSettings(): SoundSettings {\r\n    if (typeof window === \"undefined\") {\r\n        return { ...DEFAULT_SOUND_SETTINGS } as SoundSettings;\r\n    }\r\n    \r\n    const key = SOUND_SETTINGS_KEY_PREFIX + currentProjectId;\r\n    const stored = localStorage.getItem(key);\r\n    \r\n    if (!stored) {\r\n        return { ...DEFAULT_SOUND_SETTINGS } as SoundSettings;\r\n    }\r\n    \r\n    try {\r\n        return JSON.parse(stored) as SoundSettings;\r\n    } catch {\r\n        return { ...DEFAULT_SOUND_SETTINGS } as SoundSettings;\r\n    }\r\n}\r\n\r\nexport function setSoundSettings(settings: SoundSettings) {\r\n    if (typeof window === \"undefined\") return;\r\n    \r\n    const key = SOUND_SETTINGS_KEY_PREFIX + currentProjectId;\r\n    localStorage.setItem(key, JSON.stringify(settings));\r\n    \r\n    for (const l of listeners) l();\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAEA;AACA;;;AAIA,IAAI,cAAqC;AACzC,IAAI,mBAAmB,WAAW,MAAM;AACxC,MAAM,YAAY,IAAI;AAEf,SAAS,oBAAoB,SAAiB;IACjD,mBAAmB,aAAa;IAChC,KAAK,MAAM,KAAK,UAAW;AAC/B;AAEO,SAAS;IACZ,OAAO;AACX;AAEO,SAAS;IACZ,OAAO;AACX;AAEO,SAAS,eAAe,IAA2B;IACtD,IAAI,MAAM;QACN,MAAM,SAAS,sCAAgC,0BAAwC;QACvF,cAAc,sCAAS,0BAAuC;IAClE,OAAO;QACH,cAAc;IAClB;IACA,KAAK,MAAM,KAAK,UAAW;AAC/B;AAEO,SAAS,qBAAqB,QAAkB;IACnD,UAAU,GAAG,CAAC;IACd,OAAO,IAAM,UAAU,MAAM,CAAC;AAClC;AAEO,SAAS;IACZ,gDAAgD;IAChD,IAAI,aAAa,iBAAiB;QAC9B,QAAQ,GAAG,CAAC,uCAAuC,YAAY,eAAe;QAC9E,OAAO,YAAY,eAAe;IACtC;IACA,wCAAmC,OAAO;;;IAC1C,MAAM;AAGV;AAEO,SAAS,mBAAmB,QAAwB;IACvD,8BAA8B;IAC9B,IAAI,aAAa;QACb,cAAc;YAAE,GAAG,WAAW;YAAE,iBAAiB;QAAS;IAC9D;IAEA;;IAIA,KAAK,MAAM,KAAK,UAAW;AAC/B;AAEA,eAAe;AACf,MAAM,4BAA4B;AAE3B,SAAS;IACZ,wCAAmC;QAC/B,OAAO;YAAE,GAAG,0LAAsB;QAAC;IACvC;;;IAEA,MAAM;IACN,MAAM;AAWV;AAEO,SAAS,iBAAiB,QAAuB;IACpD,wCAAmC;;;IAEnC,MAAM;IAGD,MAAM;AACf"}},
    {"offset": {"line": 1071, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/PdfSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ninterface PdfSlideProps {\r\n\tassetId: string;\r\n\tpage: number;\r\n\tfallbackDataUrl?: string;\r\n\talt: string;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<any>;\r\n}\r\n\r\nexport function PdfSlide(props: PdfSlideProps) {\r\n\tconst { assetId, page, fallbackDataUrl, alt, getOrLoadPdfDocument } = props;\r\n\tconst wrapperRef = useRef<HTMLDivElement | null>(null);\r\n\tconst canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n\tconst [size, setSize] = useState<{ w: number; h: number } | null>(null);\r\n\tconst [renderError, setRenderError] = useState<string | null>(null);\r\n\tconst renderTaskRef = useRef<any>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst el = wrapperRef.current;\r\n\t\tif (!el) return;\r\n\t\tconst update = () => {\r\n\t\t\tconst rect = el.getBoundingClientRect();\r\n\t\t\tsetSize({ w: Math.max(0, rect.width), h: Math.max(0, rect.height) });\r\n\t\t};\r\n\t\tupdate();\r\n\t\tconst ro = new ResizeObserver(() => update());\r\n\t\tro.observe(el);\r\n\t\treturn () => ro.disconnect();\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet cancelled = false;\r\n\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetRenderError(null);\r\n\r\n\t\t\t\tconst el = wrapperRef.current;\r\n\t\t\t\tconst canvas = canvasRef.current;\r\n\t\t\t\tif (!el || !canvas || !size || size.w === 0 || size.h === 0) return;\r\n\r\n\t\t\t\t// Êó¢Â≠ò„ÅÆ„É¨„É≥„ÉÄ„É™„É≥„Ç∞„Çí„Ç≠„É£„É≥„Çª„É´\r\n\t\t\t\tif (renderTaskRef.current) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\trenderTaskRef.current.cancel();\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t// „Ç≠„É£„É≥„Çª„É´Ê∏à„Åø„ÅÆÂ†¥Âêà„ÅØÁÑ°Ë¶ñ\r\n\t\t\t\t\t}\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst pdf = await getOrLoadPdfDocument(assetId);\r\n\t\t\t\tif (cancelled) return;\r\n\t\t\t\tconst pdfPage = await pdf.getPage(page);\r\n\t\t\t\tif (cancelled) return;\r\n\r\n\t\t\t\tconst viewport1 = pdfPage.getViewport({ scale: 1 });\r\n\t\t\t\tconst scale = Math.min(size.w / viewport1.width, size.h / viewport1.height);\r\n\t\t\t\tconst dpr = typeof window !== \"undefined\" ? window.devicePixelRatio || 1 : 1;\r\n\t\t\t\tconst renderViewport = pdfPage.getViewport({ scale: scale * dpr });\r\n\r\n\t\t\t\tcanvas.width = Math.floor(renderViewport.width);\r\n\t\t\t\tcanvas.height = Math.floor(renderViewport.height);\r\n\t\t\t\tcanvas.style.width = `${Math.floor(renderViewport.width / dpr)}px`;\r\n\t\t\t\tcanvas.style.height = `${Math.floor(renderViewport.height / dpr)}px`;\r\n\r\n\t\t\t\tconst ctx = canvas.getContext(\"2d\");\r\n\t\t\t\tif (!ctx) return;\r\n\r\n\t\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tconst task = pdfPage.render({ canvasContext: ctx, canvas, viewport: renderViewport });\r\n\t\t\t\trenderTaskRef.current = task;\r\n\r\n\t\t\t\tawait task.promise;\r\n\r\n\t\t\t\tif (renderTaskRef.current === task) {\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t}\r\n\t\t\t} catch (e: any) {\r\n\t\t\t\tconst msg = e?.name === \"RenderingCancelledException\" ? null : (e instanceof Error ? e.message : String(e));\r\n\t\t\t\tif (!cancelled && msg) setRenderError(msg);\r\n\t\t\t}\r\n\t\t})();\r\n\r\n\t\treturn () => {\r\n\t\t\tcancelled = true;\r\n\t\t\tif (renderTaskRef.current) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\trenderTaskRef.current.cancel();\r\n\t\t\t\t\trenderTaskRef.current = null;\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// Êó¢„Å´„Ç≠„É£„É≥„Çª„É´Ê∏à„Åø„ÅÆÂ†¥Âêà„ÅØÁÑ°Ë¶ñ\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}, [assetId, getOrLoadPdfDocument, page, size]);\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tref={wrapperRef}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}\r\n\t\t>\r\n\t\t\t{renderError && fallbackDataUrl ? (\r\n\t\t\t\t<img src={fallbackDataUrl} style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }} alt={alt} />\r\n\t\t\t) : (\r\n\t\t\t\t<canvas ref={canvasRef} aria-label={alt} />\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1210, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/VideoSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAssetBlob } from \"@/lib/idbAssets\";\r\n\r\ninterface VideoSlideProps {\r\n\tassetId: string;\r\n\talt: string;\r\n}\r\n\r\nexport function VideoSlide(props: VideoSlideProps) {\r\n\tconst { assetId, alt } = props;\r\n\tconst [src, setSrc] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet active = true;\r\n\t\tlet url: string | null = null;\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetError(null);\r\n\t\t\t\tsetSrc(null);\r\n\t\t\t\tconst blob = await getAssetBlob(assetId);\r\n\t\t\t\tif (!blob) throw new Error(\"ÂãïÁîª„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\r\n\t\t\t\turl = URL.createObjectURL(blob);\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetSrc(url);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetError(e instanceof Error ? e.message : String(e));\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tactive = false;\r\n\t\t\tif (url) URL.revokeObjectURL(url);\r\n\t\t};\r\n\t}, [assetId]);\r\n\r\n\tif (error) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÂãïÁîª„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: {error}</div>;\r\n\t}\r\n\tif (!src) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÂãïÁîª„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<video\r\n\t\t\tsrc={src}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\r\n\t\t\tcontrols\r\n\t\t\tautoPlay\r\n\t\t\tplaysInline\r\n\t\t\taria-label={alt}\r\n\t\t/>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAUO,SAAS,WAAW,KAAsB;IAChD,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,GAAG;IACzB,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,qPAAQ,EAAgB;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,qPAAQ,EAAgB;IAElD,IAAA,sPAAS,EAAC;QACT,IAAI,SAAS;QACb,IAAI,MAAqB;QACzB,CAAC;YACA,IAAI;gBACH,SAAS;gBACT,OAAO;gBACP,MAAM,OAAO,MAAM,IAAA,2KAAY,EAAC;gBAChC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;gBAC3B,MAAM,IAAI,eAAe,CAAC;gBAC1B,IAAI,CAAC,QAAQ;gBACb,OAAO;YACR,EAAE,OAAO,GAAG;gBACX,IAAI,CAAC,QAAQ;gBACb,SAAS,aAAa,QAAQ,EAAE,OAAO,GAAG,OAAO;YAClD;QACD,CAAC;QACD,OAAO;YACN,SAAS;YACT,IAAI,KAAK,IAAI,eAAe,CAAC;QAC9B;IACD,GAAG;QAAC;KAAQ;IAEZ,IAAI,OAAO;QACV,qBAAO,kRAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;;gBAAG;gBAAiB;;;;;;;IAC9E;IACA,IAAI,CAAC,KAAK;QACT,qBAAO,kRAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;sBAAG;;;;;;IAC7D;IAEA,qBACC,kRAAC;QACA,KAAK;QACL,OAAO;YAAE,OAAO;YAAQ,QAAQ;YAAQ,WAAW;QAAU;QAC7D,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,cAAY;;;;;;AAGf"}},
    {"offset": {"line": 1299, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/ImageSlide.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAssetBlob } from \"@/lib/idbAssets\";\r\n\r\ninterface ImageSlideProps {\r\n\tassetId: string;\r\n\talt: string;\r\n}\r\n\r\nexport function ImageSlide(props: ImageSlideProps) {\r\n\tconst { assetId, alt } = props;\r\n\tconst [src, setSrc] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet active = true;\r\n\t\tlet url: string | null = null;\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tsetError(null);\r\n\t\t\t\tsetSrc(null);\r\n\t\t\t\tconst blob = await getAssetBlob(assetId);\r\n\t\t\t\tif (!blob) throw new Error(\"ÁîªÂÉè„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\r\n\t\t\t\turl = URL.createObjectURL(blob);\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetSrc(url);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!active) return;\r\n\t\t\t\tsetError(e instanceof Error ? e.message : String(e));\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tactive = false;\r\n\t\t\tif (url) URL.revokeObjectURL(url);\r\n\t\t};\r\n\t}, [assetId]);\r\n\r\n\tif (error) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: {error}</div>;\r\n\t}\r\n\tif (!src) {\r\n\t\treturn <div style={{ color: \"white\", textAlign: \"center\" }}>ÁîªÂÉè„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<img\r\n\t\t\tsrc={src}\r\n\t\t\tstyle={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\r\n\t\t\talt={alt}\r\n\t\t/>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAUO,SAAS,WAAW,KAAsB;IAChD,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,GAAG;IACzB,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,qPAAQ,EAAgB;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,qPAAQ,EAAgB;IAElD,IAAA,sPAAS,EAAC;QACT,IAAI,SAAS;QACb,IAAI,MAAqB;QACzB,CAAC;YACA,IAAI;gBACH,SAAS;gBACT,OAAO;gBACP,MAAM,OAAO,MAAM,IAAA,2KAAY,EAAC;gBAChC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;gBAC3B,MAAM,IAAI,eAAe,CAAC;gBAC1B,IAAI,CAAC,QAAQ;gBACb,OAAO;YACR,EAAE,OAAO,GAAG;gBACX,IAAI,CAAC,QAAQ;gBACb,SAAS,aAAa,QAAQ,EAAE,OAAO,GAAG,OAAO;YAClD;QACD,CAAC;QACD,OAAO;YACN,SAAS;YACT,IAAI,KAAK,IAAI,eAAe,CAAC;QAC9B;IACD,GAAG;QAAC;KAAQ;IAEZ,IAAI,OAAO;QACV,qBAAO,kRAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;;gBAAG;gBAAiB;;;;;;;IAC9E;IACA,IAAI,CAAC,KAAK;QACT,qBAAO,kRAAC;YAAI,OAAO;gBAAE,OAAO;gBAAS,WAAW;YAAS;sBAAG;;;;;;IAC7D;IAEA,qBACC,kRAAC;QACA,KAAK;QACL,OAAO;YAAE,OAAO;YAAQ,QAAQ;YAAQ,WAAW;QAAU;QAC7D,KAAK;;;;;;AAGR"}},
    {"offset": {"line": 1385, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/SlideDisplay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { Node } from \"@xyflow/react\";\r\nimport { PdfSlide } from \"./PdfSlide\";\r\nimport { VideoSlide } from \"./VideoSlide\";\r\nimport { ImageSlide } from \"./ImageSlide\";\r\n\r\ninterface SlideDisplayProps {\r\n\tcurrentNode: Node | undefined;\r\n\terror: string | null;\r\n\tgetOrLoadPdfDocument: (assetId: string) => Promise<any>;\r\n}\r\n\r\nexport function SlideDisplay(props: SlideDisplayProps) {\r\n\tconst { currentNode, error, getOrLoadPdfDocument } = props;\r\n\r\n\treturn (\r\n\t\t<div style={{ position: \"absolute\", inset: 0, display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n\t\t\t{currentNode ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{currentNode.data.asset?.kind === \"pdf\" ? (\r\n\t\t\t\t\t\t<PdfSlide\r\n\t\t\t\t\t\t\tassetId={currentNode.data.asset.assetId}\r\n\t\t\t\t\t\t\tpage={currentNode.data.asset.page ?? 1}\r\n\t\t\t\t\t\t\tfallbackDataUrl={currentNode.data.asset.thumbnailDataUrl}\r\n\t\t\t\t\t\t\talt={currentNode.data.label}\r\n\t\t\t\t\t\t\tgetOrLoadPdfDocument={getOrLoadPdfDocument}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : currentNode.data.asset?.kind === \"video\" ? (\r\n\t\t\t\t\t\t<VideoSlide assetId={currentNode.data.asset.assetId} alt={currentNode.data.label} />\r\n\t\t\t\t\t) : currentNode.data.asset?.kind === \"image\" ? (\r\n\t\t\t\t\t\t<ImageSlide assetId={currentNode.data.asset.assetId} alt={currentNode.data.label} />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<h1 style={{ fontSize: 80, color: \"white\", textAlign: \"center\", maxWidth: \"80%\" }}>\r\n\t\t\t\t\t\t\t{currentNode.data.label}\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</>\r\n\t\t\t) : (\r\n\t\t\t\t<div style={{ color: \"white\" }}>{error ?? \"„Çπ„É©„Ç§„Éâ„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì\"}</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;AACA;AALA;;;;;AAaO,SAAS,aAAa,KAAwB;IACpD,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,oBAAoB,EAAE,GAAG;IAErD,qBACC,kRAAC;QAAI,OAAO;YAAE,UAAU;YAAY,OAAO;YAAG,SAAS;YAAQ,YAAY;YAAU,gBAAgB;QAAS;kBAC5G,4BACA;sBACE,YAAY,IAAI,CAAC,KAAK,EAAE,SAAS,sBACjC,kRAAC,2LAAQ;gBACR,SAAS,YAAY,IAAI,CAAC,KAAK,CAAC,OAAO;gBACvC,MAAM,YAAY,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI;gBACrC,iBAAiB,YAAY,IAAI,CAAC,KAAK,CAAC,gBAAgB;gBACxD,KAAK,YAAY,IAAI,CAAC,KAAK;gBAC3B,sBAAsB;;;;;uBAEpB,YAAY,IAAI,CAAC,KAAK,EAAE,SAAS,wBACpC,kRAAC,+LAAU;gBAAC,SAAS,YAAY,IAAI,CAAC,KAAK,CAAC,OAAO;gBAAE,KAAK,YAAY,IAAI,CAAC,KAAK;;;;;uBAC7E,YAAY,IAAI,CAAC,KAAK,EAAE,SAAS,wBACpC,kRAAC,+LAAU;gBAAC,SAAS,YAAY,IAAI,CAAC,KAAK,CAAC,OAAO;gBAAE,KAAK,YAAY,IAAI,CAAC,KAAK;;;;;qCAEhF,kRAAC;gBAAG,OAAO;oBAAE,UAAU;oBAAI,OAAO;oBAAS,WAAW;oBAAU,UAAU;gBAAM;0BAC9E,YAAY,IAAI,CAAC,KAAK;;;;;;0CAK1B,kRAAC;YAAI,OAAO;gBAAE,OAAO;YAAQ;sBAAI,SAAS;;;;;;;;;;;AAI9C"}},
    {"offset": {"line": 1466, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/DrawingCanvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { WiiState } from \"@/hooks/useWiiController\";\r\nimport { useEffect, useRef } from \"react\";\r\n\r\ninterface DrawingCanvasProps {\r\n\tdrawingPoints: Array<{ x: number; y: number; mode?: \"draw\" | \"erase\" } | null>;\r\n\twiiState: WiiState | null;\r\n\tisPlaying: boolean;\r\n\tshouldPaint: boolean;\r\n\teraserMode: boolean;\r\n\teraserPosition: { x: number; y: number } | null;\r\n}\r\n\r\n// IR„Ç´„É°„É©„ÅÆÂ∫ßÊ®ô(0-1023)„ÇíÁîªÈù¢Â∫ßÊ®ô„Å´Â§âÊèõ„Åô„ÇãÈñ¢Êï∞\r\nfunction mapIrToScreen(irX: number, irY: number, screenW: number, screenH: number) {\r\n\tconst x = (1 - irX / 1024) * screenW;\r\n\tconst y = (irY / 768) * screenH;\r\n\treturn { x, y };\r\n}\r\n\r\nexport function DrawingCanvas(props: DrawingCanvasProps) {\r\n\tconst { drawingPoints, wiiState, isPlaying, shouldPaint, eraserMode, eraserPosition } = props;\r\n\tconst drawingCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\tconst cursorCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\tconst lastDrawnIndexRef = useRef(0);\r\n\r\n\t// „Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫ÁÆ°ÁêÜ„Å®„É™„Çµ„Ç§„Ç∫ÊôÇ„ÅÆÂÖ®ÂÜçÊèèÁîª\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tconst width = window.innerWidth;\r\n\t\t\tconst height = window.innerHeight;\r\n\r\n\t\t\tif (drawingCanvasRef.current) {\r\n\t\t\t\tdrawingCanvasRef.current.width = width;\r\n\t\t\t\tdrawingCanvasRef.current.height = height;\r\n\t\t\t\t// „É™„Çµ„Ç§„Ç∫„Åï„Çå„Åü„Çâ„ÇØ„É™„Ç¢„Åï„Çå„Çã„ÅÆ„Åß„ÄÅÂÖ®ÂÜçÊèèÁîª„ÅåÂøÖË¶Å\r\n\t\t\t\tlastDrawnIndexRef.current = 0;\r\n\t\t\t}\r\n\t\t\tif (cursorCanvasRef.current) {\r\n\t\t\t\tcursorCanvasRef.current.width = width;\r\n\t\t\t\tcursorCanvasRef.current.height = height;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// ÂàùÊúü„Çµ„Ç§„Ç∫Ë®≠ÂÆö\r\n\t\thandleResize();\r\n\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => window.removeEventListener(\"resize\", handleResize);\r\n\t}, []);\r\n\r\n\t// ÊèèÁîª„É¨„Ç§„É§„ÉºÊõ¥Êñ∞ (Drawing Layer) - ËøΩË®òÂûã\r\n\tuseEffect(() => {\r\n\t\tconst canvas = drawingCanvasRef.current;\r\n\t\tconst ctx = canvas?.getContext(\"2d\");\r\n\t\tif (!canvas || !ctx) return;\r\n\r\n\t\t// „É™„Çª„ÉÉ„ÉàÊ§úÁü•ÔºàÈÖçÂàó„ÅåÁü≠„Åè„Å™„Å£„ÅüÂ†¥Âêà„Å™„Å©Ôºâ\r\n\t\tif (drawingPoints.length < lastDrawnIndexRef.current) {\r\n\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\t\tlastDrawnIndexRef.current = 0;\r\n\t\t}\r\n\r\n\t\t// ÊèèÁîª‰∏çË¶Å„Å™„ÇâÁµÇ‰∫Ü\r\n\t\tif (drawingPoints.length === lastDrawnIndexRef.current) return;\r\n\r\n\t\t// ÂÖ±ÈÄöË®≠ÂÆö\r\n\t\tctx.lineCap = \"round\";\r\n\t\tctx.lineJoin = \"round\";\r\n\r\n\t\t// ËøΩË®ò„É´„Éº„Éó\r\n\t\tfor (let i = lastDrawnIndexRef.current; i < drawingPoints.length; i++) {\r\n\t\t\tconst p = drawingPoints[i];\r\n\t\t\tif (!p) continue; // Âå∫Âàá„Çä\r\n\r\n\t\t\tconst prev = i > 0 ? drawingPoints[i - 1] : null;\r\n\t\t\tconst mode = p.mode || \"draw\";\r\n\r\n\t\t\t// ÂßãÁÇπ„Åã„Å©„ÅÜ„ÅãÔºàÈÖçÂàó„ÅÆÂÖàÈ†≠„ÄÅ„Åæ„Åü„ÅØÁõ¥Ââç„Åånull„ÄÅ„Åæ„Åü„ÅØ„É¢„Éº„Éâ„ÅåÂ§â„Çè„Å£„ÅüÂ†¥ÂêàÔºâ\r\n\t\t\tconst isStart = !prev || prev.mode !== p.mode;\r\n\r\n\t\t\tif (isStart) {\r\n\t\t\t\t// ÂßãÁÇπÂá¶ÁêÜ\r\n\t\t\t\tif (mode === \"erase\") {\r\n\t\t\t\t\t// Ê∂à„Åó„Ç¥„É†ÂßãÁÇπ„Çπ„Çø„É≥„ÉóÔºàÈªíÊùøÊ∂à„Åó„ÅÆ„Çà„ÅÜ„Å´Âæê„ÄÖ„Å´ËñÑ„Åè„Å™„ÇãÔºâ\r\n\t\t\t\t\tctx.globalCompositeOperation = \"destination-out\";\r\n\t\t\t\t\tctx.fillStyle = \"rgba(0,0,0,0.18)\"; // 5-6Âõû„ÅßÂÆåÂÖ®„Å´Ê∂à„Åà„Çã\r\n\t\t\t\t\tctx.shadowBlur = 25; // „Åº„Åã„Åó„ÇíÂÖ•„Çå„Å¶Â¢ÉÁïå„ÇíÊüî„Çâ„Åã„Åè\r\n\t\t\t\t\tctx.shadowColor = \"rgba(0,0,0,0.18)\";\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.arc(p.x, p.y, 60, 0, Math.PI * 2);\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t}\r\n\t\t\t\t// draw„É¢„Éº„Éâ„ÅÆÂßãÁÇπ„ÅØmoveTo„Å†„Åë„Å™„ÅÆ„Åß„ÄÅ„Åì„Åì„Åß„ÅØ‰Ωï„ÇÇ„Åó„Å™„ÅÑÔºàÊ¨°„ÅÆÁÇπ„ÅßÁ∑ö„ÇíÂºï„ÅèÔºâ\r\n\t\t\t} else {\r\n\t\t\t\t// Êé•Á∂öÂá¶ÁêÜ (prev -> p)\r\n\t\t\t\tif (mode === \"draw\") {\r\n\t\t\t\t\tctx.globalCompositeOperation = \"source-over\";\r\n\t\t\t\t\tctx.strokeStyle = \"red\";\r\n\t\t\t\t\tctx.lineWidth = 5;\r\n\t\t\t\t\tctx.shadowBlur = 0;\r\n\t\t\t\t\tctx.shadowColor = \"transparent\";\r\n\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.moveTo(prev!.x, prev!.y);\r\n\t\t\t\t\tctx.lineTo(p.x, p.y);\r\n\t\t\t\t\tctx.stroke();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// erase Ë£úÈñìÔºàÈªíÊùøÊ∂à„Åó„ÅÆ„Çà„ÅÜ„Å´Âæê„ÄÖ„Å´ËñÑ„Åè„Å™„ÇãÔºâ\r\n\t\t\t\t\tctx.globalCompositeOperation = \"destination-out\";\r\n\t\t\t\t\tctx.fillStyle = \"rgba(0,0,0,0.18)\"; // 5-6Âõû„ÅßÂÆåÂÖ®„Å´Ê∂à„Åà„Çã\r\n\t\t\t\t\tctx.shadowBlur = 25; // „Åº„Åã„Åó„ÇíÂÖ•„Çå„Å¶Â¢ÉÁïå„ÇíÊüî„Çâ„Åã„Åè\r\n\t\t\t\t\tctx.shadowColor = \"rgba(0,0,0,0.18)\";\r\n\r\n\t\t\t\t\tconst dist = Math.hypot(p.x - prev!.x, p.y - prev!.y);\r\n\t\t\t\t\tconst angle = Math.atan2(p.y - prev!.y, p.x - prev!.x);\r\n\t\t\t\t\tconst step = 12; // Ë£úÈñìÈñìÈöî„ÇíÁã≠„ÇÅ„Å¶Êªë„Çâ„Åã„Å´\r\n\r\n\t\t\t\t\tfor (let d = step; d <= dist; d += step) {\r\n\t\t\t\t\t\tconst bx = prev!.x + Math.cos(angle) * d;\r\n\t\t\t\t\t\tconst by = prev!.y + Math.sin(angle) * d;\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.arc(bx, by, 60, 0, Math.PI * 2);\r\n\t\t\t\t\t\tctx.fill();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// ÁµÇÁÇπ\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.arc(p.x, p.y, 60, 0, Math.PI * 2);\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// „Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÊõ¥Êñ∞\r\n\t\tlastDrawnIndexRef.current = drawingPoints.length;\r\n\t}, [drawingPoints]);\r\n\r\n\t// „Ç´„Éº„ÇΩ„É´„É¨„Ç§„É§„ÉºÊõ¥Êñ∞ (Cursor Layer) - ÊØé„Éï„É¨„Éº„É†Êõ¥Êñ∞\r\n\tuseEffect(() => {\r\n\t\tconst canvas = cursorCanvasRef.current;\r\n\t\tconst ctx = canvas?.getContext(\"2d\");\r\n\t\tif (!canvas || !ctx) return;\r\n\r\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t// Ê∂à„Åó„Ç¥„É†„É¢„Éº„ÉâÊôÇÔºöÊ∂à„Åó„Ç¥„É†ÁØÑÂõ≤„ÇíË°®Á§∫\r\n\t\tif (eraserMode && eraserPosition) {\r\n\t\t\tctx.save();\r\n\t\t\tctx.strokeStyle = \"rgba(255, 100, 100, 0.6)\";\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.setLineDash([8, 4]);\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(eraserPosition.x, eraserPosition.y, 60, 0, Math.PI * 2);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.setLineDash([]);\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}, [eraserMode, eraserPosition]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<canvas\r\n\t\t\t\tref={drawingCanvasRef}\r\n\t\t\t\tstyle={{ position: \"absolute\", top: 0, left: 0, pointerEvents: \"none\" }}\r\n\t\t\t/>\r\n\t\t\t<canvas\r\n\t\t\t\tref={cursorCanvasRef}\r\n\t\t\t\tstyle={{ position: \"absolute\", top: 0, left: 0, pointerEvents: \"none\" }}\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1646, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/IrPointerOverlay.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { WiiState } from \"@/hooks/useWiiController\";\r\n\r\ninterface IrPointerOverlayProps {\r\n\twiiState: WiiState | null;\r\n\tisPlaying: boolean;\r\n\tirCursorEnabled: boolean; // IR„Ç´„Éº„ÇΩ„É´„ÅåÊúâÂäπ„Åã„Å©„ÅÜ„Åã\r\n\tshowIrDebug?: boolean; // IR„Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫„ÅÆÂàá„ÇäÊõø„Åà\r\n}\r\n\r\n// IR„Ç´„É°„É©„ÅÆÂ∫ßÊ®ô(0-1023 x 0-767)„ÇíÁîªÈù¢Â∫ßÊ®ô„Å´Â§âÊèõ„Åô„ÇãÈñ¢Êï∞\r\nfunction mapIrToScreen(irX: number, irY: number, screenW: number, screenH: number) {\r\n\tconst x = (1 - irX / 1024) * screenW;\r\n\tconst y = (irY / 768) * screenH;\r\n\treturn { x, y };\r\n}\r\n\r\nexport function IrPointerOverlay(props: IrPointerOverlayProps) {\r\n\tconst { wiiState, irCursorEnabled, showIrDebug = false } = props;\r\n\r\n\t// ‚òÖIR„Ç´„Éº„ÇΩ„É´ON„ÅÆ„Å®„Åç„ÅØ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆSetCursorPos„ÅßPC„Ç´„Éº„ÇΩ„É´„ÇíÂà∂Âæ°„Åô„Çã„Åü„ÇÅ„ÄÅ\r\n\t// „Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Åß„ÅÆËøΩÂä†„Ç´„Éº„ÇΩ„É´ÊèèÁîª„ÅØ‰∏çË¶ÅÔºà2Èáç„Ç´„Éº„ÇΩ„É´ÂïèÈ°å„ÅÆËß£Ê∂àÔºâ\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{/* „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±Ë°®Á§∫ - showIrDebug„Ååtrue„ÅÆÂ†¥Âêà„ÅÆ„ÅøË°®Á§∫ */}\r\n\t\t\t{showIrDebug && wiiState && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\tbottom: 60,\r\n\t\t\t\t\t\tright: 20,\r\n\t\t\t\t\t\tbackground: \"rgba(0, 0, 0, 0.85)\",\r\n\t\t\t\t\t\tcolor: \"lime\",\r\n\t\t\t\t\t\tpadding: \"12px 16px\",\r\n\t\t\t\t\t\tborderRadius: 8,\r\n\t\t\t\t\t\tfontFamily: \"monospace\",\r\n\t\t\t\t\t\tfontSize: 12,\r\n\t\t\t\t\t\tlineHeight: 1.6,\r\n\t\t\t\t\t\tborder: \"1px solid rgba(0, 255, 0, 0.3)\",\r\n\t\t\t\t\t\tmaxWidth: 320,\r\n\t\t\t\t\t\tzIndex: 9999,\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div style={{ fontWeight: \"bold\", marginBottom: 8, color: \"#0ff\" }}>\r\n\t\t\t\t\t\tüì° IR Sensor Debug\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span style={{ color: \"#888\" }}>IRCursor:</span>{\" \"}\r\n\t\t\t\t\t\t<span style={{ color: irCursorEnabled ? \"#0f0\" : \"#f55\" }}>\r\n\t\t\t\t\t\t\t{irCursorEnabled ? \"ON\" : \"OFF\"}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Detected:</span> {wiiState.ir?.length || 0} point(s)\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{wiiState.ir && wiiState.ir.length > 0 && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<hr style={{ margin: \"8px 0\", border: \"none\", borderTop: \"1px solid rgba(0,255,0,0.2)\" }} />\r\n\t\t\t\t\t\t\t{wiiState.ir.map((dot, index) => (\r\n\t\t\t\t\t\t\t\t<div key={index} style={{ marginBottom: 4 }}>\r\n\t\t\t\t\t\t\t\t\t<div style={{ color: \"#0ff\" }}>IR {index + 1}:</div>\r\n\t\t\t\t\t\t\t\t\t<div style={{ paddingLeft: 12 }}>\r\n\t\t\t\t\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Raw:</span> ({dot.x}, {dot.y})\r\n\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t<span style={{ color: \"#888\" }}>Screen:</span> (\r\n\t\t\t\t\t\t\t\t\t\t{Math.round(mapIrToScreen(dot.x, dot.y, window.innerWidth, window.innerHeight).x)},{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t{Math.round(mapIrToScreen(dot.x, dot.y, window.innerWidth, window.innerHeight).y)})\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<hr style={{ margin: \"8px 0\", border: \"none\", borderTop: \"1px solid rgba(0,255,0,0.2)\" }} />\r\n\t\t\t\t\t<div style={{ fontSize: 10, color: \"#666\" }}>\r\n\t\t\t\t\t\tÂ∫ßÊ®ôÁØÑÂõ≤: X(0-1023), Y(0-767)\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t[C] IR„Ç´„Éº„ÇΩ„É´ÂàáÊõø / [Space] „Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫ÂàáÊõø\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAWA,uCAAuC;AACvC,SAAS,cAAc,GAAW,EAAE,GAAW,EAAE,OAAe,EAAE,OAAe;IAChF,MAAM,IAAI,CAAC,IAAI,MAAM,IAAI,IAAI;IAC7B,MAAM,IAAI,AAAC,MAAM,MAAO;IACxB,OAAO;QAAE;QAAG;IAAE;AACf;AAEO,SAAS,iBAAiB,KAA4B;IAC5D,MAAM,EAAE,QAAQ,EAAE,eAAe,EAAE,cAAc,KAAK,EAAE,GAAG;IAE3D,kDAAkD;IAClD,oCAAoC;IAEpC,qBACC;kBAEE,eAAe,0BACf,kRAAC;YACA,OAAO;gBACN,UAAU;gBACV,QAAQ;gBACR,OAAO;gBACP,YAAY;gBACZ,OAAO;gBACP,SAAS;gBACT,cAAc;gBACd,YAAY;gBACZ,UAAU;gBACV,YAAY;gBACZ,QAAQ;gBACR,UAAU;gBACV,QAAQ;YACT;;8BAEA,kRAAC;oBAAI,OAAO;wBAAE,YAAY;wBAAQ,cAAc;wBAAG,OAAO;oBAAO;8BAAG;;;;;;8BAGpE,kRAAC;;sCACA,kRAAC;4BAAK,OAAO;gCAAE,OAAO;4BAAO;sCAAG;;;;;;wBAAiB;sCACjD,kRAAC;4BAAK,OAAO;gCAAE,OAAO,kBAAkB,SAAS;4BAAO;sCACtD,kBAAkB,OAAO;;;;;;;;;;;;8BAG5B,kRAAC;;sCACA,kRAAC;4BAAK,OAAO;gCAAE,OAAO;4BAAO;sCAAG;;;;;;wBAAgB;wBAAE,SAAS,EAAE,EAAE,UAAU;wBAAE;;;;;;;gBAE3E,SAAS,EAAE,IAAI,SAAS,EAAE,CAAC,MAAM,GAAG,mBACpC;;sCACC,kRAAC;4BAAG,OAAO;gCAAE,QAAQ;gCAAS,QAAQ;gCAAQ,WAAW;4BAA8B;;;;;;wBACtF,SAAS,EAAE,CAAC,GAAG,CAAC,CAAC,KAAK,sBACtB,kRAAC;gCAAgB,OAAO;oCAAE,cAAc;gCAAE;;kDACzC,kRAAC;wCAAI,OAAO;4CAAE,OAAO;wCAAO;;4CAAG;4CAAI,QAAQ;4CAAE;;;;;;;kDAC7C,kRAAC;wCAAI,OAAO;4CAAE,aAAa;wCAAG;;0DAC7B,kRAAC;gDAAK,OAAO;oDAAE,OAAO;gDAAO;0DAAG;;;;;;4CAAW;4CAAG,IAAI,CAAC;4CAAC;4CAAG,IAAI,CAAC;4CAAC;0DAC7D,kRAAC;;;;;0DACD,kRAAC;gDAAK,OAAO;oDAAE,OAAO;gDAAO;0DAAG;;;;;;4CAAc;4CAC7C,KAAK,KAAK,CAAC,cAAc,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,OAAO,UAAU,EAAE,OAAO,WAAW,EAAE,CAAC;4CAAE;4CAAE;4CACnF,KAAK,KAAK,CAAC,cAAc,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,OAAO,UAAU,EAAE,OAAO,WAAW,EAAE,CAAC;4CAAE;;;;;;;;+BAP1E;;;;;;;8BAab,kRAAC;oBAAG,OAAO;wBAAE,QAAQ;wBAAS,QAAQ;wBAAQ,WAAW;oBAA8B;;;;;;8BACvF,kRAAC;oBAAI,OAAO;wBAAE,UAAU;wBAAI,OAAO;oBAAO;;wBAAG;sCAE5C,kRAAC;;;;;wBAAK;;;;;;;;;;;;;;AAOZ"}},
    {"offset": {"line": 1875, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/EraserCursor.tsx"],"sourcesContent":["\"use client\";\r\n\r\ntype EraserCursorProps = {\r\n\tposition: { x: number; y: number } | null;\r\n\tisActive: boolean;\r\n\tbuttonName?: string | null;\r\n};\r\n\r\nexport function EraserCursor({ position, isActive, buttonName }: EraserCursorProps) {\r\n\tif (!isActive || !position) return null;\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{/* Ê∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´ÔºàËµ§„ÅÑÂçäÈÄèÊòé„ÅÆÂÜÜÔºâ */}\r\n\t\t\t{/* <div\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"fixed\",\r\n\t\t\t\t\tleft: position.x - 40,\r\n\t\t\t\t\ttop: position.y - 40,\r\n\t\t\t\t\twidth: 80,\r\n\t\t\t\t\theight: 80,\r\n\t\t\t\t\tborderRadius: \"50%\",\r\n\t\t\t\t\tborder: \"3px solid rgba(255, 0, 0, 0.8)\",\r\n\t\t\t\t\tbackground: \"rgba(255, 100, 100, 0.3)\",\r\n\t\t\t\t\tpointerEvents: \"none\",\r\n\t\t\t\t\tzIndex: 10001,\r\n\t\t\t\t\ttransition: \"left 0.05s, top 0.05s\",\r\n\t\t\t\t}}\r\n\t\t\t/> */}\r\n\r\n\t\t\t{/* Ê∂à„Åó„Ç¥„É†„É¢„Éº„ÉâË°®Á§∫ÔºàÂè≥‰∏ãÔºâ */}\r\n\t\t\t<div\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"fixed\",\r\n\t\t\t\t\tbottom: 80,\r\n\t\t\t\t\tright: 20,\r\n\t\t\t\t\tbackground: \"rgba(255, 100, 100, 0.7)\",\r\n\t\t\t\t\tcolor: \"white\",\r\n\t\t\t\t\tpadding: \"8px 16px\",\r\n\t\t\t\t\tborderRadius: 6,\r\n\t\t\t\t\tfontSize: 13,\r\n\t\t\t\t\tfontWeight: \"normal\",\r\n\t\t\t\t\tzIndex: 9999,\r\n\t\t\t\t\tboxShadow: \"0 2px 8px rgba(0,0,0,0.2)\",\r\n\t\t\t\t\tpointerEvents: \"none\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tÊ∂à„Åó„Ç¥„É†„É¢„Éº„Éâ ON\r\n\t\t\t\t<br />\r\n\t\t\t\t<small style={{ fontSize: 11 }}>\r\n\t\t\t\t\tÂ∑¶„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØA+B„ÅßÊ∂àÂéª | {buttonName || \"X\"}„ÅßËß£Èô§\r\n\t\t\t\t</small>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAQO,SAAS,aAAa,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAqB;IACjF,IAAI,CAAC,YAAY,CAAC,UAAU,OAAO;IAEnC,qBACC;kBAmBC,cAAA,kRAAC;YACA,OAAO;gBACN,UAAU;gBACV,QAAQ;gBACR,OAAO;gBACP,YAAY;gBACZ,OAAO;gBACP,SAAS;gBACT,cAAc;gBACd,UAAU;gBACV,YAAY;gBACZ,QAAQ;gBACR,WAAW;gBACX,eAAe;YAChB;;gBACA;8BAEA,kRAAC;;;;;8BACD,kRAAC;oBAAM,OAAO;wBAAE,UAAU;oBAAG;;wBAAG;wBACb,cAAc;wBAAI;;;;;;;;;;;;;;AAKzC"}},
    {"offset": {"line": 1933, "column": 0}, "map": {"version":3,"sources":["file:///Users/yamamototakuma/Desktop/WiiSugeee/frontend/src/components/presenter/PresenterView.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { loadFromLocalStorage, type SerializedFlow } from \"@/lib/presentation\";\nimport { getAssetBlob } from \"@/lib/idbAssets\";\nimport { useWiiController } from \"@/hooks/useWiiController\";\nimport { ReactionOverlay } from \"@/components/presenter/ReactionOverlay\";\nimport { WiiDebugPanel } from \"@/components/presenter/WiiDebugPanel\";\nimport { mergeBindings, type BindingAction } from \"@/lib/buttonBindings\";\nimport { getProjectBindings } from \"@/lib/currentProjectStore\";\nimport { WiiDisconnectPopup } from \"@/components/presenter/WiiDisconnectPopup\";\nimport { WiiReconnectPopup } from \"@/components/presenter/WiiReconnectPopup\";\nimport { SlideDisplay } from \"@/components/presenter/SlideDisplay\";\nimport { DrawingCanvas } from \"@/components/presenter/DrawingCanvas\";\nimport { IrPointerOverlay } from \"@/components/presenter/IrPointerOverlay\";\nimport { EraserCursor } from \"@/components/presenter/EraserCursor\";\nimport { WiiReconnectPopup2 } from \"./WiiReconnectPopup2\";\nimport { WiiDisconnectPopup2 } from \"./WiiDisconnectPopup2\";\n\nexport function PresenterView() {\n    const router = useRouter();\n    const searchParams = useSearchParams();\n    const containerRef = useRef<HTMLDivElement | null>(null);\n    const isMouseDrawingRef = useRef(false);\n    const [isPainting, setIsPainting] = useState(false);\n    const wasWiiADownRef = useRef(false);\n    const lastEraserToggleTimeRef = useRef<number>(0); // Ê∂à„Åó„Ç¥„É†„Éà„Ç∞„É´„ÅÆÂ§öÈáçÂÖ•ÂäõÈò≤Ê≠¢\n    const lastIrSensToggleTimeRef = useRef<number>(0); // IR„Çª„É≥„Çµ„Éº„Éà„Ç∞„É´„ÅÆÂ§öÈáçÂÖ•ÂäõÈò≤Ê≠¢\n\n    // Wii„É™„É¢„Ç≥„É≥„ÅÆÁä∂ÊÖã„ÇíÂèñÂæó\n    const { wiiState, pressed, wiiConnected, wiiDisconnectedAt, irCursorEnabled, setIrCursorEnabled, playWiiSound } = useWiiController();\n\n    // PCÂÅ¥„ÅÆÈü≥Â£∞ÂÜçÁîüÁî®ÔºàHTMLAudioElementÔºâ\n    const soundboardRef = useRef<{ q?: HTMLAudioElement; w?: HTMLAudioElement; e?: HTMLAudioElement }>({});\n    const audioUnlockedRef = useRef(false);\n    const pendingSoundRef = useRef<\"q\" | \"w\" | \"e\" | null>(null);\n\n    const tryUnlockAudio = useCallback(async () => {\n        if (audioUnlockedRef.current) return;\n\n        const { q, w, e } = soundboardRef.current;\n        const audios = [q, w, e].filter(Boolean) as HTMLAudioElement[];\n        if (audios.length === 0) return;\n\n        try {\n            const a = audios[0];\n            const prevMuted = a.muted;\n            const prevVolume = a.volume;\n            a.muted = true;\n            a.volume = 0;\n            await a.play();\n            a.pause();\n            a.currentTime = 0;\n            a.muted = prevMuted;\n            a.volume = prevVolume;\n            audioUnlockedRef.current = true;\n            console.log(\"[Audio] Successfully unlocked audio context\");\n\n            const pending = pendingSoundRef.current;\n            pendingSoundRef.current = null;\n            if (pending) {\n                const next = soundboardRef.current[pending];\n                if (next) {\n                    next.currentTime = 0;\n                    void next.play().catch((err) => {\n                        console.warn(\"sound play failed\", pending, err);\n                    });\n                }\n            }\n        } catch (err) {\n            console.warn(\"audio unlock failed\", err);\n        }\n    }, []);\n\n    // PCÂÅ¥„ÅßÈü≥Â£∞„ÇíÂÜçÁîüÔºàHTMLAudioÔºâ\n    const playSoundOnPC = useCallback(async (key: \"q\" | \"w\" | \"e\") => {\n        const a = soundboardRef.current[key];\n        if (!a) {\n            console.warn(`[Audio] No audio element for key: ${key}`);\n            return;\n        }\n\n        // „Ç™„Éº„Éá„Ç£„Ç™„Åå„Ç¢„É≥„É≠„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÄÅ„Ç¢„É≥„É≠„ÉÉ„ÇØ„ÇíË©¶Ë°å\n        if (!audioUnlockedRef.current) {\n            console.log(`[Audio] Attempting to unlock audio context for ${key}`);\n            pendingSoundRef.current = key;\n            await tryUnlockAudio();\n            // „Ç¢„É≥„É≠„ÉÉ„ÇØ„Å´Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Éö„É≥„Éá„Ç£„É≥„Ç∞„Å´‰øùÂ≠òÊ∏à„Åø\n            if (!audioUnlockedRef.current) {\n                console.warn(\"[Audio] Audio context not unlocked yet, sound will play after user interaction\");\n                return;\n            }\n        }\n\n        console.log(`[Audio] Playing sound on PC: ${key}`);\n        a.currentTime = 0;\n        void a.play().catch((err) => {\n            console.warn(`[Audio] Sound play failed for ${key}:`, err);\n            pendingSoundRef.current = key;\n        });\n    }, [tryUnlockAudio]);\n\n    // Wii„É™„É¢„Ç≥„É≥ÂÅ¥„ÅßÈü≥Â£∞„ÇíÂÜçÁîü\n    const playSoundOnWii = useCallback(\n        (key: \"q\" | \"w\" | \"e\") => {\n            if (key === \"q\") playWiiSound(\"shot\");\n            else if (key === \"e\") playWiiSound(\"oh\");\n            else playWiiSound(\"uxo\");\n        },\n        [playWiiSound],\n    );\n\n    // Ê±éÁî®„ÅÆÈü≥Â£∞ÂÜçÁîüÈñ¢Êï∞ÔºàoutputDevice„ÅßÂá∫ÂäõÂÖà„ÇíÊåáÂÆöÔºâ\n    const playSound = useCallback(\n        (key: \"q\" | \"w\" | \"e\", outputDevice: \"pc\" | \"wii\" = \"pc\") => {\n            if (outputDevice === \"wii\") {\n                playSoundOnWii(key);\n            } else {\n                playSoundOnPC(key);\n            }\n        },\n        [playSoundOnPC, playSoundOnWii],\n    );\n\n    const returnTo = useMemo(() => {\n        return searchParams.get(\"from\") === \"editor\" ? \"/editor\" : \"/\";\n    }, [searchParams]);\n\n    const returnLabel = useMemo(() => {\n        return returnTo === \"/editor\" ? \"„Ç®„Éá„Ç£„Çø„Å´Êàª„Çã\" : \"„Éõ„Éº„É†„Å´Êàª„Çã\";\n    }, [returnTo]);\n\n    const goBack = useCallback(() => {\n        router.push(returnTo);\n    }, [router, returnTo]);\n    const [flow, setFlow] = useState<SerializedFlow | null>(null);\n    const [error, setError] = useState<string | null>(null);\n    const [currentNodeId, setCurrentNodeId] = useState<string | null>(null);\n    const [startedWithWii, setStartedWithWii] = useState(false);\n    const [playingSince, setPlayingSince] = useState<number>(0);\n    const [showDebugPanel, setShowDebugPanel] = useState(true);\n    const [showIrDebug, setShowIrDebug] = useState(true); // IR„Çª„É≥„Çµ„Éº„Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫\n\n    const pdfDocCacheRef = useRef<Map<string, Promise<any>>>(new Map());\n\n    // ‚òÖ‰øÆÊ≠£: Â∏∏„Å´playingÁä∂ÊÖã„Å®„Åó„Å¶Êâ±„ÅÜÔºàflow/currentNodeId„Åå„ÅÇ„Çå„Å∞ÂÜçÁîü‰∏≠Ôºâ\n    const isPlaying = flow != null && currentNodeId != null;\n\n    // PCÂÅ¥Èü≥Â£∞„ÅÆÂàùÊúüÂåñ\n    useEffect(() => {\n        const q = new Audio(\"https://www.myinstants.com/media/sounds/nice-shot-wii-sports_DJJ0VOz.mp3\");\n        const w = new Audio(\"https://www.myinstants.com/media/sounds/crowdaw.mp3\");\n        const e = new Audio(\"https://www.myinstants.com/media/sounds/crowdoh.mp3\");\n        q.preload = \"auto\";\n        w.preload = \"auto\";\n        e.preload = \"auto\";\n        soundboardRef.current = { q, w, e };\n        console.log(\"[Audio] Audio elements initialized\");\n\n        // „É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥ÊôÇ„Å´„Ç™„Éº„Éá„Ç£„Ç™„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Çí„Ç¢„É≥„É≠„ÉÉ„ÇØ\n        const unlockOnInteraction = () => {\n            if (audioUnlockedRef.current) return;\n            console.log(\"[Audio] User interaction detected, unlocking audio\");\n            void tryUnlockAudio();\n        };\n\n        // „ÇØ„É™„ÉÉ„ÇØ„ÇÑ„Çø„ÉÉ„ÉÅ„Åß„Ç¢„É≥„É≠„ÉÉ„ÇØ„ÇíË©¶Ë°å\n        window.addEventListener(\"click\", unlockOnInteraction);\n        window.addEventListener(\"touchstart\", unlockOnInteraction);\n        window.addEventListener(\"keydown\", unlockOnInteraction);\n\n        return () => {\n            window.removeEventListener(\"click\", unlockOnInteraction);\n            window.removeEventListener(\"touchstart\", unlockOnInteraction);\n            window.removeEventListener(\"keydown\", unlockOnInteraction);\n            for (const a of [q, w, e]) {\n                try {\n                    a.pause();\n                } catch {\n                    // ignore\n                }\n            }\n            soundboardRef.current = {};\n        };\n    }, [tryUnlockAudio]);\n\n    // „Çπ„Éö„Éº„Çπ„Ç≠„Éº„Åß„Éá„Éê„ÉÉ„Ç∞„Éë„Éç„É´„Å®IR„Çª„É≥„Çµ„Éº„Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫„ÇíÂàá„ÇäÊõø„Åà\n    useEffect(() => {\n        const handleKeyDown = (e: KeyboardEvent) => {\n            if (e.code === \"Space\" && e.target === document.body) {\n                e.preventDefault();\n                setShowDebugPanel(prev => !prev);\n                setShowIrDebug(prev => !prev);\n            }\n        };\n\n        window.addEventListener(\"keydown\", handleKeyDown);\n        return () => window.removeEventListener(\"keydown\", handleKeyDown);\n    }, []);\n\n    const getOrLoadPdfDocument = useCallback(async (assetId: string) => {\n        const cached = pdfDocCacheRef.current.get(assetId);\n        if (cached) return await cached;\n\n        const promise = (async () => {\n            const blob = await getAssetBlob(assetId);\n            if (!blob) throw new Error(\"PDF„Ç¢„Çª„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì (IndexedDB)\");\n            const arrayBuffer = await blob.arrayBuffer();\n            const pdfjs = await import(\"pdfjs-dist/legacy/build/pdf.mjs\");\n            pdfjs.GlobalWorkerOptions.workerSrc = new URL(\n                \"pdfjs-dist/legacy/build/pdf.worker.min.mjs\",\n                import.meta.url,\n            ).toString();\n            return await pdfjs.getDocument({ data: arrayBuffer }).promise;\n        })();\n\n        pdfDocCacheRef.current.set(assetId, promise);\n        try {\n            return await promise;\n        } catch (e) {\n            pdfDocCacheRef.current.delete(assetId);\n            throw e;\n        }\n    }, []);\n\n    // „ÅäÁµµÊèè„ÅçÁî®„ÅÆÂ∫ßÊ®ô„É™„Çπ„Éà\n    const [drawingPoints, setDrawingPoints] = useState<Array<{ x: number; y: number; mode?: \"draw\" | \"erase\" } | null>>([]);\n\n    // Ê∂à„Åó„Ç¥„É†„É¢„Éº„ÉâÔºà„Éà„Ç∞„É´ÂºèÔºâ- X„Ç≠„Éº„Å®Wii„Éú„Çø„É≥„ÅßÂÖ±ÈÄö\n    const [eraserMode, setEraserMode] = useState(false);\n    const [eraserButtonName, setEraserButtonName] = useState<string | null>(null);\n\n    // „Ç´„Éº„ÇΩ„É´‰ΩçÁΩÆÔºàÊ∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´Ë°®Á§∫Áî®Ôºâ\n    const [cursorPos, setCursorPos] = useState<{ x: number; y: number } | null>(null);\n\n    // ÈÄ£Á∂öÈÅ∑Áßª„ÇíÈò≤„Åê„Åü„ÇÅ„ÅÆ„ÇØ„Éº„É´„Çø„Ç§„É†ÁÆ°ÁêÜ\n    const lastNavTime = useRef<number>(0);\n\n    // ÁèæÂú®„ÅÆ„Éé„Éº„Éâ„Éá„Éº„Çø\n    const currentNode = useMemo(() =>\n        flow?.nodes.find((n) => n.id === currentNodeId),\n        [flow, currentNodeId]);\n\n    // ‚òÖ‰øÆÊ≠£: ÂàùÂõû„Éû„Ç¶„É≥„ÉàÊôÇ„Å´Ëá™ÂãïÁöÑ„Å´„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥„ÇíÈñãÂßã\n    useEffect(() => {\n        const loaded = loadFromLocalStorage();\n        if (!loaded || loaded.nodes.length === 0) {\n            setError(\"„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇEditor„Åß‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\");\n            setFlow(null);\n            setCurrentNodeId(null);\n            return;\n        }\n\n        // „Éê„Ç§„É≥„ÉâË®≠ÂÆö„ÇíË™≠„ÅøËæº„Åø\n        const storedBindings = getProjectBindings();\n        const flowWithBindings = storedBindings ?\n            { ...loaded, projectBindings: storedBindings } : loaded;\n\n        console.log(\"PresenterView: Auto-starting presentation with bindings\", { storedBindings, flowWithBindings });\n\n        setError(null);\n        setFlow(flowWithBindings);\n\n        // Start„Éé„Éº„Éâ„Åã„ÇâÈñãÂßã\n        const startNode = loaded.nodes.find((n) => n.data.label === \"Start\") || loaded.nodes[0];\n        setCurrentNodeId(startNode.id);\n\n        // WiiÊé•Á∂öÁä∂ÊÖã„ÇíË®òÈå≤\n        setStartedWithWii(!!wiiConnected);\n        setPlayingSince(Date.now());\n    }, []); // ‚òÖÁ©∫„ÅÆ‰æùÂ≠òÈÖçÂàó„ÅßÂàùÂõû„ÅÆ„ÅøÂÆüË°å\n\n    // ‚òÖ‰øÆÊ≠£: wiiConnected„ÅåÂ§âÂåñ„Åó„Åü„ÇâË®òÈå≤„ÇíÊõ¥Êñ∞\n    useEffect(() => {\n        if (wiiConnected) setStartedWithWii(true);\n    }, [wiiConnected]);\n\n    const outgoingEdges = useMemo(() => {\n        if (!flow || !currentNodeId) return [];\n        return flow.edges.filter((e) => e.source === currentNodeId);\n    }, [flow, currentNodeId]);\n\n    const branchOptions = useMemo(() => {\n        // 1-9 „ÅÆÊï∞Â≠ó„ÅßÈÅ∏„Åπ„ÇãÂàÜÂ≤ê\n        const options: Array<{ key: string; target: string }> = [];\n        const used = new Set<string>();\n\n        for (const edge of outgoingEdges) {\n            const label = (edge.label ?? \"\").trim();\n            const m = label.match(/^([1-9])(?:\\b|\\s|:|-)/);\n            if (m) {\n                const k = m[1];\n                if (!used.has(k)) {\n                    options.push({ key: k, target: edge.target });\n                    used.add(k);\n                }\n            }\n        }\n\n        // „É©„Éô„É´„Å´Áï™Âè∑„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅÈÖçÂàóÈ†Ü„Åß 1..n „ÇíÂâ≤„ÇäÂΩì„Å¶\n        for (const edge of outgoingEdges) {\n            if (options.length >= 9) break;\n            const nextKey = String(options.length + 1);\n            if (used.has(nextKey)) continue;\n            options.push({ key: nextKey, target: edge.target });\n            used.add(nextKey);\n        }\n\n        return options;\n    }, [outgoingEdges]);\n\n    const hasMultipleBranches = outgoingEdges.length >= 2;\n\n    // „Éé„Éº„ÉâÁßªÂãïÂá¶ÁêÜ\n    const navigateTo = useCallback((nodeId: string) => {\n        // „ÇØ„Éº„É´„Çø„Ç§„É†„ÉÅ„Çß„ÉÉ„ÇØ (500ms‰ª•ÂÜÖ„ÅÆÈÄ£Á∂öÈÅ∑Áßª„ÅØÁÑ°Ë¶ñ)\n        const now = Date.now();\n        if (now - lastNavTime.current < 500) return;\n        lastNavTime.current = now;\n\n        setCurrentNodeId(nodeId);\n        setDrawingPoints([]); // „Çπ„É©„Ç§„Éâ„ÅåÂ§â„Çè„Å£„Åü„ÇâÁ∑ö„ÇíÊ∂à„Åô\n    }, []);\n\n    // Ê¨°„Å∏Ôºà„É≠„Ç∏„ÉÉ„ÇØÊîπËâØÁâàÔºâ\n    const nextSlide = useCallback(() => {\n        if (!flow || !currentNodeId) return;\n        // ÂàÜÂ≤ê„ÅåË§áÊï∞„ÅÇ„ÇãÂ†¥Âêà„ÅØ„ÄÅÊï∞Â≠óÈÅ∏Êäû„ÇíÂÑ™ÂÖà„Åô„Çã\n        const edges = flow.edges.filter((e) => e.source === currentNodeId);\n        if (edges.length >= 2) return;\n\n        // ÁèæÂú®„ÅÆ„Éé„Éº„Éâ„Åã„ÇâÂá∫„Å¶„ÅÑ„Çã„Ç®„ÉÉ„Ç∏„Çí„Åô„Åπ„Å¶ÂèñÂæó\n        // (‰∏ä„ÅßÂèñÂæóÊ∏à„Åø)\n\n        if (edges.length === 0) return;\n\n        // ÂÑ™ÂÖàÈ†Ü‰Ωç‰ªò„Åë\n        // 1. „É©„Éô„É´„Åå„Å™„ÅÑ„Ç®„ÉÉ„Ç∏ („Éá„Éï„Ç©„É´„Éà„É´„Éº„Éà)\n        // 2. „É©„Éô„É´„Åå \"next\" „ÅÆ„Ç®„ÉÉ„Ç∏\n        // 3. „Åù„Çå‰ª•Â§ñ (ÊúÄÂàù„Å´Ë¶ã„Å§„Åã„Å£„Åü„ÇÇ„ÅÆ)\n        const targetEdge =\n            edges.find(e => !e.label || e.label.trim() === \"\") ||\n            edges.find(e => e.label === \"next\") ||\n            edges[0];\n\n        if (targetEdge) navigateTo(targetEdge.target);\n    }, [flow, currentNodeId, navigateTo]);\n\n    const branchByNumberKey = useCallback(\n        (key: string) => {\n            if (!hasMultipleBranches) return;\n            const opt = branchOptions.find((o) => o.key === key);\n            if (opt) navigateTo(opt.target);\n        },\n        [branchOptions, hasMultipleBranches, navigateTo],\n    );\n\n    // Ââç„Å∏ÔºàÈÄÜÈ†ÜÊ§úÁ¥¢Ôºâ\n    const prevSlide = useCallback(() => {\n        if (!flow || !currentNodeId) return;\n        // Ëá™ÂàÜ„Å´Âêë„Åã„Å£„Å¶„ÅÑ„Çã„Ç®„ÉÉ„Ç∏„ÇíÊé¢„Åó„Å¶Êàª„ÇãÔºàÁ∞°ÊòìÂÆüË£ÖÔºâ\n        const edge = flow.edges.find(e => e.target === currentNodeId);\n        if (edge) navigateTo(edge.source);\n    }, [flow, currentNodeId, navigateTo]);\n\n    // ÂàÜÂ≤êÂá¶ÁêÜÔºà„Ç®„ÉÉ„Ç∏„ÅÆ„É©„Éô„É´„ÅßÊ§úÁ¥¢Ôºâ\n    const branchTo = useCallback((keywords: string[]) => {\n        if (!flow || !currentNodeId) return;\n        const edges = flow.edges.filter(e => e.source === currentNodeId);\n        const target = edges.find(e => keywords.some(k => e.label?.includes(k)));\n        if (target) {\n            console.log(\"ÂàÜÂ≤ê„Åó„Åæ„Åó„Åü:\", target.label);\n            navigateTo(target.target);\n        }\n    }, [flow, currentNodeId, navigateTo]);\n\n    // ‚òÖËøΩÂä†: „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Çí„Éá„Éê„ÉÉ„Ç∞„Åô„ÇãÔºàN=One, M=TwoÔºâ\n    const [debugEmitClap, setDebugEmitClap] = useState(false);\n    const [debugEmitLaugh, setDebugEmitLaugh] = useState(false);\n\n    // „Ç≠„Éº„Éú„Éº„ÉâÊìç‰Ωú (Áü¢Âç∞„Ç≠„ÉºÂØæÂøú + ESC„ÅßÊàª„Çã)\n    useEffect(() => {\n        if (!isPlaying) return;\n\n        const handleKeyDown = (e: KeyboardEvent) => {\n            // ËøΩÂä†: Á∑ö„Çí„ÇØ„É™„Ç¢ (R)\n            if (e.key === \"r\" || e.key === \"R\") {\n                setDrawingPoints([]);\n                isMouseDrawingRef.current = false;\n                wasWiiADownRef.current = false;\n                return;\n            }\n\n            // „Éö„Ç§„É≥„Éà„Å®Ê∂à„Åó„Ç¥„É†„ÇíÂàá„ÇäÊõø„Åà (X) - Wii„Éú„Çø„É≥„Å®Âêå„ÅòÊåôÂãï\n            if (e.key === \"x\" || e.key === \"X\") {\n                // Êäº„Åó„Å£„Å±„Å™„Åó„ÅßON/OFF„ÅåÊö¥„Çå„Å™„ÅÑ„Çà„ÅÜ„Å´„ÄÅ„É™„Éî„Éº„Éà„ÅØÁÑ°Ë¶ñ\n                if (e.repeat) return;\n                setEraserMode((prev) => {\n                    const next = !prev;\n                    if (next) {\n                        setEraserButtonName(\"X\");\n                        setCursorPos({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                    } else {\n                        setEraserButtonName(null);\n                        setCursorPos(null);\n                    }\n                    return next;\n                });\n                return;\n            }\n\n            if (!e.repeat) {\n                if (e.key === \"q\" || e.key === \"Q\") {\n                    playSound(\"q\");\n                    return;\n                }\n                if (e.key === \"w\" || e.key === \"W\") {\n                    playSound(\"w\");\n                    return;\n                }\n                if (e.key === \"e\" || e.key === \"E\") {\n                    playSound(\"e\");\n                    return;\n                }\n            }\n\n            // ‚òÖËøΩÂä†: „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ÔºàN / MÔºâ\n            // Êäº„Åó„Å£„Å±„Å™„Åó„ÅßÂ¢óÊÆñ„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´ repeat „ÇíÁÑ°Ë¶ñ\n            if (!e.repeat) {\n                if (e.key === \"n\" || e.key === \"N\") {\n                    setDebugEmitClap(true);\n                    queueMicrotask(() => setDebugEmitClap(false)); // 1Âõû„Å†„ÅëÁô∫ÁÅ´\n                    return;\n                }\n                if (e.key === \"m\" || e.key === \"M\") {\n                    setDebugEmitLaugh(true);\n                    queueMicrotask(() => setDebugEmitLaugh(false)); // 1Âõû„Å†„ÅëÁô∫ÁÅ´\n                    return;\n                }\n            }\n\n            // Êó¢Â≠ò: ÂàÜÂ≤ê 1..9\n            if (e.key >= \"1\" && e.key <= \"9\") {\n                branchByNumberKey(e.key);\n                return;\n            }\n            if (e.key === \"ArrowRight\") {\n                if (!hasMultipleBranches) nextSlide();\n            }\n            if (e.key === \"ArrowLeft\") prevSlide();\n            // ESC„Ç≠„Éº„ÅßÂÖÉ„ÅÆÁîªÈù¢„Å∏Êàª„ÇãÔºà„Ç®„Éá„Ç£„ÇøÁµåÁî±„Å™„Çâ„Ç®„Éá„Ç£„Çø„Å∏Ôºâ\n            if (e.key === \"Escape\") goBack();\n\n            // ‚òÖËøΩÂä†: C„Ç≠„Éº„ÅßIR„Ç´„Éº„ÇΩ„É´ÂàáÊõø\n            if ((e.key === \"c\" || e.key === \"C\") && !e.repeat) {\n                setIrCursorEnabled(!irCursorEnabled);\n                return;\n            }\n        };\n\n        window.addEventListener(\"keydown\", handleKeyDown);\n        return () => window.removeEventListener(\"keydown\", handleKeyDown);\n    }, [isPlaying, nextSlide, prevSlide, goBack, branchByNumberKey, hasMultipleBranches, playSound, irCursorEnabled, setIrCursorEnabled]);\n\n    const effectiveProjectBindings = useMemo(() => {\n        // „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„ÅÆÂâ≤ÂΩì + „Çπ„É©„Ç§„ÉâÂà•„ÅÆÂâ≤ÂΩìÔºà„ÅÇ„Çå„Å∞‰∏äÊõ∏„ÅçÔºâ„ÇíÂêàÊàê\n        const combined = {\n            ...(flow?.projectBindings ?? {}),\n            ...(currentNode?.data.bindings ?? {}),\n        };\n        const merged = mergeBindings(combined);\n        console.log(\"PresenterView: effectiveProjectBindings updated\", {\n            flowBindings: flow?.projectBindings,\n            slideBindings: currentNode?.data.bindings,\n            merged,\n        });\n        return merged;\n    }, [flow, currentNode]);\n\n    // --- „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„Éê„Ç§„É≥„Éâ„ÇíÈÅ©Áî®„Åó„Å¶„Ç¢„ÇØ„Ç∑„Éß„É≥ÂÆüË°å ---\n    const runAction = useCallback(\n        (act: BindingAction, btnName?: string) => {\n            // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠„ÅØ„ÄÅeraser„Ç¢„ÇØ„Ç∑„Éß„É≥‰ª•Â§ñ„ÇíÁÑ°ÂäπÂåñ\n            if (eraserMode && act.type !== \"eraser\") {\n                return;\n            }\n\n            // ‚òÖ„Éá„Éê„ÉÉ„Ç∞: „Ç¢„ÇØ„Ç∑„Éß„É≥ÂÆüË°å„Çí„É≠„Ç∞Âá∫Âäõ\n            console.log(`[WiiAction] Button: ${btnName || \"unknown\"}, Action:`, act);\n\n            switch (act.type) {\n                case \"next\":\n                    nextSlide();\n                    return;\n                case \"prev\":\n                    prevSlide();\n                    return;\n                case \"branchIndex\":\n                    // 1..9 „Çí ‚ÄúÂàÜÂ≤êÈÅ∏ÊäûÔºàÊï∞Â≠ó„Ç≠„ÉºÔºâ‚Äù „Å®Âêå„ÅòÊåôÂãï„Å´„Åô„Çã\n                    branchByNumberKey(String(act.index));\n                    return;\n                case \"branch\": {\n                    // Êó¢Â≠ò‰∫íÊèõ: A/B/HOME „ÅØ 1..3 „Å´„Éû„ÉÉ„Éó\n                    if (!hasMultipleBranches) return;\n                    const map: Record<string, string> = { A: \"1\", B: \"2\", HOME: \"3\" };\n                    const k = map[act.kind];\n                    if (k) branchByNumberKey(k);\n                    return;\n                }\n                case \"reaction\":\n                    // ReactionOverlay „Åå pressed.One/Two „ÇíË¶ã„Å¶„ÅÑ„Çã„ÅÆ„Åß„ÄÅ„Åì„Åì„Åß„ÅØ‰Ωï„ÇÇ„Åó„Å™„ÅÑ\n                    return;\n                case \"paint\":\n                    // shouldPaint„ÅßÂà•ÈÄîÂá¶ÁêÜ„Åô„Çã„ÅÆ„Åß„ÄÅ„Åì„Åì„Åß„ÅØ‰Ωï„ÇÇ„Åó„Å™„ÅÑ\n                    break;\n                case \"eraser\":\n                    // „Éà„Ç∞„É´Âºè„Å´Âàá„ÇäÊõø„ÅàÔºà500ms„ÇØ„Éº„É´„Çø„Ç§„É†„ÅßÂ§öÈáçÂÖ•ÂäõÈò≤Ê≠¢Ôºâ\n                    const nowEraser = Date.now();\n                    if (nowEraser - lastEraserToggleTimeRef.current < 500) {\n                        console.log(\"[Eraser] Ignoring rapid toggle\");\n                        return;\n                    }\n                    lastEraserToggleTimeRef.current = nowEraser;\n\n                    if (eraserMode) {\n                        // Ëß£Èô§\n                        setEraserMode(false);\n                        setEraserButtonName(null);\n                        setCursorPos(null);\n                    } else {\n                        // ON\n                        setEraserMode(true);\n                        setEraserButtonName(btnName || \"unknown\");\n                        // „Ç´„Éº„ÇΩ„É´„ÇíÁîªÈù¢‰∏≠Â§Æ„Å´\n                        setCursorPos({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                    }\n                    break;\n                case \"sound\":\n                    // Èü≥Â£∞ÂÜçÁîüÂá¶ÁêÜÔºàoutputDevice„Å´Âøú„Åò„Å¶PC„Åæ„Åü„ÅØWii„ÅßÂÜçÁîüÔºâ\n                    if (act.kind === \"shot\") playSound(\"q\", act.outputDevice);\n                    else if (act.kind === \"oh\") playSound(\"e\", act.outputDevice);\n                    else if (act.kind === \"uxo\") playSound(\"w\", act.outputDevice);\n                    return;\n                case \"remove\":\n                    // ÊèèÁîª„ÇíÊ∂àÂéª\n                    setDrawingPoints([]);\n                    isMouseDrawingRef.current = false;\n                    wasWiiADownRef.current = false;\n                    return;\n                case \"irSens\":\n                    // IR„Çª„É≥„Çµ„Éº„Ç´„Éº„ÇΩ„É´„ÅÆÂàáÊõøÔºà500ms„ÇØ„Éº„É´„Çø„Ç§„É†„ÅßÂ§öÈáçÂÖ•ÂäõÈò≤Ê≠¢Ôºâ\n                    const nowIrSens = Date.now();\n                    if (nowIrSens - lastIrSensToggleTimeRef.current < 500) {\n                        console.log(\"[IRSens] Ignoring rapid toggle\");\n                        return;\n                    }\n                    lastIrSensToggleTimeRef.current = nowIrSens;\n\n                    setIrCursorEnabled(!irCursorEnabled);\n                    return;\n                case \"none\":\n                default:\n                    return;\n            }\n        },\n        [nextSlide, prevSlide, branchByNumberKey, hasMultipleBranches, playSound, eraserMode, irCursorEnabled, setIrCursorEnabled],\n    );\n\n    // ‚òÖ‰øÆÊ≠£: Wii„É™„É¢„Ç≥„É≥„ÅÆ„Éú„Çø„É≥Âá¶ÁêÜÔºàisPlaying„Ååtrue„ÅÆÊôÇ„ÅÆ„ÅøÂãï‰ΩúÔºâ\n    // pressed „ÅØ„Äå„Åì„ÅÆ„Éï„É¨„Éº„É†„ÅßÊäº„Åï„Çå„ÅüÁû¨Èñì„Äç„ÅÆ„Éú„Çø„É≥„ÅÆ„ÅøÂê´„ÇÄÔºàuseWiiControllerÂÅ¥„ÅßÂá¶ÁêÜÊ∏à„ÅøÔºâ\n    useEffect(() => {\n        if (!isPlaying) return;\n\n        // pressed„Å´Âê´„Åæ„Çå„Çã„Éú„Çø„É≥„ÇíÂÖ®„Å¶Âá¶ÁêÜÔºàÊó¢„Å´„ÄåÊäº„Åï„Çå„ÅüÁû¨Èñì„Äç„ÅÆ„ÅøÊäΩÂá∫Ê∏à„ÅøÔºâ\n        for (const btn of Object.keys(pressed)) {\n            const isDown = (pressed as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n\n            // ‚òÖ„Éá„Éê„ÉÉ„Ç∞: „Éú„Çø„É≥Êäº‰∏ãÊ§úÂá∫„Çí„É≠„Ç∞Âá∫Âäõ\n            console.log(`[WiiPress] Button pressed: ${btn}`);\n\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn] ?? { type: \"none\" };\n\n            // paint/eraser‰ª•Â§ñ„ÅÆ„Ç¢„ÇØ„Ç∑„Éß„É≥„ÇíÂÆüË°å\n            if (act.type !== \"paint\" && act.type !== \"eraser\") {\n                runAction(act, btn);\n            } else if (act.type === \"eraser\") {\n                // eraser„Éú„Çø„É≥„ÅØÂ∏∏„Å´„Éà„Ç∞„É´ÂèØËÉΩ\n                runAction(act, btn);\n            }\n        }\n    }, [pressed, isPlaying, effectiveProjectBindings, runAction]);\n\n    // ‚òÖËøΩÂä†: „É™„Ç¢„ÇØ„Ç∑„Éß„É≥Ê§úÂá∫Ôºà„Éê„Ç§„É≥„Éâ„Éô„Éº„ÇπÔºâ\n    const shouldEmitClap = useMemo(() => {\n        if (!isPlaying) return false;\n        // Êäº„Åï„Çå„Åü„Éú„Çø„É≥„ÅÆ‰∏≠„Åß„ÄÅ\"clap\" „Å´„Éê„Ç§„É≥„Éâ„Åï„Çå„Å¶„ÅÑ„Çã„ÇÇ„ÅÆ„Åå„ÅÇ„Çã„ÅãÔºü\n        for (const btn of Object.keys(pressed)) {\n            const isDown = (pressed as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n            if (act?.type === \"reaction\" && act.kind === \"clap\") return true;\n        }\n        return false;\n    }, [pressed, effectiveProjectBindings, isPlaying]);\n\n    const shouldEmitLaugh = useMemo(() => {\n        if (!isPlaying) return false;\n        for (const btn of Object.keys(pressed)) {\n            const isDown = (pressed as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n            if (act?.type === \"reaction\" && act.kind === \"laugh\") return true;\n        }\n        return false;\n    }, [pressed, effectiveProjectBindings, isPlaying]);\n\n    // PAINT„Éú„Çø„É≥„ÅÆÊúÄÂæå„ÅÆÂÖ•ÂäõÊôÇÂàª„ÇíË®òÈå≤\n    const lastPaintInputTimeRef = useRef<number>(0);\n    const [shouldPaint, setShouldPaint] = useState(false);\n\n    // ‚òÖËøΩÂä†: IR Cursor „ÇíOFF„Å´„Åó„ÅüÁû¨Èñì„Å´„ÄåWii PAINTÊèèÁîª„Äç„ÇíÂÆåÂÖ®ÂÅúÊ≠¢ÔºàÊÆãÁïô shouldPaint „ÇíÊΩ∞„ÅôÔºâ\n    useEffect(() => {\n        if (irCursorEnabled) return;\n\n        // Wii„Éö„Ç§„É≥„ÉàÁ≥ª„ÅÆÁä∂ÊÖã„ÇíÂº∑Âà∂„É™„Çª„ÉÉ„Éà\n        setShouldPaint(false);\n        setIsPainting(false);\n        lastPaintInputTimeRef.current = 0;\n\n        // „ÇÇ„ÅóWiiÊèèÁîª„ÅÆÁ∑ö„ÅåÁ∂ôÁ∂ö‰∏≠„Å™„ÇâÂå∫Âàá„Çã\n        wasWiiADownRef.current = false;\n        setDrawingPoints((prev) =>\n            prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev\n        );\n    }, [irCursorEnabled]);\n\n    // wiiState.buttons„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„ÄÅÁèæÂú®PAINT„Éú„Çø„É≥„ÅåÊäº„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ∂ôÁ∂öÁöÑ„Å´Áõ£Ë¶ñ\n    useEffect(() => {\n        // ‚òÖÈáçË¶Å: IR Cursor „ÅåOFF„Å™„Çâ Wii„Éö„Ç§„É≥„Éà„ÅØÁµ∂ÂØæ„Å´Âãï„Åã„Åï„Å™„ÅÑ\n        if (!isPlaying || !wiiState || eraserMode || !irCursorEnabled) {\n            if (shouldPaint) {\n                setShouldPaint(false);\n                setIsPainting(false);\n            }\n            return;\n        }\n\n        // ÁèæÂú®Êäº„Åï„Çå„Å¶„ÅÑ„Çã„Éú„Çø„É≥„ÅÆ‰∏≠„Å´PAINT„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ\n        let isPaintButtonPressed = false;\n        for (const btn of Object.keys(wiiState.buttons)) {\n            const isDown = (wiiState.buttons as Record<string, boolean>)[btn];\n            if (!isDown) continue;\n\n            const act = (effectiveProjectBindings as Record<string, BindingAction | undefined>)[btn];\n            if (act?.type === \"paint\") {\n                isPaintButtonPressed = true;\n                break;\n            }\n        }\n\n        if (isPaintButtonPressed) {\n            lastPaintInputTimeRef.current = Date.now();\n            if (!shouldPaint) setShouldPaint(true);\n            if (!isPainting) setIsPainting(true); // ‚òÖIRÊèèÁîª‰∏≠„ÇÇ„Éö„É≥„Ç´„Éº„ÇΩ„É´Ë°®Á§∫\n        }\n    }, [wiiState, effectiveProjectBindings, isPlaying, eraserMode, irCursorEnabled, shouldPaint, isPainting]);\n\n    // 200ms„Çø„Ç§„Éû„Éº„ÅßÊèèÁîªÁä∂ÊÖã„Çí„ÉÅ„Çß„ÉÉ„ÇØ\n    useEffect(() => {\n        if (!isPlaying) {\n            setShouldPaint(false);\n            return;\n        }\n\n        const interval = setInterval(() => {\n            const now = Date.now();\n            const paintElapsed = now - lastPaintInputTimeRef.current;\n\n            if (paintElapsed > 100 && shouldPaint) {\n                setShouldPaint(false);\n                setIsPainting(false); // ‚òÖËøΩÂä†: Wii„Éú„Çø„É≥ÊèèÁîªÁµÇ‰∫ÜÊôÇ„ÇÇ„Éö„É≥„Ç´„Éº„ÇΩ„É´Ëß£Èô§\n                // ÊèèÁîª„ÇíÁµÇ‰∫Ü\n                if (isMouseDrawingRef.current) {\n                    isMouseDrawingRef.current = false;\n                    setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n                }\n            }\n        }, 50); // 50ms„Åî„Å®„Å´„ÉÅ„Çß„ÉÉ„ÇØ\n\n        return () => clearInterval(interval);\n    }, [isPlaying, shouldPaint]);\n\n    // --- ÊèèÁîª/Ê∂à„Åó„Ç¥„É†„É≠„Ç∏„ÉÉ„ÇØ (IR„Çª„É≥„Çµ„Éº & PAINT„Éú„Çø„É≥) ---\n    useEffect(() => {\n        // IR„Ç´„Éº„ÇΩ„É´OFF„ÅÆÂ†¥Âêà„ÅØIRÊèèÁîª„ÇíÁÑ°ÂäπÂåñ\n        if (!irCursorEnabled) return;\n\n        if (!wiiState || !wiiState.cursor) return;\n\n        // ‚òÖIR„Ç´„Éº„ÇΩ„É´ONÊôÇÔºö„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Åã„ÇâÂèó‰ø°„Åó„ÅüÊ≠£Ë¶èÂåñÊ∏à„ÅøcursorÂ∫ßÊ®ô„ÅÆ„Åø„Çí‰ΩøÁî®\n        // ‚òÖÈáçË¶ÅÔºöCSS„Åßcursor: url(\"/pen.png\") 0 0„Çí‰ΩøÁî®„Åó„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅ\n        // SetCursorPos„ÅØ„Éö„É≥ÁîªÂÉè„ÅÆÂ∑¶‰∏äÔºà0,0Ôºâ„ÇíÂãï„Åã„Åô„ÄÇ\n        // „Åó„Åã„ÅóÊèèÁîª„ÅØ„Éö„É≥ÂÖà„ÅÆ‰ΩçÁΩÆÔºà‰æã: 6, 28Ôºâ„ÅßË°å„ÅÜÂøÖË¶Å„Åå„ÅÇ„Çã„Åü„ÇÅ„ÄÅ„Ç™„Éï„Çª„ÉÉ„Éà„ÇíÂä†ÁÆó„ÄÇ\n        const PEN_TIP_OFFSET_X = 0;  // pen.png„ÅÆ„Éö„É≥ÂÖàXÂ∫ßÊ®ôÔºàÂÆüÈöõ„ÅÆÁîªÂÉè„Å´Âêà„Çè„Åõ„Å¶Ë™øÊï¥Ôºâ\n        const PEN_TIP_OFFSET_Y = 0; // pen.png„ÅÆ„Éö„É≥ÂÖàYÂ∫ßÊ®ôÔºàÂÆüÈöõ„ÅÆÁîªÂÉè„Å´Âêà„Çè„Åõ„Å¶Ë™øÊï¥Ôºâ\n\n        const pos = {\n            x: wiiState.cursor.x * window.innerWidth + PEN_TIP_OFFSET_X,\n            y: wiiState.cursor.y * window.innerHeight + PEN_TIP_OFFSET_Y,\n        };\n\n        // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠: IR„Åß„Ç´„Éº„ÇΩ„É´„ÇíÁßªÂãï\n        if (eraserMode) {\n            setCursorPos(pos);\n\n            // A„Å®B„ÇíÂêåÊôÇÊäº„Åó„Åó„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ\n            const isAPressed = wiiState.buttons.A;\n            const isBPressed = wiiState.buttons.B;\n\n            if (isAPressed && isBPressed) {\n                // A+BÂêåÊôÇÊäº„Åó„ÅßÊ∂àÂéª\n                setDrawingPoints((prev) => {\n                    const next = prev.slice();\n                    if (!wasWiiADownRef.current) {\n                        if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                    }\n                    next.push({ ...pos, mode: \"erase\" });\n                    return next;\n                });\n                wasWiiADownRef.current = true;\n            } else {\n                // A+B„ÇíÈõ¢„Åó„Åü„ÇâÂå∫Âàá„Çã\n                if (wasWiiADownRef.current) {\n                    wasWiiADownRef.current = false;\n                    setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n                }\n            }\n            return;\n        }\n\n        // PAINT„Éê„Ç§„É≥„Éâ„Åï„Çå„Åü„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„ÅÑ„ÇãÈñì„ÄÅËªåË∑°„ÇíËøΩÂä†\n        if (shouldPaint) {\n            setDrawingPoints((prev) => {\n                const next = prev.slice();\n                if (!wasWiiADownRef.current) {\n                    // ÂâçÂõû„ÅÆÁ∑ö„Å®Áπã„Åå„Çâ„Å™„ÅÑ„Çà„ÅÜ„Å´Âå∫Âàá„Çä„ÇíÂÖ•„Çå„Çã\n                    if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                }\n                next.push({ ...pos, mode: \"draw\" });\n                return next;\n            });\n            wasWiiADownRef.current = true;\n        } else {\n            // Èõ¢„Åó„Åü„Çø„Ç§„Éü„É≥„Ç∞„ÅßÂå∫Âàá„Çã\n            if (wasWiiADownRef.current) {\n                wasWiiADownRef.current = false;\n                setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n            }\n        }\n    }, [wiiState, shouldPaint, irCursorEnabled]);\n\n\n    return (\n        <main\n            ref={containerRef}\n            onMouseDown={(e) => {\n                if (!isPlaying) return;\n                if (e.button !== 0) return;\n                // UI(„Éú„Çø„É≥Á≠â)Êìç‰Ωú„ÅØÈÇ™È≠î„Åó„Å™„ÅÑ\n                const el = e.target as HTMLElement | null;\n                if (el && el.closest(\"button, a, input, textarea, select\")) return;\n                e.preventDefault();\n\n                // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠„ÅØÂ∑¶„ÇØ„É™„ÉÉ„ÇØ„ÅßÊ∂àÂéªÈñãÂßã\n                if (eraserMode) {\n                    isMouseDrawingRef.current = true;\n                    setIsPainting(false); // Ê∂à„Åó„Ç¥„É†„É¢„Éº„Éâ‰∏≠„ÅØ„Éö„É≥„Ç´„Éº„ÇΩ„É´„Å´„Åó„Å™„ÅÑ\n                    setDrawingPoints((prev) => {\n                        const next = prev.slice();\n                        if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                        next.push({ x: e.clientX, y: e.clientY, mode: \"erase\" });\n                        return next;\n                    });\n                    return;\n                }\n\n                // ÈÄöÂ∏∏„É¢„Éº„ÉâÔºöÂ∑¶„ÇØ„É™„ÉÉ„ÇØ„ÅßÊèèÁîªÈñãÂßã\n                isMouseDrawingRef.current = true;\n                setIsPainting(true); // „Éö„É≥„Ç´„Éº„ÇΩ„É´„Å´Â§âÊõ¥\n                setDrawingPoints((prev) => {\n                    const next = prev.slice();\n                    if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                    next.push({ x: e.clientX, y: e.clientY, mode: \"draw\" });\n                    return next;\n                });\n            }}\n            onMouseMove={(e) => {\n                if (!isPlaying) return;\n\n                // Ê∂à„Åó„Ç¥„É†„É¢„Éº„ÉâÊôÇÔºö„Ç´„Éº„ÇΩ„É´‰ΩçÁΩÆ„ÇíÂ∏∏„Å´Êõ¥Êñ∞ÔºàËµ§„ÅÑÂÜÜ„ÇíËøΩÂæì„Åï„Åõ„ÇãÔºâ\n                if (eraserMode) {\n                    setCursorPos({ x: e.clientX, y: e.clientY });\n\n                    // „Éû„Ç¶„Çπ„Éâ„É©„ÉÉ„Ç∞‰∏≠„ÅÆ„ÅøÊ∂àÂéª„ÇíÂÆüË°å\n                    if (isMouseDrawingRef.current) {\n                        e.preventDefault();\n                        setDrawingPoints((prev) => {\n                            const last = prev[prev.length - 1];\n                            if (last && last.x && Math.abs(last.x - e.clientX) + Math.abs(last.y - e.clientY) < 2) return prev;\n                            return [...prev, { x: e.clientX, y: e.clientY, mode: \"erase\" }];\n                        });\n                    }\n                    return;\n                }\n\n                // --- ÈÄöÂ∏∏„É¢„Éº„ÉâÔºöÊèèÁîªÔºà„Éû„Ç¶„Çπ or Wii PAINTÔºâ ---\n\n                // 1) „Éû„Ç¶„Çπ„Éâ„É©„ÉÉ„Ç∞‰∏≠„ÅØÂ∏∏„Å´„Éû„Ç¶„ÇπÊèèÁîª„ÇíÂÑ™ÂÖà\n                if (isMouseDrawingRef.current) {\n                    e.preventDefault();\n                    setDrawingPoints((prev) => {\n                        const last = prev[prev.length - 1];\n                        if (last && last.x && Math.abs(last.x - e.clientX) + Math.abs(last.y - e.clientY) < 2) return prev;\n                        return [...prev, { x: e.clientX, y: e.clientY, mode: \"draw\" }];\n                    });\n                    return;\n                }\n\n                // 2) Wii„ÅÆPAINTÔºàshouldPaint=trueÔºâ„ÅÆÂ†¥Âêà\n                if (shouldPaint) {\n                    // ‚òÖÈáçË¶ÅÔºöIR Cursor ON „ÅÆ„Å®„Åç„ÅØ„ÄåIRÂÅ¥useEffect„Äç„ÅåÁÇπ„ÇíËøΩÂä†„Åô„Çã„ÄÇ\n                    // „Åì„Åì„Åß„Éû„Ç¶„ÇπÂ∫ßÊ®ô(e.clientX/Y)„ÇíÊ∑∑„Åú„Çã„Å®„ÄÅÂà•Â∫ßÊ®ô„ÅåÊ∑∑„Åñ„Å£„Å¶Á∑ö„Åå‰º∏„Å≥„Çã„ÅÆ„Åß‰Ωï„ÇÇ„Åó„Å™„ÅÑ„ÄÇ\n                    if (irCursorEnabled) return;\n\n                    // ‚òÖIR Cursor OFF „ÅÆ„Å®„Åç„Å†„Åë„Äå„Éû„Ç¶„ÇπÂ∫ßÊ®ô„Åß1ÁÇπ„Å†„ÅëÊèè„Åè„ÄçÊåôÂãï„ÇíË®±ÂèØÔºà‰ªïÊßòÈÄö„Çä„ÅÆÊåôÂãïÔºâ\n                    e.preventDefault();\n                    setDrawingPoints((prev) => {\n                        const next = prev.slice();\n                        if (next.length > 0 && next[next.length - 1] !== null) next.push(null);\n                        next.push({ x: e.clientX, y: e.clientY, mode: \"draw\" });\n                        next.push(null); // ‚îÖ1Êú¨„Å†„Åë„ÅßÂøÖ„ÅöÂå∫Âàá„Çã\n                        return next;\n                    });\n                    return;\n                }\n\n                // 3) ‰Ωï„ÇÇ„Åó„Å¶„Å™„ÅÑ„Å™„Çâ‰Ωï„ÇÇ„Åó„Å™„ÅÑ\n                return;\n            }}\n            onMouseUp={() => {\n                if (!isMouseDrawingRef.current) return;\n                isMouseDrawingRef.current = false;\n                setIsPainting(false); // „Éö„É≥„Ç´„Éº„ÇΩ„É´Ëß£Èô§\n                setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n            }}\n            onMouseLeave={() => {\n                if (!isMouseDrawingRef.current) return;\n                isMouseDrawingRef.current = false;\n                setIsPainting(false); // „Éö„É≥„Ç´„Éº„ÇΩ„É´Ëß£Èô§\n                setDrawingPoints((prev) => (prev.length > 0 && prev[prev.length - 1] !== null ? [...prev, null] : prev));\n            }}\n            className={isPainting ? 'presenter-painting' : 'presenter-container'}\n            style={{\n                position: \"relative\",\n                width: \"100vw\",\n                height: \"100vh\",\n                overflow: \"hidden\",\n                background: \"black\",\n            }}\n        >\n            {/*„Åì„Åì„Åã„Çâ*/}\n            {/* <WiiDisconnectPopup\n                isPlaying={isPlaying}\n                startedWithWii={startedWithWii}\n                wiiConnected={wiiConnected}\n                wiiDisconnectedAt={wiiDisconnectedAt}\n                playingSince={playingSince}\n            />\n\n            <WiiReconnectPopup\n                isPlaying={isPlaying}\n                wiiConnected={wiiConnected}\n                startedWithWii={startedWithWii}\n            /> */}\n            {/*„Åì„ÅìÊÆã„Åô*/}\n            {/*„Åì„Åì„Åã„Çâ*/}\n            <WiiDisconnectPopup2\n                isPlaying={isPlaying}\n                startedWithWii={startedWithWii}\n                wiiConnected={wiiConnected}\n                wiiDisconnectedAt={wiiDisconnectedAt}\n                playingSince={playingSince}\n            />\n\n            <WiiReconnectPopup2\n                isPlaying={isPlaying}\n                wiiConnected={wiiConnected}\n                startedWithWii={startedWithWii}\n            />\n            {/*„Åì„Åì„Åë„Åô*/}\n\n            {/* Êàª„Çã„Éú„Çø„É≥ÔºàÂ∑¶‰∏äÔºâ */}\n            <div style={{ position: \"absolute\", top: 20, left: 20, zIndex: 10000 }}>\n                <button onClick={goBack} style={{ padding: \"10px 14px\", fontSize: 14 }}>\n                    {returnLabel}\n                </button>\n            </div>\n\n            {/* „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ */}\n            <ReactionOverlay emitClap={shouldEmitClap} emitLaugh={shouldEmitLaugh} />\n\n            {/* IR„Éù„Ç§„É≥„Çø„Éº„Ç™„Éº„Éê„Éº„É¨„Ç§ */}\n            <IrPointerOverlay\n                wiiState={wiiState}\n                isPlaying={isPlaying}\n                irCursorEnabled={irCursorEnabled}\n                showIrDebug={showIrDebug}\n            />\n\n            {/* „Çπ„É©„Ç§„ÉâË°®Á§∫„Ç®„É™„Ç¢ (ÂÖ®ÁîªÈù¢„Éª‰ΩôÁôΩ„Å™„Åó„Éª„Ç¢„Çπ„Éö„ÇØ„ÉàÊØîÁ∂≠ÊåÅ) */}\n            <SlideDisplay\n                currentNode={currentNode}\n                error={error}\n                getOrLoadPdfDocument={getOrLoadPdfDocument}\n            />\n\n            {/* ÊèèÁîª„É¨„Ç§„É§„Éº (ÊúÄÂâçÈù¢) */}\n            <DrawingCanvas\n                drawingPoints={drawingPoints}\n                wiiState={wiiState}\n                isPlaying={isPlaying}\n                shouldPaint={shouldPaint}\n                eraserMode={eraserMode}\n                eraserPosition={cursorPos}\n            />\n\n            {/* „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†± (Âè≥‰∏ä) */}\n            {showDebugPanel && (\n                <WiiDebugPanel\n                    wiiState={wiiState}\n                    pressed={pressed}\n                    effectiveProjectBindings={effectiveProjectBindings}\n                    irCursorEnabled={irCursorEnabled}\n                    onToggleIrCursor={() => setIrCursorEnabled(!irCursorEnabled)}\n                />\n            )}\n\n            {/* Êìç‰Ωú„Ç¨„Ç§„Éâ (Â∑¶‰∏ã) */}\n            <div style={{ position: \"absolute\", bottom: 20, left: 20, color: \"rgba(255,255,255,0.5)\", fontSize: 14, pointerEvents: \"none\" }}>\n                [ESC] Êàª„Çã | [SPACE] „Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫ÂàáÊõø\n            </div>\n\n            {/* Ê∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´ */}\n            <EraserCursor\n                position={cursorPos}\n                isActive={eraserMode}\n                buttonName={eraserButtonName}\n            />\n\n            {/* Ê∂à„Åó„Ç¥„É†„Ç´„Éº„ÇΩ„É´ */}\n            {eraserMode && cursorPos && (\n                <div\n                    style={{\n                        position: \"absolute\",\n                        left: cursorPos.x,\n                        top: cursorPos.y,\n                        width: 120,\n                        height: 120,\n                        borderRadius: \"50%\",\n                        border: \"3px dashed rgba(255, 100, 100, 0.8)\",\n                        background: \"rgba(255, 100, 100, 0.2)\",\n                        transform: \"translate(-50%, -50%)\",\n                        pointerEvents: \"none\",\n                        zIndex: 10000,\n                    }}\n                />\n            )}\n        </main>\n    );\n}"],"names":[],"mappings":"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"}}]
}